%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%     Аффинная сводимость
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Аффинная сводимость}
\begin{flushright}
Всё познается в сравнении
\end{flushright}


\section{Аффинная сводимость задач}

В этом разделе приводится определение аффинной сводимости задач, служащее основой для различных определений аффинной сводимости многогранников задач.

Согласно определениям \ref{def:COP}, \ref{def:LCOP} и \ref{def:family}, входные данные линейной задачи комбинаторной оптимизации состоят из кода $I$, называемого кодом многогранника (определяющего множество допустимых решений $X(I)$), и целевого вектора $\bm{c}$.

Рассмотрим две массовые линейные задачи комбинаторной оптимизации.
Для кода многогранника и целевого вектора первой задачи используем обозначения $I$ и $\bm{c}$, соответственно. Для второй задачи "--- $I'$ и $\bm{c'}$.
Тройку функций, определяющих множество допустимых решений $X = X(I)$ первой задачи, обозначаем $d$, $S$ и $g$. Для второй задачи "---  $d'$, $S'$ и $g'$. Множество допустимых решений второй задачи обозначаем $X' = X'(I')$.

\begin{definition}
	Будем говорить, что линейная задача комбинаторной оптимизации $(d,S,g)$ \emph{аффинно сводится} к задаче $(d',S',g')$, если существуют:
	\begin{enumerate}
		\item 
		Полиномиальный алгоритм $A$ преобразования каждого кода $I$ первой задачи в код $I'$ для второй задачи: $A \from I \mapsto I'$.
		\item 
		Полиномиальный алгоритм построения для каждого кода $I$ аффинного отображения $\alpha\from \R^d \to \R^{d'}$, где $d = d(I)$, $d' = d'(A(I))$.
		\item 
		%Сюръекция
		Функция $\beta\from Y \to X$, где $X = X(I)$, а $Y$ "--- это множество всех таких $\bm{y} \in X' = X'(I')$, для каждого из которых найдется целевой вектор $\bm{c} \in \R^d$ и, соответственно, $\bm{c'} = \alpha(\bm{c})$ такой, что $\bm{c'}^T \bm{y} \ge \bm{c'}^T \bm{x'}$ для всех $\bm{x'} \in X'$.
		%\[Y = \Set*{\bm{y} \in X'(I') \given \exists \bm{c} \in \R^d \ \bm{c'} = \alpha(\bm{c}), \ \forall \bm{x'} \in X'(I')\ \bm{c'}^T \bm{y} \ge \bm{c'}^T \bm{x'}}.\]
		
		Причем для любого $\bm{y} \in Y$ и любого $\bm{c} \in \R^d$
		\[
		\Bigl(\forall \bm{x'} \in X' \quad \alpha(\bm{c})^T \bm{y} \ge \alpha(\bm{c})^T \bm{x'}\Bigr) \Longrightarrow \Bigl(\forall \bm{x} \in X \quad \bm{c}^T \beta(\bm{y})  \ge \bm{c}^T \bm{x}\Bigr).
		\] 
	\end{enumerate}
\end{definition}
%Ликбез: 1) сюръекция -- отображение на, или же функция, принимающая все возможные значения; 2) инъекция -- каждый образ соответствует (не более чем) единственному прообразу, или, если образы совпадают, то и прообразы совпадают.

Непосредственно из определения следует, что аффинная сводимость задач влечет их полиномиальную сводимость.

Далее нас в первую очередь будут интересовать свойства многогранников задач и связанных с ними геометрических конструкций. Поэтому данное определение будет модифицировано в соответствии с целями изучения соответствующих геометрических объектов.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%     Конусные разбиения
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Конусное разбиение пространства исходных данных}
\label{sec:Cones}

Пусть $P$ "--- выпуклый многогранник в $\R^d$. 
\emph{Конус грани} $F$ многогранника $P$ определим следующим образом:
\[
K(F) \coloneq \Set*{\bm{c}\in\R^d \given  \bm{c}^T \bm{x} \ge \bm{c}^T \bm{y}, \ \forall \bm{x} \in F, \ \forall \bm{y} \in P}.
\]
В частности, $\bm{0} \in K(F)$ для любой грани $F$.
Заметим также, что определение конуса грани не изменится, если многогранник $P$ и его грань $F$ заменить соответствующими множествами вершин.

Множество всех конусов $K(F)$, где $F$ пробегает множество непустых граней многогранника $P$, называется \emph{нормальным веером}~\cite[с.~257]{ZieglerBook}.

Нормальный веер является двойственной к многограннику геометрической структурой.
А именно, $\dim K(F) = d - \dim(F)$ и, если $F$ является собственной гранью грани $G$ многогранника $P$, то $K(G)$ является гранью конуса $K(F)$.
Обратно, любая грань конуса $K(F)$ есть конус $K(G)$, соответствующий некоторой грани $G$ многогранника $P$ такой, что $F \subset G$.

Так как любой выпуклый многогранник $P$ однозначно определяется множеством своих вершин $X = \ext(P)$, то и его нормальный веер однозначно определяется набором конусов его вершин
\[
\K(X) \coloneq \Set*{K(\bm{x}) \given \bm{x} \in X},
\]
который далее будем называть \emph{конусным разбиением} пространства исходных данных задачи линейной оптимизации на $X$.
Это название объясняется тем, что задачу оптимизации вдоль целевого вектора $\bm{c}\in\R^d$ на множестве $X \in \R^d$ можно переформулировать как задачу поиска такого $\bm{x} \in X$, что $\bm{c} \in K(\bm{x})$.

Пусть $\bm{x}$ и $\bm{y}$ "--- вершины многогранника $P \subset \R^d$.
Будем называть конусы $K(\bm{x})$ и $K(\bm{y})$ \emph{смежными}, если они имеют общую гипергрань:
\[
\dim (K(\bm{x}) \cap K(\bm{y})) = d-1.
\]
Очевидно, конусы $K(\bm{x})$ и $K(\bm{y})$ смежны тогда и только тогда, когда смежны вершины $\bm{x}$ и $\bm{y}$.
Соответственно, граф многогранника $\conv(X)$ совпадает с графом конусного разбиения $\K(X)$.

Относительно многогранника задачи $\conv(X)$ преимущество конусного разбиения $\K(X)$ пространства исходных данных заключается в том, что появляется возможность простой интерпретации различных дополнительных линейных ограничений на целевой вектор $\bm{c}$.
Так, например, в классической задаче о кратчайшем пути накладываются ограничения $\bm{c} \le \bm{0}$ (для задачи максимизации).
Таким образом, можно изучать характеристики (полиэдрального) разбиения некоторой части пространства исходных данных.
В случае задачи о кратчайшем пути речь идет о конусном разбиении отрицательного ортанта.

По аналогии с определением конуса $K(\bm{x})$ для вершины $\bm{x}$ многогранника $P\subset \R^d$ введем обозначение
\[
K(\bm{x}, Q) \coloneq \Set*{\bm{c}\in Q \given  \bm{c}^T \bm{x} \ge \bm{c}^T \bm{y}, \ \forall \bm{y} \in P}, 
\]
где $Q$ "--- полиэдр в $\R^d$.
Множество всех таких конусов при фиксированном $Q$ обозначим $\K(X,Q)$ и будем называть \emph{разбиением $Q$ по множеству $X$}.
Граф такого разбиения определяется по аналогии с графом конусного разбиения.
Таким образом, граф разбиения $\K(X,Q)$ является подграфом графа конусного разбиения $\K(X)$.

Очевидно, что при переходе от всего пространства исходных данных к полиэдру $Q$ конусы нормального веера могут менять свои геометрические очертания (превращаясь в полиэдры) и уменьшаться по размерности, вплоть до полного исчезновения. С точки зрения комбинаторной структуры, нормальный веер при этом может терять часть своих элементов, новые элементы появиться не могут.

Заметим, что решение задачи оптимизации инвариантно относительно умножения целевого вектора на положительный скаляр. Таким образом, не уменьшая общности, вместо конусного разбиения $\K(X)$ можно ограничиться рассмотрением разбиения $\K(X,\Cube(-1,1))$, где 
\[
\Cube(-1,1) \coloneq \Set{\bm{x} \given \bm{-1} \le \bm{x} \le \bm{1}}.
\]
%В частности, графы этих разбиений совпадают.




%\section{Аффинная сводимость}

{\color{red}
	После определения обычной аффинной сводимости (для семейств многогранников)
	привести утверждение о том, что соответствующая задача оптимизации полиномиально трансформируется! Видимо, нужно будет уточнить, что расстояние от опорной гиперплоскости, в которой располагается нужная грань, до остальных вершин многогранника известно и полиномиально вычислимо. Но можно этого и не делать, если сами задачи не интересны, а интересны в первую очередь свойства многогранников.
	
	Описать семейство полиэдров с полиномиальным внешним описанием.
	Привести определение аффинной сводимости пары (семейство многогранников, семейство полиэдров) к другой такой паре. Либо сводимость соответствующих задач.
}

\begin{definition} 
	Будем говорить, что задача $(X,S)$
	для многогранного множества исходных данных $S\subseteq R^m$
	{\it аффинно сводится} к задаче $Y=(Y,T)$, где $Y,T \in \R^n$, $m\le n$,
	если найдутся 
	\begin{enumerate}
		\item инъективное аффинное отображение $A: S\to T$ с полиномиально вычислимыми коэффициентами, 
		\item и взаимно-однозначное соответствие $B: Y'\to X$ между некоторым подмножеством $Y'\subseteq Y$ и множеством $X$ 
	\end{enumerate}
	такие, что для каждого вектора $s\in S$ выполнено следующее условие:
	\begin{equation}
	\label{TheoryAff}
	\begin{array}{c}
	y_0 \mbox{ является решением задачи } [Y,A(s)], 
	\mbox{ тогда и только тогда,}\\
	\mbox{когда }
	y_0\in Y' \mbox{ и } x_0=B(y_0) \mbox{ --- решение задачи } [X,s].
	\end{array}
	\end{equation}
	\[
	A(s) \in K_Y(y_0,T) \iff y_0 \in Y' \text{ и } s \in K_X(B(y_0), S).
	\]
	Для таких задач введем обозначение: $(X,S)\propto_A (Y,T)$. 
	Перечислим свойства аффинной сводимости.
\end{definition}

{\color{red}

%\prop{Свойство} 
{Множество $T$ из определения аффинной сводимости 
	аффинно подобно многогранному множеству $S$.} 
Это следует из невырожденности отображения $A$.

%\prop{\label{Theory2} Свойство} 
{Для любого $x\in X$ и $y=B(x)\in Y'$ полиэдры $K(x,S)$ и 
	$K(y,T)$ тоже аффинно подобны.} Обозначаем $K(x,S)\sim K(B(x),T)$. 
Это свойство вытекает из невырожденности аффинного отображения $A$ 
и условия (\ref{TheoryAff}).

%\prop{\label{Theory3} Свойство} 
{Грань вида $K(x_1,S)\cap K(x_2,S)$, где $x_1,x_2\in X$,
	аффинное отображение $A$ переводит в подобную грань $K(y_1,T)\cap K(y_2,T)$,
	где $y_1=B(x_1)$, $y_2=B(x_2)$.}  

%\prop{\label{Theory4} Свойство} 
{$\bigcap\limits_{i=1}^l K(x_i,S) \sim \bigcap\limits_{i=1}^l K(y_i,T)$, 
	где $x_i\in X$, $y_i=B(x_i)$, для $1\le i\le l$.}  
Это свойство является естественным обобщением предыдущих трех свойств.

Теперь, опираясь на указанные свойства, сформулируем ряд утверждений.

%\prop{Теорема}
{Пусть $(X,S)\propto_A Y$ и $A: S\to T$, тогда 
	$G_S(X)=G_T(Y)\prec G(Y)$.}

1. Конусное разбиение и его свойства.
Преимущество: случай с дополнительными ограничениями на множество исходных данных.
Пример -- кратчайший путь.

2. Аффинная сводимость для конусных разбиений. Примеры: ЗКП -> Назначения, Коммивояжер -> Коммивояжер с ограничением неотрицательности.
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%     Аффинная сводимость многогранников
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Аффинная сводимость многогранников}

\subsection{Сравнение многогранников}

Как известно, сравнение является одним из наиболее распространенных и универсальных методов исследования.
Чтобы воспользоваться им, введем следующую операцию сравнения,
задающую частичный порядок на множестве всех выпуклых многогранников.

\begin{definition}\label{def:ineA}
В случае, когда многогранник $P$ аффинно эквивалентен многограннику~$Q$ или же его грани, будем использовать обозначение $P \lea Q$.
Факт аффинной эквивалентности многогранников $P$ и $Q$ обозначаем $P =_A Q$.
\end{definition}

В следующей главе будет рассмотрен более мягкий вариант этого определения,
в котором слова <<аффинно эквивалентен>> заменены на <<является аффинным образом>>, а для соответствующего соотношения используется обозначение $\lee$. Там же будет проведен анализ различий в использовании этих двух соотношений при исследовании свойств многогранников.

Нетрудно заметить, что соотношение $\lea$ оказывается особенно полезным
при сравнении комбинаторных свойств (т.\,е. свойств решеток граней) многогранников.

\begin{property}
Если $P \lea Q$, то решетка граней многогранника $P$ 
изоморфна либо всей решетке граней многогранника $Q$ (если $P$ и $Q$ эквивалентны), либо некоторой подрешетке (индуцированной гранью многогранника $Q$), а матрица инциденций гиперграней"=вершин многогранника $P$ является подматрицей матрицы инциденций многогранника $Q$. В частности:
\begin{enumerate}
	\item Число вершин многогранника $P$ не превосходит числа вершин $Q$.
	\item Число $i$-граней многогранника $P$ не превосходит числа $i$-граней $Q$ при $i \le \dim(P)$.
	\item Граф многогранника $P$ изоморфен некоторому подграфу графа многогранника $Q$.
	\item Число гиперграней $P$ не превосходит числа гиперграней $Q$.
	\item Числа прямоугольных покрытий удовлетворяют соотношению $\rc(P) \le \rc(Q)$.
\end{enumerate}
\end{property}

В качестве примеров перечислим некоторые очевидные соотношения
для симплексов и циклических многогранников.
Прежде всего, симплекс $\Delta_n$ является гранью симплекса $\Delta_{n+1}$, 
а в силу транзитивности соотношения $\lea$ 
получаем 
\begin{equation}
\label{eq:compareDelta}
\Delta_n \lea \Delta_{n+k} \quad \forall n,k \in \N.
\end{equation}
Кроме того, 
\begin{equation}
\label{eq:compareDeltaCP}
\Delta_m \lea \CP_n(S) \quad \text{при } m < n \le |S|, 
\end{equation}
так как циклический многогранник $\CP_n(S)$ симплициален.
По той же причине 
\begin{equation}
\label{eq:compareCP}
\CP_n(S) \nelea \CP_{n+k}(S')
\end{equation}
для всех $n, k \in \N$
и любых множеств $S$ и $S'$, при условии $|S| > n+1 > 2$.

Заметим, что множество симплексов $\Delta = \{\Delta_n\}$ и множество циклических многогранников $\CP = \Set*{\CP_n(S) \given n\in\N, \ S \subset \Q, \ |S| < \infty}$ представляют собой примеры семейств многогранников задач комбинаторной оптимизации.
В связи с этим интерес представляет следующий вопрос.
Какая из двух ситуаций \eqref{eq:compareDelta} или~\eqref{eq:compareCP} является наиболее типичной для известных семейств многогранников задач?
Опыт показывает, что в большинстве случаев легко проверяется справедливость соотношений вида~\eqref{eq:compareDelta}.
При доказательстве такого рода соотношений удобно пользоваться следующим очевидным утверждением.

\begin{lemma}
	\label{lem:01face}
	Пусть $P \in \R^d$ "--- 0/1"~многогранник. Тогда $F_i = \Set*{\bm{x}\in P \given x_i = 0}$ и $G_i = \Set*{\bm{x}\in P \given x_i = 1}$, $i\in[d]$,
	являются гранями (быть может несобственными) многогранника $P$.
\end{lemma}

Рассмотрим три наиболее часто встречающихся в литературе семейства многогранников: булевы квадратичные многогранники $\BQP(n)$, многогранники асимметричной задачи коммивояжера $\ATSP(n)$ и многогранники задачи о рюкзаке $\Knap(n, \bm{a}, b)$.


\begin{prop}
\begin{align*}
\BQP(n) &\lea \BQP(n+1),\\
\ATSP(n) &\lea \ATSP(n+1),\\
\Knap(\bm{a}, b) &\lea \Knap((\bm{a},0), b), \quad \bm{a} \in \R^{n}, \ b\in \R.
\end{align*}
\end{prop}
\begin{proof}
Воспользуемся леммой~\ref{lem:01face}.
Рассмотрим грань $F$ многогранника $\BQP(n+1)$, образованную гиперплоскостью $x_{n+1, n+1} = 0$. 
Тогда для всех $\bm{x} \in F$ выполняется $x_{i, n+1} = 0$ при $i\in[n+1]$.
Нетрудно увидеть, что множество вершин грани $F$ преобразуется в множество вершин многогранника $\BQP(n)$ (и, наоборот, $\BQP(n)$ в $F$) аффинным отображением (ортогональной проекцией) $x_{ij} \mapsto y_{ij}$, $1 \le i \le j \le n$. 

Для доказательства соотношения $\ATSP(n) \lea \ATSP(n+1)$ 
достаточно установить взаимно однозначное соответствие между множеством гамильтоновых контуров полного орграфа $D=(V,A)$ на $n$ вершинах и подмножеством 
гамильтоновых контуров орграфа $D'=(V',A')$ на $n+1$ вершинах, в котором удалены все дуги, входящие в вершину $v'_1$, и дуги, выходящие из $v'_{n+1}$, за исключением дуги $(v'_{n+1}, v'_1)$.
Заметим, что характеристические вектора указанного подмножества контуров оргафа $D'=(V',A')$ являются вершинами грани 
\[F = \Set*{\bm{x} \in \ATSP(n+1) \given x_{(v'_{n+1}, v'_1)} = 1}
\]
многогранника $\ATSP(n+1)$.
Очевидно, грань $F$ и многогранник $\ATSP(n)$ связаны биективным аффинным отображением
\[
	y_{(v_i, v_j)} = 
	\begin{cases}
	x_{(v'_i, v'_j)}, & \text{при }1 \le i \le n, \ 2 \le j \le n, \ i \ne j,\\
	x_{(v'_i, v'_{n+1})}, & \text{при }2 \le i \le n, \ j=1,\\
	\end{cases}
\]
где $\bm{x} \in F$, $\bm{y} \in \ATSP(n)$.

Для доказательства соотношения $\Knap(\bm{a}, b) \lea \Knap((\bm{a},0), b)$ достаточно заметить, что 
\[
\Knap((\bm{a},0), b) = \Set*{(\bm{x},x_{n+1}) \in \{0,1\}^{n+1} \given \bm{x} \in \Knap(\bm{a}, b)}.
\]
Следовательно, многогранник $\Knap(\bm{a}, b)$ аффинно эквивалентен грани многогранника $\Knap((\bm{a},0), b)$, образованной гиперплоскостью $x_{n+1} = 0$.
% (или $x_{n+1} = 1$).
\end{proof}

Соотношение \eqref{eq:compareDeltaCP} является простым примером сравнения многогранников из разных семейств.
Еще одним таким фактом, открытым независимо несколькими авторами~\cite[с.~84]{Deza:2001}, является \emph{ковариантное отображение} $\xi\from \BQP(n) \to \Cut(n+1)$, задаваемое уравнениями
\[
y_{ij} = 
\begin{cases}
x_{ii}, & \text{при } 1 \le i \le n, \ j=n+1,\\
x_{ii} + x_{jj} - 2 x_{ij}, & \text{при } 1 \le i < j \le n.\\
\end{cases}
\]
%где $\bm{x} \in \BQP(n)$, $\bm{y} \in \Cut(n+1)$.
Из невырожденности этого отображения следует
\[
\BQP(n) =_A \Cut(n+1).
\]

Рассмотрим еще два семейства многогранников, ассоциированных с задачами об упаковке и разбиении множества.

Пусть $A\in\{0,1\}^{m\times n}$ "--- матрица инциденций элементов множества $G = \{g_1, \ldots, g_m\}$ и элементов некоторого множества $S = \{S_1, \ldots, S_n\} \subseteq 2^G$.
Выпуклая оболочка множества
\[
\Pack(A) = \Set*{\bm{x}\in\{0,1\}^n \given A \bm{x} \le \bm{1}}
%\quad \text{где } A\in\{0,1\}^{m\times n},
\]
называется \emph{многогранником упаковок множества}~\cite{Balas:1976}.
(Каждая вершина $\bm{x} \in \Pack(A)$ этого многогранника является характеристическим вектором некоторой упаковки $T \subseteq S$.)

Множество вершин \emph{многогранника разбиений множества} определяется по аналогии:
\begin{equation}
\label{eq:Part}
\Part(A) = \Set*{\bm{x}\in\{0,1\}^n \given A \bm{x} = \bm{1}}.
\end{equation}
Непосредственно из определения следует
\begin{equation}
\label{eq:PartPack}
\Part(A) \lea \Pack(A).
\end{equation}

Заметим также, что многогранник независимых множеств $\Stable(G)$ (см. определение на с.~\pageref{def:Stable}) является частным случаем многогранника упаковок множеств:
\begin{equation}
\label{eq:StablePack}
\Stable(G) =_A \Pack(A),
\end{equation}
если $A$ является матрицей инциденций ребер"=вершин графа $G$.



\subsection{Сравнение семейств многогранников}

Прежде, чем перейти к сравнению семейств многогранников, установим еще несколько простых соотношений между $\Stable(G)$, $\Part(A)$, $\Pack(A)$ и $\BQP(n)$.

\begin{lemma}
	\label{lem:PackStable}
	Для любой матрицы $A\in\{0,1\}^{m\times n}$ существует граф $G$ на $n$ вершинах такой, что $\Pack(A) =_A \Stable(G)$.
\end{lemma}

\begin{proof}
	Достаточно заметить, что каждое неравенство вида
	$$
	x_1 + x_2 + \ldots + x_k \le 1
	$$
	из системы $A\bm{x} \le \bm{1}$ при условии $\bm{x}\in \{0,1\}^n$
	эквивалентно набору неравенств
	$$
	x_i + x_j \le 1, \quad 1\le i < j \le k,
	$$
	определяющих некоторый многогранник независимых множеств.
\end{proof}

Учитывая соотношение~\eqref{eq:StablePack}, можно сделать вывод о том, что семейства $\{\Pack(A)\}$ и $\{\Stable(G)\}$ идентичны (состоят из одних и тех же многогранников).

\begin{lemma}
	\label{lem:StablePart}
	Для любого графа $G=(V,E)$ существует матрица $A\in\{0,1\}^{m\times n}$, $m = |E|$, $n = |V|+|E|$, такая, что $\Stable(G) =_A \Part(A)$.
\end{lemma}
	
\begin{proof}
	Для каждого неравенства 
	\begin{equation}
		\label{eq:Stable2}
		x_v + x_u \le 1,  \quad \{v,u\} \in E,
	\end{equation}
	из описания многогранника $\Stable(G)$ введем вспомогательную переменную $y_{vu} = 1 - x_v - x_u$.
	Остается заметить, что множество 0/1-векторов, удовлетворяющих неравенствам~\eqref{eq:Stable2}, аффинно эквивалентно множеству 0/1-векторов, удовлетворяющих уравнениям
	\begin{equation*}
		x_v + x_u + y_{vu} = 1,  \quad \{v,u\} \in E.
	\end{equation*}
\end{proof}

Таким образом, согласно соотношению~\eqref{eq:PartPack}, семейство $\{\Part(A)\}$ содержит не только все многогранники семейств $\{\Pack(A)\}$ и $\{\Stable(G)\}$, но и некоторые их грани.

Введем теперь ключевое понятие этой главы "--- аналог полиномиальной сводимости Кука--Карпа--Левина~\cite{Garey:1982} для семейств многогранников.
Сумму длины кода многогранника и размерности пространства, в котором он определен, будем называть \emph{размером} многогранника.
%Очевидно, размер многогранника есть не что иное, как длина входа соответствующей задачи комбинаторной оптимизации.
Таким образом, размер многогранника пропорционален длине входа соответствующей задачи комбинаторной оптимизации, если размер координат целевого вектора задачи ограничен сверху некоторой константой.

%\begin{definition}
%	\label{def:Aff}
%	Семейство многогранников $P$ \emph{аффинно сводится} к семейству многогранников $Q$, если для каждого многогранника $p\in P$ найдется $q\in Q$ такой, что $p \lea q$, причем размерность пространства, в котором определен многогранник $q$, ограничена сверху полиномом от размерности пространства, в котором задан $p$.
%	Обозначение: $P \propto_A Q$.  
%\end{definition}

%Заметим, что длина входа\footnote{Предполагается использование разумной схемы кодирования входных данных~\cite{Garey:1982}.} для задачи проверки несмежности вершин пропорциональна сумме длины кода $s$ и размерности $d(s)$.


\begin{definition}
	\label{def:Aff}
	Будем говорить, что семейство многогранников $P$ \emph{аффинно сводится} к семейству многогранников $Q$, если для каждого многогранника $p\in P$ найдется $q\in Q$ и аффинное отображение $\alpha$, задаваемое системой 
	\[
	\bm{y} = A\bm{x} + \bm{b}, \qquad \bm{x} \in p, \quad \bm{y} \in q, 
	\]
	такие, что:
	\begin{enumerate}
		\item\label{item:1} Образ $\alpha(p)$ является гранью (возможно несобственной) многогранника $q$ и аффинно эквивалентен $p$.
		%Далее этот факт обозначаем так: $p \lea q$.
%		\item\label{item:2} Размерность пространства, в котором определен многогранник $q$, ограничена сверху полиномом от размерности пространства для $p$.
		\item\label{item:3} Размер многогранника $q$ ограничен сверху полиномом от размера многогранника $p$.
		\item\label{item:4} Коэффициенты %аффинного отображения $\alpha$
		матрицы $A$ и вектора $\bm{b}$ 
		вычисляются за полиномиальное время относительно размера многогранника $p$.
	\end{enumerate}
	Факт аффинной сводимости $P$ к $Q$ обозначаем так: $P \propto_A Q$.  
\end{definition}

%Отметим, что это определение отличается от определения аффинной сводимости,
% введенного ранее в монографии \cite{Bondarenko:2008}, 
% в сторону усиления условий.

\begin{remark}
	В определении \ref{def:Aff} важным условием является полиномиальная зависимость размеров многогранников, а~не~их размерностей. 
	Дело в том, что система ограничений, определяющих многогранник, может оказаться далеко не самым экономным способом его описания. Тем не менее, нашей целью является именно сравнение входных данных задач, ассоциированных с многогранниками.
	
	В качестве примера многогранника с неэкономным описанием можно рассмотреть $\Part(A)$, задаваемый уравнениями
	\[
	x_1 + x_i + x_j = 1, \quad 2 \le i < j \le n.
	\]
	Очевидно, он состоит из одной единственной точки $(1,0,\dots,0)$.
	Вместе с тем, согласно \eqref{eq:PartPack}, он является гранью многогранника $\Pack(A)$, определяемого неравенствами
	\[
	x_1 + x_i + x_j \le 1, \quad 2 \le i < j \le n,
	\]
	и имеющего размерность $n$.
	Такой <<неэкономный>> способ сравнения многогранников вполне допускается определением~\ref{def:Aff}.
\end{remark}

\begin{remark}
	Определение \ref{def:Aff} отличается от определения аффинной сводимости в~\cite{Maksimenko:2013NP,Maksimenko:2016bool} наличием условий~\ref{item:3} и~\ref{item:4} (полиномиальность размера многогранника $q$ и коэффициентов аффинного отображения).
	Тем не менее, для всех фактов аффинной сводимости, упоминаемых в работах~\cite{Maksimenko:2013NP,Maksimenko:2016bool}, справедливость этих условий легко проверяется, так как соответствующие аффинные отображения описаны явным образом.
\end{remark}

\begin{remark}
Как правило, доказательство аффинной сводимости семейства $P$ к семейству $Q$ выполняется по следующей схеме.
Для каждого кода $I$, задающего многогранник $p(I)\in P$ приводится описание кода $I'$ многогранника $q(I')\in Q$, его грани $F$ и биективного аффинного отображения $\alpha\colon p(I) \to F$.
Справедливость условий \ref{item:3} и \ref{item:4} определения \ref{def:Aff}, как правило, очевидна.
Поэтому в дальнейшем мы не уделяем внимание проверке этих условий, а сам факт аффинной сводимости формулируем как утверждение вида
<<Для каждого кода $I$, задающего многогранник $p(I)$ из семейства $P$, существует код $I'$, определяющий многогранник $q(I')\in Q$, такой, что $p(I) \lea q(I')$>>.
(Примерами %такого рода утверждений 
могут служить леммы \ref{lem:PackStable} и \ref{lem:StablePart}.)
Наш выбор объясняется тем, что данное утверждение, в отличие от $P \propto_A Q$, содержит информацию о качестве свед\'ения. 
\end{remark}


На основе выведенных выше соотношений приведем несколько примеров использования обозначения из определения~\ref{def:Aff}.
Так, соотношение \eqref{eq:compareDeltaCP} можно переписать в виде $\Delta \propto_A \CP$. 
А из лемм \ref{lem:StablePart}, \ref{lem:PackStable} и соотношения 	\eqref{eq:PartPack} следует
 
\begin{theorem}
	\label{thm:Class1}
	$\Stable \propto_A \Part \propto_A \Pack \propto_A \Stable$,
	где $\Stable = \{\Stable(G)\}$, $\Part = \{\Part(A)\}$, $\Pack = \{\Pack(A)\}$.
\end{theorem}

Перечислим некоторые очевидные свойства этого типа сводимости. 

\begin{theorem}
	\label{thm:Prop}
	Пусть $P \propto_A Q$. 
	Предположим, что в семействе $P$ есть многогранники, имеющие одно или несколько из следующих свойств:
	\begin{enumerate}
	\item Cверхполиномиальность числа вершин или гиперграней (относительно размера многогранника).
	\item Cверхполиномиальное кликовое число графа многогранника.
	\item NP-полнота критерия несмежности вершин.
	\item Cверхполиномиальное число прямоугольного покрытия.
	\item Cверхполиномиальная сложность расширения.
	\end{enumerate}
	\noindent
	Тогда в $Q$ имеются многогранники с теми же свойствами.
\end{theorem}

Сравним теперь семейства $\BQP = \{\BQP(n)\}$ и $\Stable$.


\begin{theorem}
	\label{thm:BQPStable}
	Для каждого $n\in \N$ существует граф $G = (V,E)$, $|V| = n(n+1)$, $|E| = n(2n-1)$, такой, что
	$\BQP(n) \lea \Stable(G)$.
\end{theorem}
(Похожий результат получен в~\cite{FioriniPokutta:2015}, но с более слабым соотношением $\lee$ (см. определение~\ref{def:ineE} на с.~\pageref{def:ineE}) и при $|V| = 2 n^2$.)
% Кроме того, представленное ниже доказательство значительно проще изложенного в~\cite{FioriniPokutta:2015}.)

\begin{proof}
	Каждое равенство $x_{ij} = x_{ii} x_{jj}$ из уравнения~\eqref{eq:BQP}, определяющего булев квадратичный многогранник, эквивалентно неравенствам
	\begin{equation}
	\label{eq:Clique}
	\begin{aligned}
	x_{ii} - x_{ij} &\ge 0, \\
	x_{jj} - x_{ij} &\ge 0, \\
	x_{ii} + x_{jj} - x_{ij} &\le 1,
	\end{aligned}
	\end{equation}
	при условии $x_{ij}\in\{0, 1\}$, $1\le i \le j \le n$.
	Остается преобразовать их в систему неравенств вида $y_l + y_m \le 1$. %из~\eqref{SSP}.
	Для этого введем $n(n+1)$ новых 0/1-переменных:
	\begin{equation}
	\label{eq:BQP2SSP}
	\begin{aligned}
	s_{ij} &= x_{ij},           & 1 &\le i  <  j \le n,\\
	t_{ij} &= x_{ii} - x_{ij},  & 1 &\le i  <  j \le n,\\
	u_i    &= x_{ii},           & 1 &\le i \le n,\\
	\bar{u}_i    &= 1 - x_{ii}, & 1 &\le i \le n.\\
	\end{aligned}
	\end{equation}
	Тогда ограничения~\eqref{eq:Clique} эквивалентны
	%\begin{equation}\label{eq:SSP2}
	$$
	\begin{aligned}
	s_{ij} + \bar{u}_j & \le 1, \\
	t_{ij} + u_j       & \le 1, \\
	u_i    + \bar{u}_i & =   1, \\
	s_{ij} + t_{ij} + \bar{u}_i & = 1,
	\end{aligned}
	$$
	%\end{equation}
	при условии целочисленности всех переменных.
	Очевидно, последние два равенства (точнее, $n(n+1)/2$ подобных равенств)
	определяют некоторую грань многогранника $\Stable(G)$, где число вершин графа $G$ равно $n(n+1)$, а $n (2n - 1)$ его ребер определяют систему неравенств
	%\begin{equation}\label{eq:SSP2}
	$$
	\begin{aligned}
	s_{ij} + \bar{u}_j & \le 1, \\
	t_{ij} + u_j       & \le 1, \\
	u_i    + \bar{u}_i & \le 1, \\
	%   s_{ij} + t_{ij}    & \le 1, \\
	s_{ij} + \bar{u}_i & \le 1, \\
	t_{ij} + \bar{u}_i & \le 1.
	\end{aligned}
	$$
	%\end{equation}
	Более того, соотношения~\eqref{eq:BQP2SSP} связывают эту грань с многогранником $\BQP(n)$ невырожденным аффинным отображением.
\end{proof}

\begin{prop}
	\label{prop:StableBQP}
	Если граф $G=(V,E)$ неполный, то соотношение $\Stable(G) \lea \BQP(n)$ невозможно ни при каком $n$.
\end{prop}

\begin{proof}
Прежде всего заметим, что в множество вершин $\Stable(G)$ всегда входят вектора $\bm{0}$, $\bm{e_1}$, \dots, $\bm{e_d}$, где $d=|V|$.
Если граф $G=(V,E)$ неполный, то $\Stable(G)$ кроме <<обязательных>> векторов содержит еще как минимум один 0/1"~вектор. Пусть $\bm{x}$ "--- один из таких (необязательных) векторов. Легко заметить, что вершины $\bm{0}$ и $\bm{x}$ многогранника $\Stable(G)$ несмежны, так как соединяющий их отрезок пересекается с выпуклой оболочкой вершин $\bm{e_1}$, \dots, $\bm{e_d}$.
Следовательно, многогранник $\Stable(G)$ не является 2"~смежностным.
Остается заметить, что многогранник $\BQP(n)$ (а вместе с ним и его грани) является 2"~смежностным~\cite{Padberg:1989}.
\end{proof}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% End of section
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
