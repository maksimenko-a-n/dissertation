%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%     Аффинная сводимость
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Циклические многогранники}

\hfill
\begin{minipage}{0.5\textwidth}
Циклические многогранники обладают максимальным числом граней среди всех выпуклых многогранников той же размерности и с таким же числом вершин.
\begin{flushright}
%Peter McMullen
Питер МакМюллен
\end{flushright}
\end{minipage}

\section{Определение и свойства}

В этом разделе приводится определение циклических многогранников и перечисляются их некоторые свойства.
Более подробную информацию о циклических многогранниках можно найти в~\cite{Grunbaum:2003} и~\cite{ZieglerBook}.

Пусть $T = \{t_1, \dots, t_n\} \subset \R$, $t_1 < t_2 < \dots < t_n$.
Зафиксируем $d \in \N$, $2 \le d < n$, и введем обозначение
\[
\bm{x}(i) \coloneq (t^{\phantom{1}}_i, t^2_i, \dots, t^d_i) \in \R^d, \qquad i\in[n]. 
\]
Сформулируем определение циклического многогранника (см. с.~\pageref{page:cyclic}) с использованием новых обозначений.
\emph{Циклическим многогранником} называется выпуклая оболочка множества
\[
\CP_d(T) \coloneq \{\bm{x}(1), \dots, \bm{x}(n)\}.
\]
Причем $\CP_d(T)$ "--- множество вершин этого многогранника.
Число $i\in[n]$ будем называть \emph{номером} вершины $\bm{x}(i)$.

\begin{theorem}[условие четности Гейла~\cite{Gale:1963}]
Многогранник $\CP_d(T)$ симплициален, то есть каждая его гипергрань содержит ровно $d$ вершин. Причем подмножество вершин с номерами из $S \subset [n]$, $|S|=d$, образует гипергрань тогда и только тогда, когда выполнено <<условие четности>>:
\[
\text{мощность множества } [k_1, k_2]\cap S \text{ четна для всех } k_1, k_2 \in [n] \setminus S, \ k_1 < k_2.
\]
\end{theorem}

Для $n=7$ примерами множеств, удовлетворяющих условию четности, могут служить
$\{1,5,6\}$, $\{1,7\}$, $\{2,3,4,5\}$ и $\{1,2,4,5,7\}$.
Таким образом, множество $S \subset [n]$, удовлетворяющее условию четности, однозначно разбивается на пары вида $\{i,i+1\}$ и, быть может, элементы $1$ и $n$.

Доказательство справедливости условия четности Гейла опирается на следующие факты:
\begin{enumerate}
\item Для любого $\bm{a} \in \R^d$ значения линейной функции $g(\bm{x}) = \bm{a}^T \bm{x}$ в точках $\bm{x}(i)$, $i\in[n]$, множества $\CP_d(T)$ совпадают со значениями многочлена $f(t) = a_1 t + a_2 t^2 + \dots + a_d t^d$ в точках $t_i$. То есть уравнение вида $f(t) = b$ задает гиперплоскость $\bm{a}^T \bm{x} = b$.
\item Многочлен вида 
\begin{equation}
\label{eq:CyclicPol}
f(t) = (t - t_1)(t_n - t) \prod_{i \in I} \bigl((t - t_i)(t - t_{i+1})\bigr), \quad I\subset [n],
\end{equation}
принимает нулевые значения в точках $t_1$, $t_n$, $t_i$, $t_{i+1}$, $i\in I$, и положительные значения в остальных точках из $T$.
\end{enumerate}
Таким образом, для каждого множества, удовлетворяющего условию четности, можно построить многочлен вида~\eqref{eq:CyclicPol}, определяющий гиперплоскость $f(t) = 0$, опорную для $\CP_d(T)$.


\section{Компактная расширенная формулировка}
\label{sec:EF4Cyclic}

Пусть, как и прежде, $T = \{t_1, \dots, t_n\} \subset \R$, $t_1 < t_2 < \dots < t_n$, $d \in \N$, $2 \le d < n$.
В этом разделе мы ограничиваемся рассмотрением только тех случаев, когда $t_{i+1} = t_i + 1$ для всех $i\in[n-1]$, и будем пользоваться более подходящим обозначением
\[
\CP_{d,n}(t_1) \coloneq \CP_d(T).
\]


\subsection{Случай $d=2$}

Заметим, что многогранники $\CP_{d,n}(t)$ и $\CP_{d,n}(s)$ аффинно изоморфны для любых $t,s \in \R$. 
А именно, из бинома $(t + (s-t))^i = \sum_{j=0}^i \binom{i}{j} (s-t)^{i-j} t^j$ получаем следующее аффинное отображение, определяющее изоморфизм между $\CP_{d,n}(t)$ и $\CP_{d,n}(s)$:
\begin{equation}\label{eq:affine_isomorphism} 
y_i:=(s-t)^i+\sum_{j=1}^i \binom{i}{j} (s-t)^{i-j} x_j, 
\end{equation}
где $(x_1,\ldots,x_d) \in \CP_{d,n}(t)$, $(y_1,\ldots,y_d) \in \CP_{d,n}(s)$.

Согласно только что сделанному замечанию, мы будем пользоваться кратким обозначением $\CP_{d,n}$ в тех случаях, когда выбор начального значения не влияет на результат рассуждений.


\begin{lemma}\label{lem:two_dim}
$\xc(\CP_{2,n}(t)) \le 2\lfloor \log_2(n-1)\rfloor+2$, где $n \ge 3$ и $t \in \R$.
\end{lemma}

\begin{proof}
Согласно~\eqref{eq:affine_isomorphism}, многогранник~$\CP_{2,n}(t)$ можно аффинно преобразовать в многогранник
\[
\CP_{2,n}(-(n-1)/2).
\] 
	
В свою очередь, для каждого $k\in\N$ многогранник~$\CP_{2,2k+1}(-k)$ может быть представлен как выпуклая оболочка двух многогранников $\CP_{2,k+1}(-k)$ и~$\CP_{2,k+1}(0)$:
%
\[
\CP_{2,2k+1}(-k) = \conv(\CP_{2,k+1}(-k) \cup \CP_{2,k+1}(0)).
\]
Аналогичное представление существует и для многогранника $\CP_{2,2k}(-k + 1/2)$:
\[
\CP_{2,2k}(-k + 1/2) = \conv(\CP_{2,k}(-k + 1/2) \cup \CP_{2,k}(1/2)), \quad k\in\N.
\]
	
Воспользуемся тем, что многогранник $\CP_{2,k+1}(-k)$ является образом многогранника $\CP_{2,k+1}(0)$ при зеркальном отражении относительно гиперплоскости $x_1 = 0$ (отображение определяется сменой знака первой координаты). То же верно и в отношении $\CP_{2,k}(-k + 1/2)$ и $\CP_{2,k}(1/2)$.

Этот факт позволяет на основе свойства зеркальной симметрии (см. Theorem~2 в~\cite{KaibelPashkovich:2013}) и~\eqref{eq:affine_isomorphism} сделать вывод о том, что каждая расширенная формулировка размера $h$ для многогранника $\CP_{2, \lceil n/2 \rceil}$ определяет расширенную формулировку размера $(h+2)$ для $\CP_{2,n}$. В частности, расширенная формулировка для $\CP_{2,2k+1}(-k)$ может быть такой:
\[
\CP_{2,2k+1}(-k)=\Set*{(x_1,x_2)\in\R^2 \given \text{найдется } z_1, \text{ что }(z_1,x_2)\in \CP_{2,k+1}(0) \text{ и } -z_1 \le x_1\le z_1}\,.
\]
Таким образом, $\xc(\CP_{2k+1}) \le \xc(\CP_{k+1}) + 2$ и $\xc(\CP_{2k}) \le \xc(\CP_{k}) + 2$.
	
Неравенство $\xc(\CP_{2,n}) \le 2 \lfloor \log_2(n-1) \rfloor + 2$ легко проверяется для $n = 3,4,5$. 
Следовательно, для завершения доказательства достаточно воспользоваться неравенствами
\[
\xc(\CP_{2,2k}) \le \xc(\CP_{2,k}) + 2 \le  2 \lfloor \log_2(k-1) \rfloor + 4 =2 \lfloor \log_2 (2k-2) \rfloor + 2
\]
и
\[\xc(\CP_{2,2k-1}) \le \xc(\CP_{2,k}) + 2 \le 2 \lfloor \log_2(k-1) \rfloor + 4 = 2 \lfloor \log_2 \big((2k-1) - 1\big) \rfloor + 2\,.
\]
Таким образом,
\[
\xc(\CP_{2,n}) \le  2\lfloor \log_2(n-1)\rfloor+2
\]
для всех $n\ge 3$.
\end{proof}

\begin{remark}
Более аккуратный разбор финальной части доказательства леммы~\ref{lem:two_dim}
позволяет улучшить верхнюю оценку сложности расширения до 
\[
\xc(\CP_{2,n}) \le 2\lfloor \log_2(n-1)\rfloor + 1 + \delta_n,
\]
где $\delta_n = 0$, если $2^k < n \le 3 \cdot 2^{k-1}$ для некоторого $k\in \N$, и $\delta_n = 1$ в остальных случаях.
\end{remark}


\subsection{Случай $d \ge 3$}

К сожалению, при $d \ge 3$ взаимосвязь между многогранниками $\CP_{d,k+1}(-k)$ и~$\CP_{d,k+1}(0)$ не так проста: многогранник $\CP_{d,k+1}(-k)$ является образом~$\CP_{d,k+1}(0)$ при смене знака координат с нечетным индексом. Это не соответствует симметрии относительно гиперплоскости и, следовательно, мы не можем воспользоваться свойствами зеркальной симметрии. 

Однако, мы можем воспользоваться теоремой Яннакакиса (теорема~\ref{thm:Yannakakis} на с.~\pageref{thm:Yannakakis})
и низкоранговой неотрицательной факторизацией матрицы невязок (см. определения~\ref{def:slack} и~\ref{def:nonneg}) многогранника~$\CP_{2,n}$, гарантируемой Леммой~\ref{lem:two_dim}. 

Строки матрицы невязок $M_{d,n}$ многогранника $\CP_{d,n}(t)$ будем индексировать элементами из $[n]$, а столбцы "--- множествами $S \subset [n]$, $|S|=d$, удовлетворяющими условию четности Гейла.
Согласно приведенным выше рассуждениям (см. формулу~\eqref{eq:CyclicPol} и комментарии к ней), эта матрица может быть представлена как
%
\begin{equation}
\label{eq:slack}
M_{d,n}(i,S) := \prod_{j \in S} |t_j - t_i|\,,
\end{equation}
%
где $i\in[n]$ и $S\subseteq [n]$, $|S|=d$, удовлетворяет условию четности Гейла.
В частности, матрица невязок не зависит от начального параметра $t$ в определении многогранника $\CP_{d,n}(t)$, так как он не меняет разности $t_j - t_i$. 

Перечислим некоторые очевидные свойства неотрицательного ранга матрицы.

\begin{property}\label{prop:nonneg}
Следующие операции над строками (столбцами) матрицы не увеличивают ее неотрицательный ранг:
\begin{enumerate}
	\item Перестановка строк (столбцов).
	\item Дублирование строки (столбца).
	\item Удаление строки (столбца).
	\item Умножение строки (столбца) на неотрицательное число.
	\item Добавление в матрицу новой строки (столбца), равной(ого) конической комбинации строк (столбцов).
\end{enumerate}
\end{property}

\begin{property}\label{prop:nonnegsum}
Пусть $M \in \R_+^{m\times n}$ и $S\subseteq[n]$. Пусть $M_1$ "--- подматрица матрицы $M$, составленная из столбцов с номерами из $S$, а $M_2$ "--- подматрица, составленная из столбцов с номерами из $[n]\setminus S$.
Тогда
\[
\rank_+(M) \le \rank_+(M_1) + \rank_+(M_2).
\]
\end{property}

Для двух матриц $A$ и $B$ одинакового размера, определим поэлементное произведение $A \circ B$ с помощью уравнения $(A \circ B)(i,j):=A(i,j) B(i,j)$. Кроме перечисленных выше свойств нам понадобится следующий фольклорный факт. 

\begin{lemma}
\label{lem:Kronecker}
Для любых двух матриц $A$ и $B$ с одинаковым числом строк и столбцов,
\[
\rank_+(A \circ B) \le \rank_+(A) \rank_+(B).
\]
\end{lemma}
%
\begin{proof}
Пусть $A,B \in \R_+^{n\times m}$ и
\begin{align*}
A &= TU, && \text{где }T\in \R_+^{n\times r}, \quad U\in \R_+^{r\times m},\\
B &= HW, && \text{где }H\in \R_+^{n\times s}, \quad W\in \R_+^{s\times m}.
\end{align*}
Через $M_i$ будем обозначать $i$-ю строку матрицы $M$, а через $M^j$ "--- $j$-ый столбец.
Строки $C_i$, $i\in[n]$, матрицы $C \in \R_+^{n \times rs}$ определим тензорным произведением
\[
C_i = T_i\otimes H_i,
\]
а столбцы $D^j$, $j\in[m]$, матрицы $D \in \R_+^{rs \times m}$ "--- произведением
\[
D^j = U^j\otimes W^j.
\]
Тогда
\[
A\circ B = CD.
\]
\end{proof}

Перейдем непосредственно к доказательству основного утверждения этого раздела.
Прежде всего рассмотрим четную размерность, положив~$d = 2q$, $q\in \N$.

\begin{lemma}
\label{lem:even_case}
$\xc(\CP_{2q, n}) \le \big(\xc(\CP_{2, n})\big)^q$ при $q,n\in\N$, $2q < n$.
\end{lemma}

\begin{proof}
Мы построим $q$ матриц $C_1$, \dots, $C_q$ таких, что поэлементное произведение $C_1 \circ \cdots \circ C_q$ равно матрице невязок $M_{2q, n}$. 
С этой целью заметим, что каждое множество $S\subseteq[n]$, $|S|=2q$, удовлетворяющее условию четности Гейла, может быть разбито на $q$ пар $S_1$, \dots, $S_q$, где каждая пара либо равна $\{1,n\}$, либо состоит из двух последовательных целых. 
Каждое множество $S_r$, $1\le r\le q$, также удовлетворяет условию четности Гейла и состоит из двух элементов. 
Следовательно, для каждого $S_r$ найдется соответствующий столбец в $M_{2, n}$ такой, что
\[
	M_{2,n}(i,S_r)=\prod_{j\in S_r} |j-i|\,.
\]
Теперь определим ячейки матриц $C_1$, \dots, $C_q$ в столбце, индексированном множеством $S$, как $C_r(i,S):=M_{2,n}(i,S_r)$. 
Заметим, что
\[
(C_1 \circ \cdots \circ C_q)(i,S) = \prod_{r = 1}^q \prod_{j \in S_r} |j-i| = \prod_{j \in S} |j-i| = M_{2q,n}(i,S)\,.
\]
	
Несложно проверить, что матрицы $C_1$, \dots, $C_q$ получены из $M_{2,n}$ за счет дублирования, удаления и перестановки столбцов. 
Следовательно, согласно cвойству~\ref{prop:nonneg}, неотрицательный ранг каждой из этих матриц ограничен сверху неотрицательным рангом матрицы $M_{2,n}$. 
Таким образом, согласно лемме~\ref{lem:Kronecker}, матрица невязок $M_{2q, n}$ допускает неотрицательную факторизацию размера $\big(\xc(P_{2,n})\big)^q$.
\end{proof}

%\subsection[Случай d=2q+1]{Случай $\di=2q+1$}


\begin{lemma}\label{lem:odd_case} 
$\xc(P_{2q+1,n}) \le 2 \xc(P_{2q,n-1})$ при $q,n\in\N$, $2q+1 < n$.
\end{lemma}
%
\begin{proof}
Покажем, что $\xc(P_{2q+1, n}(1)) \le \xc(P_{2q, n-1} (2)) + \xc(P_{2q, n-1}(1)) = 2 \xc(P_{2q, n-1})$.
	
Для каждого множества $S\subseteq[n]$, $|S|=2q+1$, удовлетворяющего условию четности Гейла, выполняется ровно одно из двух условий:
%
\begin{enumerate}
	\item \label{case:last_element} $n\in S$ и множество $S\setminus\{n\}$ определяет гипергрань многогранника $P_{2q, n-1}(1)$.
	\item \label{case:first_element} $1\in S$ и множество $S\setminus\{1\}$ определяет гипергрань многогранника $P_{2q, n-1}(2)$.
\end{enumerate}
Разобъем матрицу невязок $M_{2q+1, n}$ на две подматрицы. Подматрица $M_1$ будет состоять из столбцов, удовлетворяющих условию~\ref{case:last_element}, а подматрица $M_2$ "--- из столбцов, удовлетворяющих условию~\ref{case:first_element}.
Согласно свойству~\ref{prop:nonnegsum}, 
\[
\rank_+(M_{2q+1, n}) \le \rank_+(M_1) + \rank_+(M_2).
\]

Прежде всего заметим, что последняя строка матрицы $M_1$ и первая строка матрицы $M_2$ состоят из нулей.
Для $i \in [n-1]$, $i$-я строка матрицы $M_1$ равна $i$-ой строке матрицы $M_{2q, n-1}$, умноженной на положительное число $n-i$.
Таким образом, $\rank_+(M_1) = \rank_+(M_{2q, n-1})$.
Аналогично, при $i \in [2,n]$, $i$-я строка матрицы $M_2$ равна $(i-1)$-ой строке матрицы $M_{2q, n-1}$, умноженной на положительное число $i-1$.
Следовательно, $\rank_+(M_2) = \rank_+(M_{2q, n-1})$.
\end{proof}

Из лемм \ref{lem:two_dim}, \ref{lem:even_case} и \ref{lem:odd_case} следует

\begin{theorem}
\label{thm:main}
$\xc(P_{d,n}) \le 2\bigl(2\lfloor \log_2(n-1)\rfloor+2\bigr)^{\lfloor d/2 \rfloor}$ при $2 \le d < n$.
\end{theorem}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  Алгоритм факторизации матрицы невязок для d=2
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\subsection{Алгоритм факторизации матрицы невязок для $d=2$}

В этом разделе для матрицы невязок $M_{2,n}$ описана явная неотрицательная факторизация размера $2\lceil\log(n-1)\rceil + 1$. 
Эта факторизация похожа на ту, что описана в~\cite{Fiorini:2012polygons} для матрицы невязок правильного многоугольника.

Согласно определению матрицы невязок циклического многогранника $\CP_{2,n}$,
\[
M_{2,n}(i,j) = 
\begin{cases}
(i-j)(i-j-1), & \text{при } j < n,\\
(i-1)(n-i), & \text{при } j = n.
\end{cases}
\]
При $j \in [n-1]$, $j$-ый столбец этой матрицы соответствует множеству $\{j,j+1\}$, а $n$-ый столбец "--- множеству $\{1,n\}$.

В частности,
\begin{equation*}
\begin{split}
M_{2, 8} & =
\begin{pmatrix}
0	&  2	&  6	& 12	& 20	& 30	& 42	&  0 \\
0	&  0	&  2	&  6	& 12	& 20	& 30	&  6 \\
2	&  0	&  0	&  2	&  6	& 12	& 20	& 10 \\
6	&  2	&  0	&  0	&  2	&  6	& 12	& 12 \\
12	&  6	&  2	&  0	&  0	&  2	&  6	& 12 \\
20	& 12	&  6	&  2	&  0	&  0	&  2	& 10 \\
30	& 20	& 12	&  6	&  2	&  0	&  0	&  6 \\
42	& 30	& 20	& 12	&  6	&  2	&  0	&  0
\end{pmatrix}               
\end{split}
\end{equation*}

Вся процедура вычисления факторизации состоит из двух последовательно выполняемых алгоритмов.
Прежде всего, с помощью алгоритма~\ref{alg:leftfactor},
инициализируется массив удвоенных осей симметрии $\text{A}$, длины $\text{q} = \lceil\log(n-1)\rceil$, и вычисляется левый множитель факторизации $\text{T} \in \R_+^{n \times (2q+1)}$.
Далее, используя массив A, алгоритм~\ref{alg:rightfactor} вычисляет правый множитель факторизации $\text{U} \in \R_+^{(2q+1)\times n}$.

Результат применения этого алгоритма для $n=8$ выглядит так:
\begin{equation*}
	M_{2, 8} = 
	\begin{pmatrix}
	0	& 7	& 0	& 4	& 0	& 2	& 0  \\
	0	& 5	& 0	& 2	& 0	& 0	& 6  \\
	0	& 3	& 0	& 0	& 2	& 0	& 10 \\
	0	& 1	& 2	& 0	& 0	& 0	& 12 \\
	1	& 0	& 2	& 0	& 0	& 0	& 12 \\
	3	& 0	& 0	& 0	& 2	& 0	& 10 \\
	5	& 0	& 0	& 2	& 0	& 0	& 6  \\
	7	& 0	& 0	& 4	& 0	& 2	& 0
	\end{pmatrix}               
	\cdot
	\begin{pmatrix}
	6	& 4	& 2	& 0	& 0	& 0	& 0	& 0 \\
	0	& 0	& 0	& 0	& 2	& 4	& 6	& 0 \\
	3	& 1	& 0	& 0	& 0	& 1	& 3	& 0 \\
	0	& 0	& 1	& 3	& 1	& 0	& 0	& 0 \\
	1	& 0	& 0	& 1	& 0	& 0	& 1	& 0 \\
	0	& 1	& 1	& 0	& 1	& 1	& 0	& 0 \\
	0	& 0	& 0	& 0	& 0	& 0 & 0	& 1
	\end{pmatrix}    \,.
\end{equation*}         

\SetAlgorithmName{Алгоритм}{Список алгоритмов}{} % Название на русском
\SetAlgoCaptionSeparator{.} % Отделяем название алгоритма от его номера точкой
%\SetAlgoLined % Вертикальные линии, соединяющие начало и конец блока
\DontPrintSemicolon % Не печатать точку с запятой
\SetKwProg{Proc}{Процедура}{}{конец} % Команда для процедуры
\SetKwProg{Fn}{Функция}{}{конец} % Команда для функции
% Описание входных и выходных данных
\SetKwInOut{Input}{Вход}
\SetKwInOut{Output}{Выход}
\SetKwRepeat{DoWhile}{делай}{пока} % Создаем цикл do-while
\SetKwFor{For}{для}{\string:}{конец~цикла}
\SetKwIF{If}{ElseIf}{Else}{если}{то}{иначе~если}{иначе}{конец~если}
\SetKw{KwTo}{до}
%\SetKwBlock{Loop}{loop}{endloop} % Безусловный цикл

\begin{algorithm}
	\caption{Левый множитель факторизации матрицы $M_{2,n}$} % Заголовок
	\label{alg:leftfactor}
	% Обозначения ключевых (входных-выходных) данных алгоритма
	\SetKwArray{A}{A} % Массив
	\SetKwArray{T}{T} % Массив
	\SetKwData{n}{n}
	\SetKwData{q}{q}
	% Названия новых процедур и функций
	\SetKwFunction{LeftFactor}{LeftFactor}
	% Описание входа-выхода
	\Input{ число вершин \n}
	\Output{ левый множитель факторизации \T, массив удвоенных осей симметрии \A и его длина \q}
%	\BlankLine
%	\Fn{\LeftFactor{\n}}{
		\tcp{Заполняем массив \A}
		$k \coloneq \n-1$\;
		$\q \coloneq 0$\;
		\DoWhile{$k > 1$}{
			$\A{\q} \coloneq k$\;
			$k \coloneq \lfloor(k+1)/2\rfloor$\;
			$\q \coloneq \q + 1$\;
		}
		\tcp{Вычисляем левый множитель \T}
		\For{$i \coloneq 0$ \KwTo $\n - 1$}{
			$x \coloneq i$\;
			\For{$j \coloneq 0$ \KwTo $\q - 1$}{
				$r \coloneq 2x - \A{j}$\;
				\eIf {$r > 0$} {
					$x \coloneq x - r$\;
					$\T{i, 2j} \coloneq r$\;
					$\T{i, 2j + 1} \coloneq 0$\;
				}{
					$\T{i, 2j} \coloneq 0$\;
					$\T{i, 2j + 1} \coloneq -r$\;
				}
			}
			$\T{i, 2\q} \coloneq i \cdot (\n - 1 - i)$ \tcp*[f]{Заполняем 	последний столбец}
		}
%	}
\end{algorithm}


\begin{algorithm}
	\caption{Правый множитель факторизации матрицы $M_{2,n}$} % Заголовок
	\label{alg:rightfactor}
	% Обозначения ключевых (входных-выходных) данных алгоритма
	\SetKwArray{A}{A} % Массив
	\SetKwArray{U}{U} % Массив
	\SetKwData{n}{n}
	\SetKwData{q}{q}
	% Названия новых процедур и функций
	\SetKwFunction{RightFactor}{RightFactor}
	% Описание входа-выхода
	\Input{ число вершин \n, массив осей симметрии \A и его длина \q}
	\Output{ правый множитель факторизации \U}
	\BlankLine
%	\Fn{\RightFactor{\n, \A, \q}}{
		\For{$i \coloneq 0$ \KwTo $\n - 2$}{
			$x \coloneq i+1$\;
			\For{$j \coloneq 0$ \KwTo $\q - 1$}{
				$r \coloneq 2x - \A{j} - 1$\;
				\eIf {$r > 0$} {
					$x \coloneq x - r$\;
					$\U{2j, i} \coloneq 0$\;
					$\U{2j+1, i} \coloneq r$\;
				}{
					$\U{2j, i} \coloneq -r$\;
					$\U{2j+1, i} \coloneq 0$\;
				}
			}
			$\U{2\q,i} \coloneq 0$ \tcp*[f]{Заполняем последнюю строку}
		}
		\tcp{Заполняем последний столбец}
		\For{$j \coloneq 0$ \KwTo $2\q - 1$}{
			$\U{j, \n-1} \coloneq 0$\;
		}    
		$\U{2\q, \n-1} \coloneq 1$\;
%	}
\end{algorithm}

\FloatBarrier

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Ридж-граф циклического многогранника
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Диаметр ридж-графа циклического многогранника}

Ридж-граф $d$-мерного многогранника определяется следующим образом (см. с.~\pageref{ridge-graph}). 
Его вершины соответствуют гиперграням многогранника, и две вершины соединены ребром ридж-графа, если соответствующие гиперграни ($(d-1)$-грани) имеют общий ридж ($(d-2)$-грань).
Таким образом, ридж-граф многогранника является, по-существу, графом двойственного к данному многогранника.

Так как комбинаторная структура циклического многогранника зависит только от его размерности $d$ и числа вершин $n$, в этом разделе мы будем обозначать его $\CP(d,n)$.
Из свойств циклического многогранника следует, что двойственный к нему многогранник $\CP^*(d,n)$ является простым и обладает максимальным числом вершин среди всех $d$-мерных многогранников, имеющих $n$ гиперграней.
Эти обстоятельства вселяли надежду на то, что, кроме всего прочего, 
$\CP^*(d,n)$ окажется примером многогранника с наибольшим диаметром графа. 
К сожалению, уже для $d=4$ и $n=9$ их диаметр равен $4$,
в то время как в работе~\cite{Klee:1967} приводится 
пример $4$-многогранника с тем же числом гиперграней и диаметром графа равным $5$ 
(позднее было показано~\cite{Altshuler:1980}, что это единственный, 
с точностью до комбинаторной эквивалентности, для данных 
$d=4$ и $n=9$ пример многогранника с диаметром $5$). 
Обозначим
\[
\dc=\diam \CP^*(d,n).
\]
В 1964 году В.~Кли показал \cite{Klee:1964}, что гипотеза Хирша справедлива для $\CP^*(d,n)$: 
\begin{equation}
\label{Hirsh4Cycl}
\dc\le n-d,
\end{equation}
а при $d < n\le 2d$ в \eqref{Hirsh4Cycl} выполняется равенство.
Там же было высказано предположение о том, что для $n>2d$ выполнено 
равенство $\dc=\left\lfloor n/2\right\rfloor$ 
(чуть позже в~\cite{Klee:1967} было показано, что оно неверно).
Но даже эти результаты в виду недоступности (на момент публикации основного результата этого раздела "--- теоремы~\ref{thm:RidgeGraphDiamCyclic}) работы \cite{Klee:1964} настолько плохо известны, что по прошествии более 30~лет делаются попытки нахождения величины $\dc$ для $n=2d$ с помощью 
вычислительной техники \cite{Ferrez:1998}, а в работе \cite{Lagarias:1998} 
при упоминании факта~\eqref{Hirsh4Cycl} приводится ссылка на работу 
\cite{Klee:1966}, не содержащую этого результата.

%Для того, чтобы поставить точку в этом вопросе, 
%Ниже приводится точное значение для $\dc$.


\begin{theorem}\label{thm:RidgeGraphDiamCyclic}
Диаметр $\dc$ ридж-графа циклического многогранника $\CP(d,n)$ вычисляется по формуле:
\[
	\dc=
	\begin{cases}
	n-d 				& \text{ при } d < n \le 2d,\\
	n-d  - 
	\left\lceil 
	\frac{n-2d}{ \left\lfloor \frac d 2 \right\rfloor+1}
	\right\rceil 
	& \text{ при }  n > 2d.
	\end{cases}
\]
\end{theorem}

\begin{proof}
Справедливость теоремы для $d < n \le 2d$ доказана В.~Кли \cite{Klee:1964}.
Поэтому далее будем предполагать, что
\[
n>2d.
\]

Обозначим множество вершин многогранника $\CP(d,n)$ через $X=\{x^1, x^2, \ldots, x^n\}$, предполагая, что вершины пронумерованы в порядке возрастания параметра $t$: $t_1 < t_2 < \ldots < t_n$.


Проведем доказательство теоремы для случая четной размерности:
\[
d=2k.
\]
Покажем, что 
\begin{equation}
\label{eq:RidgeIneq}
\dc \le n-d - \frac{n-2d}{k+1}
\end{equation}
и приведем пример двух гиперграней циклического многогранника,
расстояние между которыми равно целой части от~\eqref{eq:RidgeIneq}.

Из критерия Гейла следует, что множество вершин каждой гиперграни
всегда можно единственным образом разбить на $k$ непересекающихся пар вида
\[
\{x^i, x^{i+1}\},
\]
где $i\in[n]$ и сложение $i+1$ выполняется по модулю $n$ (если $i=n$, то $i+1=1$).
И, наоборот, любое подмножество $Y\subset X$ вида
\[
Y=\{x^{i_1}, x^{i_1+1}, x^{i_2}, x^{i_2+1}, \ldots, x^{i_k}, x^{i_k+1}\}
\]
есть множество вершин некоторой гиперграни.

Для наглядности дальнейшего изложения каждой вершине $x^i$ 
поставим в соответствие точку $v_i$ на окружности единичного радиуса:
\[
v_i=\bigl(\cos(2\pi i / n), \sin(2\pi i / n)\bigr).
\]
Две точки $v_i$ и $v_{i+1}$ будем называть \emph{парой}, и обозначать $p_i$.
А множество всех таких пар для $i\in[n]$ обозначим ${\mathcal P}$.

% Устанавливаем толщины линий, радиус круга и число точек на нем
\newcommand\BeginPic[2]{
	\def\rdot{1.5pt}
	\def\Rdot{3pt}
	\def\linew{1.5pt}
	\def\lineB{5pt}
	\def\lineW{3.3pt}
	\def\Radius{#1}
	\def\Larc{360/#2} % Длина мал. дуги в градусах
	%\def\Larc{20} % Длина мал. дуги в градусах
}	
\newcommand*{\Angle}[1]{(#1)*\Larc}
% Координаты точки по её номеру
\newcommand*{\cvertex}[1]{({\Radius*cos(\Angle{#1})}, {\Radius*sin(\Angle{#1})})} % Координаты для номера точки
\newcommand*{\nvertex}[1]{({\Radius*0.8*cos(\Angle{#1})}, {\Radius*0.8*sin(\Angle{#1})})}
% Дуга пунктиром
\newcommand{\ArcO}[2]{
	\draw[dashed] \cvertex{#1} arc (\Angle{#1}:\Angle{#2}:\Radius);
}
% Дуга пунктиром с пронумерованными точками на ней
\newcommand{\Arc}[2]{
	\ArcO{#1}{#2}
	\foreach \x in {#1, ..., #2} \draw[fill = black] \cvertex{\x} circle (\rdot*0.6) \nvertex{\x} node {\scriptsize\x};
}
% Рисуем фишку
\newcommand\Fishka[1]{
	\draw[line width = \linew] 
	\cvertex{#1} arc (\Angle{#1}:\Angle{#1+1}:\Radius);
	\draw[fill = black] \cvertex{#1} circle (\rdot) 
	\cvertex{#1+1} circle (\rdot);
}
% Рисуем ячейку
\newcommand\Cell[1]{
	\draw[line width = \lineB] 
	\cvertex{#1} arc (\Angle{#1}:\Angle{#1+1}:\Radius);
	\draw[fill=white, line width = 0.5*\linew] 
	\cvertex{#1} circle (\Rdot) 
	\cvertex{#1+1} circle (\Rdot);
	\draw[line width = \lineW, draw=white] 
	\cvertex{#1} arc (\Angle{#1}:\Angle{#1+1}:\Radius);
}


% Рисунок 1
\begin{figure}[tbh]
	\begin{center}
		%  \PictA
		\begin{tikzpicture}
		\BeginPic{2}{18}
		\begin{scope}[xshift=-3cm]
		\ArcO{0}{1}
		\Arc{1}{18}
		\Fishka{18}
		\Fishka{2}
		\Fishka{5}
		\Fishka{8}
		\Fishka{16}
		\end{scope}
		
		\begin{scope}[xshift=3cm]
		\ArcO{0}{1}
		\Arc{1}{18}
		\Fishka{1}
		\Fishka{3}
		\Fishka{5}
		\Fishka{8}
		\Fishka{17}
		\end{scope}
		\end{tikzpicture}
	\end{center}
	\caption{Две смежные гиперграни многогранника $\CP(10,18)$.}
	\label{fig:PictNeighborlyFaset}
\end{figure}


Предположим, что вершины некоторой гиперграни заданы набором из $k$ пар.
Тогда переход к смежной гиперграни означает сдвиг одной или нескольких примыкающих
друг к другу пар на одну точку вдоль окружности (см. рис.~\ref{fig:PictNeighborlyFaset}). 
(Из симплициальности циклического многогранника следует, 
что две его гиперграни смежны, если они имеют ровно $d-1$ общих вершин.)
Иными словами, чтобы перейти к любой смежной гиперграни, достаточно выбрать одну
из $k$ пар и направление смещения (по часовой или против часовой стрелки),
при этом, если на пути смещения пары находится другая пара,
то она смещается в том же направлении, что и первая, и~т.~д.
Далее будем пользоваться следующим правилом.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%                      Правило смещения
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\medskip
\textbf{Правило смещения.} 
\emph{
	При смещении пара может одновременно продвигать и нескольких примыкающих соседей,
	лежащих у нее на пути, но не может пересекаться с другой парой.
}
\medskip

Итак, задача вычисления расстояния между вершинами в ридж-графе 
циклического многогранника сводится к следующей.
На окружности с $n$ точками выбраны $k$ пар точек, определяющих вершины 
первой гиперграни, далее называем их \emph{фишками}, 
и отмечены $k$ пар, соответствующих вершинам второй гиперграни, 
далее называем их \emph{ячейками} (см. рис.~\ref{fig:PictFishki}). 
Требуется найти наименьшее число <<правильных>> смещений фишек, 
достаточное для того, чтобы все ячейки были заняты фишками.
Обозначим это число $l(F_1,F_2)$, здесь $F_1$ --- это множество фишек, 
а $F_2$ --- множество ячеек, $F_1,F_2\subset {\mathcal P}$. 


% Рисунок 2
\begin{figure}[tbh]
	\begin{center}
		\begin{tikzpicture}[>={Stealth[scale width=0.8]} % Определяем вид стрелок
		]
		\BeginPic{2}{18}
		
		\begin{scope}
		\ArcO{0}{1}
		\Arc{1}{18}
		\Cell{3}
		\Cell{5}
		\Cell{8}
		\Cell{10}
		\Cell{12}
		
		\Fishka{2}
		\Fishka{5}
		\Fishka{11}
		\Fishka{16}
		\Fishka{18}
		
		\draw[<-] \cvertex{8.5}  +(-0.15,0) -- +(-1,0) node[left] {Ячейка};
		\draw[<-] \cvertex{16.5} + (0.1,0) -- +(1,0) node[right] {Фишка};
		\draw[<-] \cvertex{1.5} + (0.1,0) -- +(1,0) node[right] {Промежуток};
		\end{scope}
		\end{tikzpicture}
	\end{center}
	\caption{Пример гиперграней $F_1=\{1,2,3,5,6,11,12,16,17,18\}$ (фишки)
		и $F_2=\{3,4,5,6,8,9,10,11,12,13\}$ (ячейки) многогранника $\CP(10,18)$.}
	\label{fig:PictFishki}
\end{figure}



Каждой паре из множества ${\mathcal P}\setminus(F_1\cup F_2)$ поставим в соответствие 
дугу окружности между точками $v_i$ и $v_{i+1}$, не содержащую самих этих точек.
Назовем такую дугу \emph{промежутком} (см. рис.~\ref{fig:PictFishki}) и будем обозначать $a_i$. 
А множество всех промежутков обозначим через $A$. 
Так как на окружности расположено $k$ фишек и $k$ ячеек, то $|A| \ge n - 2k > 0$.
Подмножество $W\subseteq A$ назовем \emph{свободной дугой}, если найдутся $i,j\in[n]$
такие, что $W=\{a_i, a_{i+1}, \ldots, a_j\}$,
причем $a_{i-1}$ и $a_{j+1}$ не входят в $A$.
Здесь, как и ранее, при вычислении индексов сложение выполняется по модулю~$n$.
Ясно, что $A$ представимо единственным образом в форме
\begin{equation}
\label{GapSet}
A=W_1 \cup W_2 \cup \ldots \cup W_s, \mbox{ где } 0 < s \le 2k = d,
\end{equation}
$W_i$ --- свободные дуги. 
Определим длину $l(W)$ свободной дуги $W$ как число точек $v_i$ ($1\le i\le n$), 
содержащихся внутри нее:
$$
l(W)=|W|-1.
$$
Тогда суммарная длина свободных дуг равна числу вершин, 
не принадлежащих ни одной из двух выбранных гиперграней, и
$$
\sum^{s}_{i=1} l(W_i)\ge n-2d.
$$

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%                      Лемма
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{lemma}
	\label{lemma:Ridge1}
	Предположим, что из окружности вырезана свободная дуга $W$ 
	вместе с содержащимися внутри нее точками,
	и фишкам из $F_1$ запрещено передвигаться через эту брешь.
	Тогда 
	$$
	l(F_1,F_2)\le n - d - l(W).
	$$
\end{lemma}

\begin{proof}
При каждом правильном смещении от фишек освобождается ровно одна точка, 
и ровно одна точка становится занятой. 
Заметим, что при оптимальном передвижении фишек
однажды освободившаяся точка не может быть занята вновь.
Чтобы убедиться в этом, предположим противное.
Тогда возможны два варианта:
\begin{enumerate}
	\item Фишка, освободившая точку, заняла ее вновь.
	Но тогда неоптимальность перемещений очевидна.
	\item Фишка, занявшая точку, сместилась в том же направлении,
	что и фишка, освободившая эту точку. Но тогда эти два смещения
	(освобождение и занятие данной точки) можно было бы сделать за один шаг.
\end{enumerate}
Таким образом оптимальное число смещений не может превышать числа всех точек не занятых фишками.
\end{proof}

Непосредственно из леммы~\ref{lemma:Ridge1} следует неравенство
$$
l(F_1,F_2)\le n-d - \max_{1\le i\le s} l(W_i).
$$
В частности, с его помощью легко доказать теорему для $d<n\le 2d$. 
Достаточно привести пример двух гиперграней, имеющих $2d-n$ общих вершин. 
Очевидно, что число сближающих смещений для них будет равно $n-d$.

Под фразой <<между свободными дугами $W_i$ и $W_j$>> будем понимать тот участок окружности,
который будет пройден при движении против часовой стрелки от $W_i$ к $W_j$.
Введем вспомогательную функцию $f(i,j)$ равную числу фишек, 
расположенных между $W_i$ и $W_j$, минус число ячеек на этом же участке.
Эта функция обладает следующими свойствами.

\emph{Свойство 1.} 
$f(i,j)=-f(j,i)$.

\emph{Свойство 2.} 
$f(i,j)=f(i,m)+f(m,j)$.

\emph{Свойство 3 (непрерывность). } 
Если $f(i,j)>1$, то между $W_i$ и $W_j$ найдется $W_m$, что $f(i,m)=1$.

Если для некоторых $i$ и $j$ выполнено $f(i,j)=0$, 
то $W_i$ и $W_j$ назовем \emph{смежными}.

\emph{Свойство 4 (транзитивность). }
Если $W_i$ и $W_j$ смежны, и $W_j$ и $W_m$ смежны,
то $W_i$ и $W_m$ тоже смежны. 

Пусть $W_i$ и $W_j$ смежны. 
Тогда, вырезав их из окружности и применив лемму~\ref{lemma:Ridge1}
для каждой из двух образовавшихся дуг, получаем
$$
l(F_1,F_2)\le n-d - l(W_i)-l(W_j).
$$
Аналогично мы можем поступить и с несколькими попарно смежными свободными дугами.


% Рисунок 3
\begin{figure}[tbh]
	\begin{center}
		\begin{tikzpicture}
		\BeginPic{2}{18}
		
		\def\PicThree{
			\Cell{3}
			\Cell{5}
			\Cell{8}
			\Cell{10}
			\Cell{12}
			\Fishka{2}
			\Fishka{5}
			\Fishka{11}
			\Fishka{16}
			\Fishka{18}
		}
		
		\begin{scope}[xshift=-4.6cm]
		\draw node {$S_1$};
		\Arc{1}{1}
		\Arc{2}{4}
		\Arc{5}{6}
		\Arc{8}{18}
		\PicThree	
		\end{scope}
		
		\begin{scope}[xshift=0cm]
		\draw node {$S_2$};
		\Arc{1}{9}
		\Arc{10}{17}
		\Arc{18}{18}
		\PicThree	
		\end{scope}
		
		\begin{scope}[xshift=4.6cm]
		\draw node {$S_3$};
		\Arc{1}{13}
		\Arc{16}{18}
		\PicThree	
		\end{scope}
		\end{tikzpicture}
	\end{center}
	\caption{Три разреза для рис.~\ref{fig:PictFishki}: $l(S_1)=1$, $l(S_2)=0$, $l(S_3)=2$.}
	\label{fig:PictCut}
\end{figure}


Пользуясь этим, разобьем множество всех свободных дуг на подмножества $S_i$ 
%=W_{i_1} \cup W_{i_2} \cup \ldots \cup W_{i_t}$, 
так, чтобы все свободные дуги принадлежащие одному подмножеству были попарно смежны
и, в то же время, любые две свободные дуги из разных подмножеств были бы несмежны.
Подмножества $S_i$ будем называть \emph{разрезами} (см. рис.~\ref{fig:PictCut}). 
%Число $t$ всех разрезов, естественно, меньше числа $s$ всех свободных дуг.
Под длиной $l(S)$ разреза $S$ будем понимать суммарную длину входящих в него свободных дуг. 
Тогда, очевидно,
$$
l(F_1,F_2)\le n-d - \max_{1\le i\le t} l(S_i),
$$
где $t$ --- число всех разрезов.
И, так как 
$$
\sum^{t}_{j=1} l(S_j)=\sum^{s}_{i=1} l(W_i)\ge n-2d,
$$
то
$$
l(F_1,F_2)\le n-d - \frac{n-2d}{t}. 
$$

Остается доказать, что 
\begin{equation}
\label{eq:CutRidge}
t\le k+1,
\end{equation}
где $k=\frac d2$.
Из формулы \eqref{GapSet} известно, что число всех свободных дуг $s\le d$.
Поэтому, чтобы установить справедливость неравенства \eqref{eq:CutRidge}, достаточно показать, 
что среди всех разрезов найдется не более двух, содержащих ровно по одной свободной дуге.

Пусть разрез $S'$ содержит одну единственную свободную дугу $W_{i'}$. 
Это означает, что для любого $j\ne i'$, выполнено
\begin{equation}
\label{NotEq}
f(i',j)\ne 0.
\end{equation}
И тогда, в силу свойства 3 (непрерывность), для любого $m\ne i'$ 
$$
f(i',j) f(i',m) > 0.
$$
То есть функция $g(j)=f(i',j)$ для всех $j$ принимает значения одного знака.

Рассмотрим еще один разрез $S''$, содержащий лишь одну свободную дугу $W_{i''}$, $i''\ne i'$.
Покажем, что для любых $j\ne i'$ и $m\ne i''$ выполнено
$$
f(i',j) f(i'',m) < 0.
$$
Действуя от противного, предположим, что для некоторых $j$ и $m$
$$
f(i',j) f(i'',m) > 0.
$$
(Равенство здесь исключается в силу формулы \eqref{NotEq} 
и аналогичного утверждения для~$i''$). 
Но тогда это неравенство справедливо и при $j=i''$ и $m=i'$,
что невозможно в силу свойства 1. 
Итак, среди всех разрезов найдется не более двух, содержащих ровно по одной свободной дуге,
и неравенство~\eqref{eq:CutRidge}, а вместе с ним и неравенство~\eqref{eq:RidgeIneq}, доказаны. 

На рисунке~\ref{fig:PictDiameter} приводятся примеры гиперграней, 
расстояние между которыми равно наибольшему целому, 
не превосходящему правой части~\eqref{eq:RidgeIneq}. 
В работе~\cite{Klee:1967} тоже можно увидеть 
один пример такого рода для $d=6$ и $n=23$. 
Алгоритм построения таких примеров для произвольных $d$ и $n$ ясен из рисунка.
Таким образом, для случая четной размерности теорема доказана.


% Рисунок 4
\begin{figure}[tbh]
	\begin{center}
		\begin{tikzpicture}
		\BeginPic{2}{18}
		\begin{scope}[xshift=-4.6cm]
		\draw node {$\CP(4,18)$};
		\ArcO{0}{1}
		\Arc{1}{18}
		\Cell{1}
		\Cell{3}
		\Fishka{8}
		\Fishka{13}
		\end{scope}
		
		\BeginPic{2}{19}
		\begin{scope}[xshift=0cm]
		\draw node {$\CP(6,19)$};
		\ArcO{0}{1}
		\Arc{1}{19}
		\Cell{1}
		\Cell{3}
		\Cell{5}
		\Fishka{8}
		\Fishka{12}
		\Fishka{16}
		\end{scope}
		
		\BeginPic{2}{21}
		\begin{scope}[xshift=4.6cm]
		\draw node {$\CP(6,21)$};
		\ArcO{0}{1}
		\Arc{1}{21}
		\Cell{1}
		\Cell{3}
		\Cell{5}
		\Fishka{9}
		\Fishka{13}
		\Fishka{17}
		\end{scope}
		\end{tikzpicture}
	\end{center}
	\caption{Примеры диаметрально противоположных гиперграней.}
	\label{fig:PictDiameter}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%                      Нечетная размерность
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


Разберем теперь случай, когда $d=2k+1$.

Из критерия Гейла следует, что в случае нечетной размерности 
каждая гипергрань должна содержать хотя бы одну из двух точек: $v_1$ или $v_n$. 


Пусть $F_1$ и $F_2$ --- некоторые гиперграни. 
Возможны два варианта.

1-й вариант. 
Для $F_1$ и $F_2$ хотя бы одна из точек $v_1$ и $v_n$ общая.
Тогда эту точку можно выбросить из рассмотрения и, тем самым, 
перейти к случаю четной размерности. 
Следовательно,
$$
l(F_1,F_2)\le (n-1)-(d-1) - \frac{(n-1)-2(d-1)}{k+1}<n-d - \frac{n-2d}{k+1}.
$$

2-й вариант. 
$F_1$ и $F_2$ не имеют общих точек в множестве $\{v_1, v_n\}$.
Не уменьшая общности, предположим, что $F_1$ содержит $v_1$, но не содержит $v_n$,
а $F_2$ содержит $v_n$, но не содержит $v_1$. 
Из критерия Гейла следует, что если мы при очередном смещении освободим $v_1$, 
то обязательно должны занять $v_n$. 
Т. е. свободная дуга, состоящая из промежутка $a_n$, 
не может входить в какой-бы то ни было разрез. 
Кроме того, если двигаться против часовой стрелки, 
то свободная дуга, расположенная правее $v_1$ будет смежна свободной дуге, 
расположенной левее $v_n$. 
Таким образом, наибольшее число разрезов, как и в случае четной размерности, 
будет равно $k+1$. 

Пример наиболее удаленных друг от друга гиперграней 
строится аналогично случаю четной размерности.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% End of section
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
