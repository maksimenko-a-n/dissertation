%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%     Аффинная сводимость
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Циклические многогранники}

\hfill
\begin{minipage}{0.5\textwidth}
Циклические многогранники обладают максимальным числом граней среди всех выпуклых многогранников той же размерности и с таким же числом вершин.
\begin{flushright}
Peter McMullen
\end{flushright}
\end{minipage}

\section{Определение и свойства}

В этом разделе приводится определение циклических многогранников и перечисляются их некоторые свойства.
Более подробную информацию о циклических многогранниках можно найти в~\cite{Grunbaum:2003} и~\cite{ZieglerBook}.

Пусть $T = \{t_1, \dots, t_n\} \subset \R$, $t_1 < t_2 < \dots < t_n$.
Зафиксируем $d \in \N$, $2 \le d < n$, и введем обозначение
\[
\bm{x}(i) \coloneqq (t^{\phantom{1}}_i, t^2_i, \dots, t^d_i) \in \R^d, \qquad i\in[n]. 
\]
Сформулируем определение циклического многогранника (см. с.~\pageref{page:cyclic}) с использованием новых обозначений.
\emph{Циклическим многогранником} называется выпуклая оболочка множества
\[
\CP_d(T) \coloneqq \{\bm{x}(1), \dots, \bm{x}(n)\}.
\]
Причем $\CP_d(T)$ "--- множество вершин этого многогранника.
Число $i\in[n]$ будем называть \emph{номером} вершины $\bm{x}(i)$.

\begin{theorem}[условие четности Гейла~\cite{Gale:1963}]
Многогранник $\CP_d(T)$ симплициален, то есть каждая его гипергрань содержит ровно $d$ вершин. Причем подмножество вершин с номерами из $S \subset [n]$, $|S|=d$, образует гипергрань тогда и только тогда, когда выполнено <<условие четности>>:
\[
\text{мощность множества } [k_1, k_2]\cap S \text{ четна для всех } k_1, k_2 \in [n] \setminus S, \ k_1 < k_2.
\]
\end{theorem}

Для $n=7$ примерами множеств, удовлетворяющих условию четности, могут служить
$\{1,5,6\}$, $\{1,7\}$, $\{2,3,4,5\}$ и $\{1,2,4,5,7\}$.
Таким образом, множество $S \subset [n]$, удовлетворяющее условию четности, однозначно разбивается на пары вида $\{i,i+1\}$ и, быть может, элементы $1$ и $n$.

Доказательство справедливости условия четности Гейла опирается на следующие факты:
\begin{enumerate}
\item Для любого $\bm{a} \in \R^d$ значения линейной функции $g(\bm{x}) = \bm{a}^T \bm{x}$ в точках $\bm{x}(i)$, $i\in[n]$, множества $\CP_d(T)$ совпадают со значениями многочлена $f(t) = a_1 t + a_2 t^2 + \dots + a_d t^d$ в точках $t_i$. То есть уравнение вида $f(t) = b$ задает гиперплоскость $\bm{a}^T \bm{x} = b$.
\item Многочлен вида 
\begin{equation}
\label{eq:CyclicPol}
f(t) = (t - t_1)(t_n - t) \prod_{i \in I} \bigl((t - t_i)(t - t_{i+1})\bigr), \quad I\subset [n],
\end{equation}
принимает нулевые значения в точках $t_1$, $t_n$, $t_i$, $t_{i+1}$, $i\in I$, и положительные значения в остальных точках из $T$.
\end{enumerate}
Таким образом, для каждого множества, удовлетворяющего условию четности, можно построить многочлен вида~\eqref{eq:CyclicPol}, определяющий гиперплоскость $f(t) = 0$, опорную для $\CP_d(T)$.


\section{Компактная расширенная формулировка}

Пусть, как и прежде, $T = \{t_1, \dots, t_n\} \subset \R$, $t_1 < t_2 < \dots < t_n$, $d \in \N$, $2 \le d < n$.
В этом разделе мы ограничиваемся рассмотрением только тех случаев, когда $t_{i+1} = t_i + 1$ для всех $i\in[n-1]$, и будем пользоваться более подходящим обозначением
\[
\CP_{d,n}(t_1) \coloneqq \CP_d(T).
\]


\subsection{Случай $d=2$}

Заметим, что многогранники $\CP_{d,n}(t)$ и $\CP_{d,n}(s)$ аффинно изоморфны для любых $t,s \in \R$. 
А именно, из бинома $(t + (s-t))^i = \sum_{j=0}^i \binom{i}{j} (s-t)^{i-j} t^j$ получаем следующее аффинное отображение, определяющее изоморфизм между $\CP_{d,n}(t)$ и $\CP_{d,n}(s)$:
\begin{equation}\label{eq:affine_isomorphism} 
y_i:=(s-t)^i+\sum_{j=1}^i \binom{i}{j} (s-t)^{i-j} x_j, 
\end{equation}
где $(x_1,\ldots,x_d) \in \CP_{d,n}(t)$, $(y_1,\ldots,y_d) \in \CP_{d,n}(s)$.

Согласно только что сделанному замечанию, мы будем пользоваться кратким обозначением $\CP_{d,n}$ в тех случаях, когда выбор начального значения не влияет на результат рассуждений.


\begin{lemma}\label{lem:two_dim}
$\xc(\CP_{2,n}(t)) \le 2\lfloor \log_2(n-1)\rfloor+2$, где $n \ge 3$ и $t \in \R$.
\end{lemma}

\begin{proof}
Согласно~\eqref{eq:affine_isomorphism}, многогранник~$\CP_{2,n}(t)$ можно аффинно преобразовать в многогранник
\[
\CP_{2,n}(-(n-1)/2).
\] 
	
В свою очередь, для каждого $k\in\N$ многогранник~$\CP_{2,2k+1}(-k)$ может быть представлен как выпуклая оболочка двух многогранников $\CP_{2,k+1}(-k)$ и~$\CP_{2,k+1}(0)$:
%
\[
\CP_{2,2k+1}(-k) = \conv(\CP_{2,k+1}(-k) \cup \CP_{2,k+1}(0)).
\]
Аналогичное представление существует и для многогранника $\CP_{2,2k}(-k + 1/2)$:
\[
\CP_{2,2k}(-k + 1/2) = \conv(\CP_{2,k}(-k + 1/2) \cup \CP_{2,k}(1/2)), \quad k\in\N.
\]
	
Воспользуемся тем, что многогранник $\CP_{2,k+1}(-k)$ является образом многогранника $\CP_{2,k+1}(0)$ при зеркальном отражении относительно гиперплоскости $x_1 = 0$ (отображение определяется сменой знака первой координаты). То же верно и в отношении $\CP_{2,k}(-k + 1/2)$ и $\CP_{2,k}(1/2)$.

Этот факт позволяет на основе свойства зеркальной симметрии (см. Theorem~2 в~\cite{KaibelPashkovich:2013}) и~\eqref{eq:affine_isomorphism} сделать вывод о том, что каждая расширенная формулировка размера $h$ для многогранника $\CP_{2, \lceil n/2 \rceil}$ определяет расширенную формулировку размера $(h+2)$ для $\CP_{2,n}$. В частности, расширенная формулировка для $\CP_{2,2k+1}(-k)$ может быть такой:
\[
\CP_{2,2k+1}(-k)=\Set*{(x_1,x_2)\in\R^2 \given \text{найдется } z_1, \text{ что }(z_1,x_2)\in \CP_{2,k+1}(0) \text{ и } -z_1 \le x_1\le z_1}\,.
\]
Таким образом, $\xc(\CP_{2k+1}) \le \xc(\CP_{k+1}) + 2$ и $\xc(\CP_{2k}) \le \xc(\CP_{k}) + 2$.
	
Неравенство $\xc(\CP_{2,n}) \le 2 \lfloor \log_2(n-1) \rfloor + 2$ легко проверяется для $n = 3,4,5$. 
Следовательно, для завершения доказательства достаточно воспользоваться неравенствами
\[
\xc(\CP_{2,2k}) \le \xc(\CP_{2,k}) + 2 \le  2 \lfloor \log_2(k-1) \rfloor + 4 =2 \lfloor \log_2 (2k-2) \rfloor + 2
\]
и
\[\xc(\CP_{2,2k-1}) \le \xc(\CP_{2,k}) + 2 \le 2 \lfloor \log_2(k-1) \rfloor + 4 = 2 \lfloor \log_2 \big((2k-1) - 1\big) \rfloor + 2\,.
\]
Таким образом,
\[
\xc(\CP_{2,n}) \le  2\lfloor \log_2(n-1)\rfloor+2
\]
для всех $n\ge 3$.
\end{proof}

\begin{remark}
Более аккуратный разбор финальной части доказательства леммы~\ref{lem:two_dim}
позволяет улучшить верхнюю оценку сложности расширения до 
\[
\xc(\CP_{2,n}) \le 2\lfloor \log_2(n-1)\rfloor + 1 + \delta_n,
\]
где $\delta_n = 0$, если $2^k < n \le 3 \cdot 2^{k-1}$ для некоторого $k\in \N$, и $\delta_n = 1$ в остальных случаях.
\end{remark}



\subsection{Случай $d \ge 3$}

К сожалению, при $d \ge 3$ взаимосвязь между многогранниками $\CP_{d,k+1}(-k)$ и~$\CP_{d,k+1}(0)$ не так проста: многогранник $\CP_{d,k+1}(-k)$ является образом~$\CP_{d,k+1}(0)$ при смене знака координат с нечетным индексом. Это не соответствует симметрии относительно гиперплоскости и, следовательно, мы не можем воспользоваться свойствами зеркальной симметрии. 

Однако, мы можем воспользоваться теоремой Яннакакиса (теорема~\ref{thm:Yannakakis} на с.~\pageref{thm:Yannakakis})
и низкоранговой неотрицательной факторизацией матрицы невязок многогранника~$P_{2,n}$, гарантируемой Леммой~\ref{lem:two_dim}. 

Строки матрицы невязок $M_{d,n}$ (см. определение~\ref{def:slack} на с.~\pageref{def:slack}) многогранника $\CP_{d,n}(t)$ будем индексировать элементами из $[n]$, а столбцы "--- множествами $S \subset [n]$, $|S|=d$, удовлетворяющими условию четности Гейла.
Согласно приведенным выше рассуждениям (см. формулу~\eqref{eq:CyclicPol} и комментарии к ней), эта матрица может быть представлена как
%
\begin{equation}
\label{eq:slack}
M_{d,n}(i,S) := \prod_{j \in S} |t_j - t_i|\,,
\end{equation}
%
где $i\in[n]$ и $S\subseteq [n]$, $|S|=d$, удовлетворяет условию четности Гейла.
В частности, матрица невязок не зависит от начального параметра $t$ в определении многогранника $\CP_{d,n}(t)$, так как он не меняет разности $t_j - t_i$. 

Прежде всего рассмотрим четную размерность, положив~$d = 2q$, $q\in \N$.

Для двух матриц $A$ и $B$ одинакового размера, определим поэлементное произведение $A \circ B$ с помощью уравнения $(A \circ B)(i,j):=A(i,j) B(i,j)$. Нам понадобится следующий фольклорный факт. 

\begin{lemma}
\label{lem:Kronecker}
Для любых двух матриц $A$ и $B$ с одинаковым числом строк и столбцов,
\[
\rank_+(A \circ B) \le \rank_+(A) \rank_+(B).
\]
\end{lemma}
%
\begin{proof}
Пусть $A,B \in \R_+^{n\times m}$ и
\begin{align*}
A &= TU, && \text{где }T\in \R_+^{n\times r}, \quad U\in \R_+^{r\times m},\\
B &= HW, && \text{где }H\in \R_+^{n\times s}, \quad W\in \R_+^{s\times m}.
\end{align*}
Через $M_i$ будем обозначать $i$-ю строку матрицы $M$, а через $M^j$ "--- $j$-ый столбец.
Строки $C_i$, $i\in[n]$, матрицы $C \in \R_+^{n \times rs}$ определим тензорным произведением
\[
C_i = T_i\otimes H_i,
\]
а столбцы $D^j$, $j\in[m]$, матрицы $D \in \R_+^{rs \times m}$ "--- произведением
\[
D^j = U^j\otimes W^j.
\]
Тогда
\[
A\circ B = CD.
\]
\end{proof}

\begin{lemma}
\label{lem:even_case}
$\xc(\CP_{2q, n}) \le \big(\xc(\CP_{2, n})\big)^q$ при $q,n\in\N$, $n > 2q$.
\end{lemma}










%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  Алгоритм факторизации матрицы невязок для d=2
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\subsection{Алгоритм явной факторизации матрицы невязок для $d=2$}

Ниже будет представлена явная неотрицательная факторизация матрицы невязок $M^2_{t_1,t_2}$ размера $2\lceil\log(t_2-t_1)\rceil+1$. Эта факторизация похожа ту, что описана в~\cite{Fiorini:2012polygons} для матрицы невязок правильного многоугольника.

Положим $q:=\lceil\log(t_2-t_1)\rceil$. Дополнительно, определим $q$ чисел $a_1$, \dots, $a_q$ с помощью следующей рекурсивной процедуры (начинаем с $j:=1$ и $k:=t_2-t_1$):
\begin{itemize}
	\item[-] определяем $a_j:=\frac{k}{2}$
	\item[-] обновляем $k:=\lfloor(k+1)/2\rfloor$ и $j:=j+1$ 
	(процедура завершается при $j>q$)
\end{itemize}

Определим неотрицательный вектор $\alpha_i\in\R^{2 \lceil\log(t_2-t_1)\rceil}_{+}$ для каждого числа $i\in [t_1,t_2]\cap\Z$ с помощью следующей процедуры (начинаем с $j:=1$ и $x:=i$):
\begin{itemize}
	\item[-] обновляем $r:=x-a_j$
	\item[-] если $r\ge 0$, то $x:=x-2r$ 
	\item[-] если $r\ge 0$, то $\alpha_i(j):=2r$ и $\alpha_i(j+1):=0$ 
	\item[-] если $r<0$, то $\alpha_i(j):=0$ и $\alpha_i(j+1):=-2r$
	\item[-] обновляем $j:=j+2$ (процедура завершается при $j>2q$).
\end{itemize}
Аналогично, для каждого $S:=\{t,t+1\}$, $t\in [t_1,t_2-1]\cap\Z$, определяем неотрицательный вектор $\beta_t\in\R^{2 \lceil\log(t_2-t_1)\rceil}_{+}$ с помощью следующей процедуры (начинаем с $j:=1$ и $y:=t+1$)
\begin{itemize}
	\item[-] обновляем $s:=y-a_j-1/2$
	\item[-] если $s\ge 0$, то $y:=y-2s$ 
	\item[-] если $s\ge 0$, то $\beta_t(j):=0$ и $\beta_t(j+1):=2s$ 
	\item[-] если $s<0$, то $\beta_t(j):=-2s$ и $\beta_t(j+1):=0$
	\item[-] обновляем $j:=j+2$ (процедура завершается при $j>2q$).
\end{itemize}

Нетрудно проверить, что построенные таким образом вектора задают неотрицательную факторизацию матрицы $M^2_{t_1,t_2}$ с одним удаленным столбцом (соответствующим множеству $S=\{t_1,t_2\}$). 
То есть, для каждого $t\in [t_1,t_2-1]\cap\Z$ и $i\in [t_1,t_2]\cap\Z$,
\begin{equation*}
(i-t)(i-t-1)=\langle\alpha_i, \beta_j\rangle\,.
\end{equation*}
Дополнение этой факторизации до факторизации всей матрицы $M^2_{t_1,t_2}$ не составляет труда. 


В качестве примера представим явную неотрицательную факторизацию матрицы $M^2_{1,8}$, соответствующую расширенной формулировке из Леммы~\ref{lem:two_dim} и используемую в доказательстве Леммы~\ref{lem:even_case}.

Пусть $n = 8$ и $t_2 - t_1  = n - 1$, тогда
\begin{equation*}
\begin{split}
M^2_{t_1, t_2} & = M^2_{1, 8} = 
\begin{pmatrix}
0	&  2	&  6	& 12	& 20	& 30	& 42	&  0 \\
0	&  0	&  2	&  6	& 12	& 20	& 30	&  6 \\
2	&  0	&  0	&  2	&  6	& 12	& 20	& 10 \\
6	&  2	&  0	&  0	&  2	&  6	& 12	& 12 \\
12	&  6	&  2	&  0	&  0	&  2	&  6	& 12 \\
20	& 12	&  6	&  2	&  0	&  0	&  2	& 10 \\
30	& 20	& 12	&  6	&  2	&  0	&  0	&  6 \\
42	& 30	& 20	& 12	&  6	&  2	&  0	&  0
\end{pmatrix}               \,.
\end{split}
\end{equation*}

Неотрицательная факторизация матрицы $M^2_{1, 8}$, вытекающая из доказательства Леммы~\ref{lem:two_dim}, получается такой:
\begin{equation*}
M^2_{1, 8} = 
\begin{pmatrix}
0	& 7	& 0	& 4	& 0	& 2	& 0 \\
0	& 5	& 0	& 2	& 0	& 0	& 6 \\
0	& 3	& 0	& 0	& 2	& 0	& 10 \\
0	& 1	& 2	& 0	& 0	& 0	& 12 \\
1	& 0	& 2	& 0	& 0	& 0	& 12 \\
3	& 0	& 0	& 0	& 2	& 0	& 10 \\
5	& 0	& 0	& 2	& 0	& 0	& 6 \\
7	& 0	& 0	& 4	& 0	& 2	& 0
\end{pmatrix}               
\cdot
\begin{pmatrix}
6	& 4	& 2	& 0	& 0	& 0	& 0	& 0 \\
0	& 0	& 0	& 0	& 2	& 4	& 6	& 0 \\
3	& 1	& 0	& 0	& 0	& 1	& 3	& 0 \\
0	& 0	& 1	& 3	& 1	& 0	& 0	& 0 \\
1	& 0	& 0	& 1	& 0	& 0	& 1	& 0 \\
0	& 1	& 1	& 0	& 1	& 1	& 0	& 0 \\
0	& 0	& 0	& 0	& 0	& 0 & 0	& 1
\end{pmatrix}    \,.
\end{equation*}         


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% End of section
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
