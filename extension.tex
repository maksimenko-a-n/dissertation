%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%     Расширенная аффинная сводимость
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Расширенная аффинная сводимость}
\begin{flushright}
	А если немного ослабить условия?
\end{flushright}

\section{Определения и примеры}

В этой главе рассматриваются следствия смягчения способа сравнения многогранников (см. определение \ref{def:ineA}), используемого в предыдущей главе.
А именно, слова <<аффинно эквивалентен>> в определении~\ref{def:ineA} будут заменены на <<является аффинным образом>>. 

\begin{definition}\label{def:ineE}
	В случае, когда многогранник $P$ является аффинным образом многогранника~$Q$ или же его грани, будем использовать обозначение $P \lee Q$.
\end{definition}

%Заметим, прежде всего, что из $P \lea Q$ следует $P \lee Q$.

Замена $\lea$ на $\lee$ значительно расширяет возможности сравнения многогранников. Кроме того, во многих случаях доказательство соотношений вида $P \lee Q$ принципиально проще, чем соотношений $P \lea Q$.
Минусом такого ослабления ограничений является потеря некоторых полезных свойств.
В частности, пользуясь соотношением $P \lee Q$, вообще говоря, нельзя сравнивать числа фасет соответствующих многогранников и кликовые числа их графов.

Рассмотрим несколько простых примеров.

Ранее (см. с.~\pageref{ProjOfSimplex}) уже упоминался тот факт, что 
любой многогранник, имеющий $n$ вершин, является аффинным образом симплекса $\Delta_{n-1}$. Иными словами,
\[
P \lee \Delta_{n-1}, \quad \text{если }  |\ext(P)| \le n.
\]

%По аналогии с $d$-мерным 0/1-многогранником введем понятие $d$-мерного
%\emph{$[k]$-многогранника}, множество вершин которого принадлежит $[k]^d$.

Пусть $a,b \in Z$, $a < b$, и $[a,b]$~--- множество целых чисел соответствующего отрезка. Пусть функция $\zeta \from [a,b] \to \{0,1\}^k$, где $k = \lceil\log_2 (b-a+1)\rceil$, каждому целому $x \in [a,b]$ ставит в соответствие двоичную запись числа $x-a$. Очевидно, эта функция полиномиально вычислима. С другой стороны, обратное преобразование $\zeta^{-1} \from \bm{y} \mapto a + y_1 + 2 y_2 + \dots + 2^{k-1} y_k$ аффинно и тоже полиномиально вычислимо.
Как следствие, получаем следующее

\begin{prop}\label{prop:01}
Пусть $X \in S^n$, где $S$~--- множество целых чисел некоторого отрезка $[a,b]$.
Тогда существует $Y \in \{0,1\}^d$, $d = n \cdot \lceil\log_2 (b-a+1)\rceil$, что
\[
X \lee Y.
\]
\end{prop}

По аналогии с аффинной сводимостью (определение \ref{def:Aff}) введем понятие расширенной аффинной сводимости на основе отношения $\lee$.
Предварительно напомним, что под размером многогранника подразумевается сумма длины его кода и размерности пространства.


\begin{definition}
	\label{def:Aff2}
	Будем говорить, что семейство многогранников $P$ \emph{расширенно аффинно сводится} к семейству многогранников $Q$, если для каждого многогранника $p\in P$ найдется многогранник $q\in Q$, система линейных уравнений $D\bm{y}=\bm{c}$, задающая грань
	\[
	F = \Set{\bm{y}\in q \given D\bm{y}=\bm{c}},
	\]
	и аффинное отображение $\beta$, задаваемое системой 
	\[
	\bm{x} = B\bm{y} + \bm{a}, \qquad \bm{x} \in p, \quad \bm{y} \in F, 
	\]
	такие, что:
	\begin{enumerate}
		\item $p = \alpha(F)$.
		\item Размерность пространства, в котором определен многогранник $q$, ограничена сверху полиномом от размерности пространства для $p$.
		\item Длина кода многогранника $q$ ограничена сверху полиномом от размера многогранника $p$.
		\item Коэффициенты %аффинного отображения $\alpha$
		матриц $D$, $B$ и векторов $\bm{c}$, $\bm{a}$ 
		вычисляются за полиномиальное время относительно размера многогранника $p$.
	\end{enumerate}
	Обозначение: $P \propto_E Q$.  
\end{definition}

%\begin{remark}\end{remark}

\begin{lemma}
	Если $P \propto_A Q$, то $P \propto_E Q$.
\end{lemma}
	
\begin{proof}
	В определении~\ref{def:Aff} требуется наличие биективного аффинного отображения $\alpha \from p \to F$,
	а в определении~\ref{def:Aff2}~--- наличие отображения $\beta \from F \to p$ и системы линейных уравнений, определяющих грань $F$.
	Если отображение биективно, то переход от одного способа описания к другому можно осуществить за полиномиальное время (см., например, \cite{Winkler:1996}).
\end{proof}

Перечислим некоторые очевидные свойства этого типа сводимости. 

\begin{theorem}
	\label{thm:PropE}
	Пусть $P \propto_E Q$. Тогда задача линейной оптимизации на многогранниках семейства $P$ полиномиально сводится к задаче линейной оптимизации на многогранниках семейства $Q$.
	
	Предположим, что в семействе $P$ есть многогранники, имеющие одно или несколько из следующих свойств:
	\begin{enumerate}
		\item Cверхполиномиальность числа вершин (относительно размера многогранника).
		\item Cверхполиномиальное число прямоугольного покрытия.
		\item Cверхполиномиальная сложность расширения.
	\end{enumerate}
	\noindent
	Тогда в $Q$ имеются многогранники с теми же свойствами.
\end{theorem}

По аналогии с утверждением \ref{prop:01} легко доказать следующую теорему.

\begin{theorem}(об универсальности 0/1-многогранников)
	Пусть функции $d = d(I) \in \Z$, $a = a(I) \in \Z$, $b = b(I) \in \Z$ и предикат $g = g(\bm{x}, I)$, $\bm{x} \in [a,b]^d$, полиномиально вычислимы относительно кода $I$ многогранника 
	\[
		p(I) = \Set{\bm{x} \in [a,b]^d \given g(\bm{x}, I)}.
	\]
	Внимание! a и b могут быть экспонентами.
\end{theorem}

Определение.
Пусть функция $d = d(n)$ полиномиальна, а последовательность конечных множеств $X_n \in \Z^d$ такова, что для любых $n \in \N$ и $x \in \Z^d$
задача проверки принадлежности $x \in X_n$ принадлежит классу NP.
Тогда семейство (последовательность) многогранников $P(n) = \conv(X_n)$
называется \emph{комбинаторным}.

Примечание.
В~\cite{Naddef:1981, MatsuiTamura:1995} комбинаторными называются многогранники, у которых для каждой пары несмежных вершин середина соединяющего их отрезка является также серединой отрезка, соединяющего (некоторую) другую пару вершин этого многогранника.

Лемма.
Пусть семейство многогранников $P(n) \in \Z^d$, $d = d(n)$,  комбинаторно.
Тогда существует комбинаторное семейство многогранников $Q(n) \in \{0,1\}^k$, $k = k(n)$, что
$Q(n)$ является расширением $P(n)$.

Теорема.
Пусть многогранник $P \subseteq \R^d$ является образом многогранника $Q \subseteq \R^n$ при ортогональном проецировании $\pi \from \R^n \to \R^d$, $n > d$.
Пусть, кроме того, $\pi(\ext Q) = \ext P$.
Тогда граф многогранника $P$ является подграфом графа многогранника $Q$.

Доказательство.
Для каждой вершины $\bm{v} \in \ext P$ определим множество
\[
W(\bm{v}) = \Set*{\bm{x} \in \ext Q \given \pi(\bm{x}) = \bm{v}}.
\]
Очевидно, $\conv (W(\bm{v}))$ является гранью многогранника $Q$.

Для удобства полагаем, что $\R^d$ вложено в $\R^n$,
а проецирование $\pi$ преобразует $(x_1, \dots, x_n)$ в $(x_1, \dots, x_d, 0, \dots, 0)$.
Вспомогательный вектор $\bm{c} \in \R^n$ определим следующим образом.
Если $n = d+1$, то $\bm{c} = \bm{e_n}$,
иначе $\bm{c} = \lambda_{d+1} \bm{e_{d+1}} + \dots + \lambda_{n} \bm{e_n}$
и коэффициенты $\lambda_{d+1}$, \dots, $\lambda_{n}$ подобраны так, 
что для любого $\bm{v} \in \ext P$ и любых двух вершин $\bm{w_1}, \bm{w_2} \in W(\bm{v})$ из неравенства $\bm{w_1} \ne \bm{w_2}$ следует $\bm{c}^T \bm{w_1} \ne \bm{c}^T \bm{w_2}$.
Ясно, что в силу конечности множества вершин многогранника $Q$ такой вектор $\bm{c}$ существует. 
С помощью этого вектора в каждом множестве $W(\bm{v})$ выделим уникальную вершину
\[
\bm{w_v} = \argmax_{\bm{w} \in W(\bm{v})} \Set{\bm{c}^T \bm{w}}.
\]

Остается показать, что если вершины $\bm{v_1}$ и $\bm{v_2}$ многогранника $P$ смежны, то соответствующие вершины 
$\bm{w_1} = \bm{w_{v_1}}$ и $\bm{w_2} = \bm{w_{v_2}}$ тоже смежны.

Предположим, что вершины $\bm{v_1}$ и $\bm{v_2}$ многогранника $P$ смежны.
Тогда многогранники $F_1 = \conv (W(\bm{v_1}))$ и $F_2 = \conv (W(\bm{v_2}))$, а также их выпуклая оболочка $F = \conv(F_1 \cup F_2)$ являются гранями многогранника $Q$.
Причем $\aff(F_1)$ и $\aff(F_2)$ ортогональны вектору $\bm{b} = \bm{v_2} - \bm{v_1}$.
(Соответственно, линейная функция $\bm{b}^T \bm{x}$ принимает разные значения для $\bm{w_1}$ и $\bm{w_2}$.)
Подберем числа $\beta, \gamma \in \R$, $\gamma > 0$, так,
чтобы линейная функция $f(\bm{x}) = \beta \bm{b}^T \bm{x} + \gamma \bm{c}^T \bm{x}$ принимала одинаковые значения для $\bm{w_1}$ и $\bm{w_2}$.
Нетрудно проверить, что тогда 
\[
f(\bm{w_1}) = f(\bm{w_2}) > f(\bm{w}) \quad
\text{для всех }
\bm{w} \in W(\bm{v_1}) \cup W(\bm{v_2}) \setminus \{\bm{w_1}, \bm{w_2}\}.
\]
Следовательно, $\bm{w_1}$ и $\bm{w_2}$ смежны.
Доказано.

Следствие.
Пусть многогранник $P \subseteq \R^d$ является образом многогранника $Q \subseteq \R^n$ при аффинном отображении $\pi \from \R^n \to \R^d$.
Пусть, кроме того, $\pi(\ext Q) = \ext P$.
Тогда $\omega(P) \le \omega(Q)$.
