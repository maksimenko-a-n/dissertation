%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%     Аффинная сводимость
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Аффинная сводимость}
\begin{flushright}
Всё познается в сравнении
\end{flushright}


\section{Определения и примеры}

\subsection{Сравнение многогранников}

Как известно, сравнение является одним из наиболее распространенных и универсальных методов исследования.
Чтобы воспользоваться им, введем следующую операцию сравнения,
задающую частичный порядок на множестве всех выпуклых многогранников.

\begin{definition}
В случае, когда многогранник $P$ аффинно эквивалентен многограннику~$Q$ или же его грани, будем использовать обозначение $P \lea Q$.
Факт аффинной эквивалентности многогранников $P$ и $Q$ обозначаем $P =_A Q$.
\end{definition}

В следующей главе будет рассмотрен более мягкий вариант этого определения,
в котором слова <<аффинно эквивалентен>> заменены на <<является аффинным образом>>, а для соответствующего соотношения используется обозначение $\lee$. Там же будет проведен анализ различий в использовании этих двух соотношений при исследовании свойств многогранников.

Нетрудно заметить, что соотношение $\lea$ оказывается особенно полезным
при сравнении комбинаторных свойств (т.\,е. свойств решеток граней) многогранников.

\begin{property}
Если $P \lea Q$, то решетка граней многогранника $P$ 
изоморфна либо всей решетке граней многогранника $Q$ (если $P$ и $Q$ эквивалентны), либо некоторой подрешетке (индуцированной гранью многогранника $Q$), а матрица инциденций гиперграней"=вершин многогранника $P$ является подматрицей матрицы инциденций многогранника $Q$. В частности:
\begin{enumerate}
	\item Число вершин многогранника $P$ не превосходит числа вершин $Q$.
	\item Число $i$-граней многогранника $P$ не превосходит числа $i$-граней $Q$ при $i \le \dim(P)$.
	\item Граф многогранника $P$ оказывается изоморфен некоторому подграфу графа многогранника $Q$.
	\item Число гиперграней $P$ не превосходит числа гиперграней $Q$.
	\item $\rc(P) \le \rc(Q)$.
\end{enumerate}
\end{property}

В качестве примеров перечислим некоторые очевидные соотношения
для симплексов и циклических многогранников.
Прежде всего, симплекс $\Delta_n$ является гранью симплекса $\Delta_{n+1}$, 
а в силу транзитивности соотношения $\lea$ 
получаем 
\begin{equation}
\label{eq:compareDelta}
\Delta_n \lea \Delta_{n+k} \quad \forall n,k \in \N.
\end{equation}
Кроме того, 
\begin{equation}
\label{eq:compareDeltaCP}
\Delta_m \lea \CP_n(S) \quad \text{при } m < n \le |S|, 
\end{equation}
так как циклический многогранник $\CP_n(S)$ симплициален.
По той же причине 
\begin{equation}
\label{eq:compareCP}
\CP_n(S) \nelea \CP_{n+k}(S')
\end{equation}
для всех $n, k \in \N$
и любых множеств $S$ и $S'$, при условии $|S| > n+1 > 2$.

Заметим, что множество симплексов $\Delta = \{\Delta_n\}$ и множество циклических многогранников $\CP = \Set*{\CP_n(S) \given n\in\N, \ S \subset \Q, \ |S| < \infty}$ представляют собой примеры семейств многогранников задач комбинаторной оптимизации.
В связи с этим интерес представляет следующий вопрос.
Какая из двух ситуаций \eqref{eq:compareDelta} или~\eqref{eq:compareCP} является наиболее типичной для известных семейств многогранников задач?
Опыт показывает, что в большинстве случаев легко проверяется справедливость соотношений вида~\eqref{eq:compareDelta}.
При доказательстве такого рода соотношений удобно пользоваться следующим очевидным утверждением.

\begin{lemma}
	\label{lem:01face}
	Пусть $P \in \R^d$ "--- 0/1"~многогранник. Тогда $F_i = \Set*{\bm{x}\in P \given x_i = 0}$ и $G_i = \Set*{\bm{x}\in P \given x_i = 1}$, $i\in[d]$,
	являются гранями (быть может несобственными) многогранника $P$.
\end{lemma}

Рассмотрим три наиболее часто встречающихся в литературе семейства многогранников: булевы квадратичные многогранники $\BQP(n)$, многогранники асимметричной задачи коммивояжера $\ATSP(n)$ и многогранники задачи о рюкзаке $\Knap(n, \bm{a}, b)$.


\begin{prop}
\begin{align*}
\BQP(n) &\lea \BQP(n+1),\\
\ATSP(n) &\lea \ATSP(n+1),\\
\Knap(n, \bm{a}, b) &\lea \Knap(n+1, (\bm{a},0), b), \quad (\bm{a},0) \in \R^{n+1}, \ b\in \R.
\end{align*}
\end{prop}
\begin{proof}
Воспользуемся леммой~\ref{lem:01face}.
Рассмотрим грань $F$ многогранника $\BQP(n+1)$, образованную гиперплоскостью $x_{n+1, n+1} = 0$. 
Тогда для всех $\bm{x} \in F$ выполняется $x_{i, n+1} = 0$ при $i\in[n+1]$.
Нетрудно увидеть, что множество вершин грани $F$ преобразуется в множество вершин многогранника $\BQP(n)$ (и, наоборот, $\BQP(n)$ в $F$) аффинным отображением (ортогональной проекцией) $x_{ij} \mapsto y_{ij}$, $1 \le i \le j \le n$. 

Для доказательства соотношения $\ATSP(n) \lea \ATSP(n+1)$ 
достаточно установить взаимно однозначное соответствие между множеством гамильтоновых контуров полного орграфа $D=(V,A)$ на $n$ вершинах и подмножеством 
гамильтоновых контуров орграфа $D'=(V',A')$ на $n+1$ вершинах, в котором удалены все дуги, входящие в вершину $v'_1$, и дуги, выходящие из $v'_{n+1}$, за исключением дуги $(v'_{n+1}, v'_1)$.
Заметим, что характеристические вектора указанного подмножества контуров оргафа $D'=(V',A')$ являются вершинами грани 
\[F = \Set*{\bm{x} \in \ATSP(n+1) \given x_{(v'_{n+1}, v'_1)} = 1}
\]
многогранника $\ATSP(n+1)$.
Очевидно, грань $F$ и многогранник $\ATSP(n)$ связаны невырожденным аффинным отображением
\[
	y_{(v_i, v_j)} = 
	\begin{cases}
	x_{(v'_i, v'_j)}, & \text{при }1 \le i \le n, \ 2 \le j \le n, \ i \ne j,\\
	x_{(v'_i, v'_{n+1})}, & \text{при }2 \le i \le n, \ j=1,\\
	\end{cases}
\]
где $\bm{x} \in F$, $\bm{y} \in \ATSP(n)$.

Для доказательства соотношения $\Knap(n, \bm{a}, b) \lea \Knap(n+1, (\bm{a},0), b)$ достаточно заметить, что 
\[
\Knap(n+1, (\bm{a},0), b) = \Set*{(\bm{x},x_{n+1}) \in \{0,1\}^{n+1} \given \bm{x} \in \Knap(n, \bm{a}, b)}.
\]
Следовательно, многогранник $\Knap(n, \bm{a}, b)$ аффинно эквивалентен грани многогранника $\Knap(n+1, (\bm{a},0), b)$, образованной гиперплоскостью $x_{n+1} = 0$ (или $x_{n+1} = 1$).
\end{proof}

Соотношение \eqref{eq:compareDeltaCP} является простым примером того, 
что сравнивать можно и многогранники из разных семейств.
Еще одним таким фактом, открытым независимо несколькими авторами~\cite{Deza:2001}, является \emph{ковариантное отображение} $\xi\from \BQP(n) \to \Cut(n+1)$, задаваемое уравнениями
\[
y_{ij} = 
\begin{cases}
x_{ii}, & \text{при } 1 \le i \le n, \ j=n+1,\\
x_{ii} + x_{jj} - 2 x_{ij}, & \text{при } 1 \le i < j \le n.\\
\end{cases}
\]
%где $\bm{x} \in \BQP(n)$, $\bm{y} \in \Cut(n+1)$.
Из невырожденности этого отображения следует
\[
\BQP(n) =_A \Cut(n+1).
\]

Рассмотрим еще два семейства многогранников, ассоциированных с задачами об упаковке и разбиении множества.

Пусть $A\in\{0,1\}^{m\times n}$ "--- матрица инциденций элементов множества $G = \{g_1, \ldots, g_m\}$ и элементов некоторого множества $S = \{S_1, \ldots, S_n\} \subseteq 2^G$.
Выпуклая оболочка множества
\[
\Pack(A) = \Set*{\bm{x}\in\{0,1\}^n \given A \bm{x} \le \bm{1}}
%\quad \text{где } A\in\{0,1\}^{m\times n},
\]
называется \emph{многогранником упаковок множества}~\cite{Balas:1976}.
(Каждая вершина $\bm{x} \in \Pack(A)$ этого многогранника является характеристическим вектором некоторой упаковки $T \subseteq S$.)

Множество вершин \emph{многогранника разбиений множества} определяется по аналогии:
\begin{equation}
\label{eq:Part}
\Part(A) = \Set*{\bm{x}\in\{0,1\}^n \given A \bm{x} = \bm{1}}.
\end{equation}
Непосредственно из определения следует
\begin{equation}
\label{eq:PartPack}
\Part(A) \lea \Pack(A).
\end{equation}

Заметим также, что многогранник независимых множеств $\Stable(G)$ является частным случаем многогранника упаковок множеств:
\begin{equation}
\label{eq:StablePack}
\Stable(G) =_A \Pack(A),
\end{equation}
если $A$ является матрицей инциденций вершин"=ребер графа $G$.

\subsection{Сравнение семейств многогранников}

Прежде, чем перейти к сравнению семейств многогранников, установим еще несколько простых соотношений между $\Stable(G)$, $\Part(A)$, $\Pack(A)$ и $\BQP(n)$.

\begin{lemma}
	\label{lem:PackStable}
	Для любой матрицы $A\in\{0,1\}^{m\times n}$ существует граф $G$ на $n$ вершинах такой, что $\Pack(A) =_A \Stable(G)$.
\end{lemma}

\begin{proof}
	Достаточно заметить, что каждое неравенство вида
	$$
	x_1 + x_2 + \ldots + x_k \le 1
	$$
	из системы $A\bm{x} \le \bm{1}$ при условии $\bm{x}\in \{0,1\}^n$
	эквивалентно набору неравенств
	$$
	x_i + x_j \le 1, \quad 1\le i < j \le k,
	$$
	определяющих множество вершин некоторого многогранника независимых множеств.
\end{proof}

Учитывая соотношение~\eqref{eq:StablePack}, можно сделать вывод о том, что семейства $\{\Pack(A)\}$ и $\{\Stable(G)\}$ идентичны (состоят из одних и тех же многогранников).

\begin{lemma}
	\label{lem:StablePart}
	Для любого графа $G=(V,E)$ существует матрица $A\in\{0,1\}^{m\times n}$, $m = |E|$, $n = |V|+|E|$, такая, что $\Stable(G) =_A \Part(A)$.
\end{lemma}
	
\begin{proof}
	Для каждого неравенства 
	\begin{equation}
		\label{eq:Stable2}
		x_v + x_u \le 1,  \quad \{v,u\} \in E,
	\end{equation}
	из описания многогранника $\Stable(G)$ введем вспомогательную переменную $y_{vu} = 1 - x_v - x_u$.
	Остается заметить, что множество 0/1-векторов, удовлетворяющих неравенствам~\eqref{eq:Stable2}, аффинно эквивалентно множеству 0/1-векторов, удовлетворяющих уравнениям
	\begin{equation*}
		x_v + x_u + y_{vu} = 1,  \quad \{v,u\} \in E.
	\end{equation*}
\end{proof}

Таким образом, согласно соотношению~\eqref{eq:PartPack}, семейство $\{\Part(A)\}$ содержит не только все многогранники семейств $\{\Pack(A)\}$ и $\{\Stable(G)\}$, но и некоторые их грани.

Введем теперь ключевое понятие этой главы "--- аналог полиномиальной сводимости Кука--Карпа--Левина~\cite{Garey:1982} для семейств многогранников.

\begin{definition}
	\label{def:Aff}
	Семейство многогранников $P$ \emph{аффинно сводится} к семейству многогранников $Q$, если для каждого многогранника $p\in P$ найдется $q\in Q$ такой, что $p \lea q$, причем размерность пространства, в котором определен многогранник $q$, ограничена сверху полиномом от размерности пространства, в котором задан $p$.
	Обозначение: $P \propto_A Q$.  
\end{definition}

%Отметим, что это определение отличается от определения аффинной сводимости,
% введенного ранее в монографии \cite{Bondarenko:2008}, 
% в сторону усиления условий.

\begin{remark}
	В определении \ref{def:Aff} важным условием является полиномиальная зависимость размерностей пространств, в~которых определены многогранники, а~не~просто размерностей многогранников. 
	Дело в том, что система ограничений, определяющих многогранник, может оказаться далеко не самым экономным способом его описания. Тем не менее, нашей целью является именно сравнение систем ограничений, или, другими словами, условий задач, ассоциированных с многогранниками.
	
	В качестве примера многогранника с неэкономным описанием можно рассмотреть $\Part(A)$, задаваемый уравнениями
	\[
	x_1 + x_i + x_j = 1, \quad 2 \le i < j \le n.
	\]
	Очевидно, он состоит из одной единственной точки $(1,0,\dots,0)$.
	Вместе с тем, он является гранью многогранника $\Pack(A)$, определяемого неравенствами
	\[
	x_1 + x_i + x_j \le 1, \quad 2 \le i < j \le n,
	\]
	и имеющего размерность $n$.
\end{remark}

На основе выведенных выше соотношений приведем несколько примеров использования обозначения из определения~\ref{def:Aff}.
Так, соотношение \eqref{eq:compareDeltaCP} можно переписать в виде $\Delta \lea \CP$. 
А из лемм \ref{lem:StablePart}, \ref{lem:PackStable} и соотношения 	\eqref{eq:PartPack} следует
 
\begin{theorem}
	\label{thm:Class1}
	$\Stable \propto_A \Part \propto_A \Pack \propto_A \Stable$,
	где $\Stable = \{\Stable(G)\}$, $\Part = \{\Part(A)\}$, $\Pack = \{\Pack(A)\}$.
\end{theorem}

Перечислим некоторые очевидные свойства этого типа сводимости. 

\begin{theorem}
	\label{thm:Prop}
	Пусть $P \propto_A Q$. 
	Предположим, что в семействе $P$ есть многогранники, имеющие одно или несколько из следующих свойств:
	\begin{enumerate}
	\item Cверхполиномиальность (по размерности многогранника) числа вершин или гиперграней.
	\item Cверхполиномиальное кликовое число графа многогранника.
	\item NP-полнота критерия несмежности вершин.
	\item Cверхполиномиальное число прямоугольного покрытия.
	\item Cверхполиномиальная сложность расширения.
	\end{enumerate}
	\noindent
	Тогда в $Q$ имеются многогранники с теми же свойствами.
\end{theorem}

Сравним теперь семейства $\BQP = \{\BQP(n)\}$ и $\Stable$.


\begin{theorem}
	\label{thm:BQPStable}
	Для каждого $n\in \N$ существует граф $G = (V,E)$, $|V| = n(n+1)$, $|E| = n(2n-1)$, такой, что
	$\BQP(n) \lea \Stable(G)$.
\end{theorem}
(Похожий результат получен в~\cite{FioriniPokutta:2015}, но с более слабым соотношением $\lee$ и при $|V| = 2 n^2$. Кроме того, представленное ниже доказательство значительно проще изложенного в~\cite{FioriniPokutta:2015}.)

\begin{proof}
	Каждое равенство $x_{ij} = x_{ii} x_{jj}$ из уравнения~\eqref{eq:BQP}, определяющего булев квадратичный многогранник, эквивалентно неравенствам
	\begin{equation}
	\label{eq:Clique}
	\begin{aligned}
	x_{ii} - x_{ij} &\ge 0, \\
	x_{jj} - x_{ij} &\ge 0, \\
	x_{ii} + x_{jj} - x_{ij} &\le 1,
	\end{aligned}
	\end{equation}
	при условии $x_{ij}\in\{0, 1\}$, $1\le i \le j \le n$.
	Остается преобразовать их в систему неравенств вида $y_l + y_m \le 1$. %из~\eqref{SSP}.
	Для этого введем $n(n+1)$ новых 0/1-переменных:
	\begin{equation}
	\label{eq:BQP2SSP}
	\begin{aligned}
	s_{ij} &= x_{ij},           & 1 &\le i  <  j \le n,\\
	t_{ij} &= x_{ii} - x_{ij},  & 1 &\le i  <  j \le n,\\
	u_i    &= x_{ii},           & 1 &\le i \le n,\\
	\bar{u}_i    &= 1 - x_{ii}, & 1 &\le i \le n.\\
	\end{aligned}
	\end{equation}
	Тогда ограничения~\eqref{eq:Clique} эквивалентны
	%\begin{equation}\label{eq:SSP2}
	$$
	\begin{aligned}
	s_{ij} + \bar{u}_j & \le 1, \\
	t_{ij} + u_j       & \le 1, \\
	u_i    + \bar{u}_i & =   1, \\
	s_{ij} + t_{ij} + \bar{u}_i & = 1,
	\end{aligned}
	$$
	%\end{equation}
	при условии целочисленности всех переменных.
	Очевидно, последние два равенства (точнее, $n(n+1)/2$ подобных равенств)
	определяют некоторую грань многогранника $\Stable(G)$, где число вершин графа $G$ равно $n(n+1)$, а $n (2n - 1)$ его ребер определяют систему неравенств
	%\begin{equation}\label{eq:SSP2}
	$$
	\begin{aligned}
	s_{ij} + \bar{u}_j & \le 1, \\
	t_{ij} + u_j       & \le 1, \\
	u_i    + \bar{u}_i & \le 1, \\
	%   s_{ij} + t_{ij}    & \le 1, \\
	s_{ij} + \bar{u}_i & \le 1, \\
	t_{ij} + \bar{u}_i & \le 1.
	\end{aligned}
	$$
	%\end{equation}
	Более того, соотношения~\eqref{eq:BQP2SSP} связывают эту грань с многогранником $\BQP(n)$ невырожденным аффинным отображением.
\end{proof}

\begin{prop}
	\label{prop:StableBQP}
	Если граф $G=(V,E)$ неполный, то соотношение $\Stable(G) \lea \BQP(n)$ не возможно ни при каком $n$.
\end{prop}

\begin{proof}
Прежде всего заметим, что в множество вершин $\Stable(G)$ всегда входят вектора $\bm{0}$, $\bm{e_1}$, \dots, $\bm{e_d}$, где $d=|V|$.
Если граф $G=(V,E)$ неполный, то $\Stable(G)$ кроме <<обязательных>> векторов содержит еще как минимум один 0/1"~вектор. Пусть $\bm{x}$ "--- один из таких (необязательных) векторов. Легко заметить, что вершины $\bm{0}$ и $\bm{x}$ многогранника $\Stable(G)$ несмежны, так как соединяющий их отрезок пересекается с выпуклой оболочкой вершин $\bm{e_1}$, \dots, $\bm{e_d}$.
Следовательно, многогранник $\Stable(G)$ не является 2"~смежностным.
Остается заметить, что многогранник $\BQP(n)$ (а вместе с ним и его грани) является 2"~смежностным~\cite{Padberg:1989}.
\end{proof}

\section{Многогранники покрытий и двойных покрытий}

По аналогии с многогранниками упаковок и разбиений множества,
\emph{многогранником покрытий множества} называется выпуклая оболочка множества
\[
\Cover(M) = \Set*{\bm{x}\in\{0,1\}^n \given M \bm{x} \ge \bm{1}},
\quad \text{где } M\in\{0,1\}^{m\times n}.
\]

\emph{Многогранником двойных покрытий} будем называть выпуклую оболочку множества
\[
\DCP(B) =  \Set*{\bm{x}\in\{0,1\}^n \given B \bm{x} = \bm{2}},
\]
где $B \in \{0,1\}^{m\times n}$, причем каждая строка матрицы $B$ содержит ровно четыре единицы и не имеет нулевых столбцов.
По-видимому, впервые это семейство многогранников было рассмотрено Мацуи~\cite{Matsui:1995}.
Им же была установлена связь между многогранниками покрытий и двойных покрытий.

\begin{theorem}[Мацуи {\cite[theorem 4.3]{Matsui:1995}}]
Для каждой матрицы $B \in \{0,1\}^{m\times n}$ с четырьмя единицами в каждой строке несложно описать матрицу $M \in \{0,1\}^{4m\times n}$ с тремя единицами в каждой строке, что $\DCP(B) \lea \Cover(M)$.
\end{theorem}

Известно также, что задача проверки несмежности вершин для многогранников двойных покрытий NP-полна~\cite{Matsui:1995}.
Точнее, она NP-полна для некоторого подсемейства семейства $\DCP$, о котором пойдет речь ниже.
С целью упрощения обсуждения свойств этого подсемейства, мы приведем более удобное его описание, чем в первоисточнике~\cite{Matsui:1995}.

Прежде всего отметим, что вопрос <<Содержит ли многогранник разбиений $\Part(A)$ хотя бы одну точку?>> является NP-полной задачей даже если все строки матрицы $A$ содержат ровно три единицы~\cite{Matsui:1995,Garey:1982}.
С каждым многогранником $\Part(A)$, $A \in \{0,1\}^{m\times n}$, удовлетворяющим этому условию, свяжем многогранник, множество вершин $\NPadj(A) \subset \{0,1\}^{3n+3}$ которого определим следующим образом.
Для трех координат вектора $\bm{x} \in \NPadj(A)$ введем особые обозначения $y_1, y_2, y_3$. 
Каждой координате $z_j$ вектора $\bm{z} = (z_1,\dots,z_n) \in \Part(A)$ будут соответствовать три координаты $x_j$, $\bar{x}_j$ и $x'_j$ вектора $\bm{x} \in \NPadj(A)$, и два ограничения
\begin{align}
x_j + \bar{x}_j &= 1, \label{eq:adj01}\\
y_1 + y_2 + x'_j + \bar{x}_j&= 2. \notag
\end{align}
А для каждого ограничения вида $z_i + z_j + z_k = 1$ из описания $\Part(A)$
(случай, когда $A$ не содержит ни одной строки, исключаем из рассмотрения)
добавим к описанию множества $\NPadj(A)$ уравнение
\[
y_3 + x_i + x'_j + x'_k = 2.
\]

Заменяя каждое уравнение~\eqref{eq:adj01} в описании многогранника $\NPadj(A)$ на 
\[
a + b + x_j + \bar{x}_j = 2, \quad a = 0, \quad b = 1,
\]
приходим к следующему выводу.

\begin{prop}
Для каждой матрицы $A \in \{0,1\}^{m\times n}$, имеющей ровно три единицы в каждой строке, несложно описать матрицу $B \in \{0,1\}^{(2n+m)\times(3n+5)}$,
что $\NPadj(A) \lea \DCP(B)$.
\end{prop}	


Заметим теперь, что ограничения 
\[
y_1 = 0, \quad y_2 = 1, \quad y_3 = 1,
\]
определяют грань многогранника $\NPadj(A)$, аффинно эквивалентную многограннику $\Part(A)$.
Таким образом,
\begin{equation}\label{eq:PartNPadj}
\Part(A) \lea \NPadj(A).
\end{equation}	
То же самое верно и для следующих наборов ограничений:
\begin{enumerate}
\item[1)] $y_1 = 1$, $y_2 = 0$, $y_3 = 1$;
\item[2)] $y_1 = 0$, $y_2 = 1$, $y_3 = 0$;
\item[3)] $y_1 = 1$, $y_2 = 0$, $y_3 = 0$.
\end{enumerate}
Обозначим эти грани (точнее, множества их вершин) $F_1$, $F_2$, $F_3$, $F_4$, в порядке упоминания.
Заметим, что все четыре грани не имеют общих точек.
Кроме того,
\[
F_4 = \Set*{\bm{1} - \bm{x} \given \bm{x} \in F_1}, \qquad
F_3 = \Set*{\bm{1} - \bm{x} \given \bm{x} \in F_2}.
\]

Ограничениям
\[
y_1 = y_2 = 0
\]
удовлетворяет ровно одна вершина многогранника $\NPadj(A)$, имеющая координаты
$x'_j = \bar{x}_j = 1$, $y_3 = x_j = 0$, $j\in[n]$.
Обозначим эту вершину $\bm{x^0}$.
Аналогично, если 
\[
y_1 = y_2 = 1,
\]
то $x'_j = \bar{x}_j = 0$, $y_3 = x_j = 1$, $j\in[n]$.
Обозначим эту вершину $\bm{\bar{x}^0}$.
Очевидно, $\bm{\bar{x}^0} = \bm{1} - \bm{x^0}$.

Из приведенных выше рассуждений следует, что 
\[
\NPadj(A) = F_1 \cup F_2 \cup F_3 \cup F_4 \cup \{\bm{x^0}, \bm{\bar{x}^0}\},
\]
причем все пять множеств не пересекаются.
Кроме того, вершины $\bm{x^0}$ и $\bm{\bar{x}^0}$ смежны тогда и только тогда, когда $F_1 = \emptyset$ (в противном случае $\conv\{F_1 \cup F_4\}$ и $\conv\{\bm{x^0}, \bm{\bar{x}^0}\}$ имеют общую точку $\bm{1}/2$).
Таким образом, в силу того, что $F_1$ аффинно эквивалентна $\Part(A)$, приходим к следующему выводу.

\begin{theorem}[Мацуи {\cite[theorem 4.1]{Matsui:1995}}]
Задача проверки несмежности вершин $\bm{x^0}$ и $\bm{\bar{x}^0}$ многогранника $\NPadj(A)$ NP-полна.
\end{theorem}
\begin{corollary}
Для семейств многогранников покрытий $\Cover$ и двойных покрытий $\DCP$ задача проверки несмежности вершин NP-полна.
\end{corollary}	

Как известно~\cite{Ikura:1985,Chvatal:1975}, многогранники $\Part(A)$ имеют простой критерий проверки смежности вершин.
Соответственно, в предположении $\NP \ne \textup{P}$ аффинная сводимость $\NPadj \propto_A \Part$ невозможна.
Покажем, что последнее верно и без указанного предположения.

\begin{theorem}\label{thm:DCPStable}
	Если многогранник $\NPadj(A)$ не является отрезком, то $\NPadj(A) \lea \Stable(G)$ невозможно ни для какого графа $G$.
\end{theorem}

\begin{proof}
Как было замечено выше, многогранник $\NPadj(A)$ обязательно содержит пару вершин $\bm{x^0}$ и $\bm{\bar{x}^0}$, и некоторое количество 
четверок вершин вида $\bm{x^{2i-1}} \in F_1$, $\bm{\bar{x}^{2i-1}} \in F_4$, $\bm{x^{2i}} \in F_2$, $\bm{\bar{x}^{2i}} \in F_3$, $i\in [k]$, $k \ge 1$.
Причем
\begin{equation}
\label{3xpairs}
	\bm{x^0} + \bm{\bar{x}^0} = \bm{x^{2i-1}} + \bm{\bar{x}^{2i-1}} = \bm{x^{2i}} + \bm{\bar{x}^{2i}}.
\end{equation}

Предположим, что $\NPadj(A)$ аффинно эквивалентен некоторой грани 
\[
H = \{\bm{y^0}, \bm{\bar{y}^0}, \ldots, \bm{y^{2k}}, \bm{\bar{y}^{2k}}\}
\] 
многогранника $\Stable(G)$ для некоторого графа $G = (V,E)$.
Очевидно, вершины этой грани должны наследовать свойство~\eqref{3xpairs}:
\begin{equation}
\label{3pairs}
	\bm{y^0} + \bm{\bar{y}^0} = \bm{y^{2i-1}} + \bm{\bar{y}^{2i-1}} = \bm{y^{2i}} + \bm{\bar{y}^{2i}}.
\end{equation}
Покажем, что в многограннике $\Stable(G)$ есть еще пара вершин $\bm{y^*}$ и $\bm{\bar{y}^*}$, для которых
\begin{equation}
\label{ThGoal}
\bm{y^*} + \bm{\bar{y}^*} = \bm{y^0} + \bm{\bar{y}^0}.
\end{equation}
Это будет означать, что пересечение $\conv\{\bm{y^*}, \bm{\bar{y}^*}\}$ и $\conv(H)$ не пусто.
То есть $H$ не является гранью $\Stable(G)$.

\begin{figure}
	\[
	\begin{aligned}
	\bm{y^0}&=(\overbrace{\text{\texttt{1,0,1,1,}}}^{I}
	\overbrace{\text{\texttt{0,0,0,0,1,1,1}}}^{J})\\[-1.3ex]
	&\phantom{=(\text{\texttt{1,0,1,1, }}}^{j_0} \\[-2.5ex]
	\bm{\bar{y}^0}&=(\text{\texttt{1,0,1,1,}}
\underbrace{\text{\texttt{1,1,1,1,}}}_{U_0}\!
	\underbrace{\text{\texttt{0,0,0}}}_{\bar{U}_0})
	\end{aligned}
	\]
	\caption{Множества индексов $I$, $J$, $U_0$, $\bar{U}_0$.}
	\label{fig:IJU}
\end{figure}

Пусть $\bm{y^0} = (y^0_1, \ldots, y^0_m)$ и $\bm{\bar{y}^0} = (\bar{y}^0_1, \ldots, \bar{y}^0_m)$, где $m$ "--- число вершин графа $G$.
Рассмотрим множество
\[
I = \Set*{i\in [m] \given y^0_i = \bar{y}^0_i}.
\]
Так как каждая вершина в $\Stable(G)$ является 0/1-вектором, то из~\eqref{3pairs} и~\eqref{ThGoal} следует
\begin{equation}
\label{eq:8}
y^*_i + \bar{y}^*_i = y^0_i = \bar{y}^0_i = \cdots = y^{2k}_i = \bar{y}^{2k}_i  \quad \text{ при } i\in I.
\end{equation}
Далее будем рассматривать только те координаты, значения которых различны для каждой пары вершин (см. рис.~\ref{fig:IJU}):
\[
J = \Set*{j\in [m] \given y^0_i + \bar{y}^0_i = 1} = [m] \setminus I.
\]
Очевидно, $J \ne \emptyset$.

Зафиксируем какой нибудь индекс $j_0 \in J$ и для каждого $i \in \{0,1,\dots, 2k\}$ определим множество
\[
U_i =\begin{cases}
\Set*{j\in J \given y^i_j = 1},& \text{если } y^i_{j_0} = 1,\\
\Set*{j\in J \given \bar{y}^i_j = 1},& \text{иначе},
\end{cases} 
\]
По построению все эти множества попарно различны и $j_0 \in U_i$ (см. рис.~\ref{fig:IJU}).
Для каждого $U_i$ рассмотрим его дополнение $\bar{U}_i = J \setminus U_i$.
Согласно данному определению, для любого $i \in \{0,1,\dots, 2k\}$ и для любых $p,r \in U_i$ (а также для любых $p,r \in \bar{U}_i$) найдется вершина $\bm{y} \in H$ такая, что $y_p = y_r = 1$. 
То есть неравенство $y_p + y_r \le 1$ отсутствует в описании многогранника $\Stable(G)$.

Введем в рассмотрение множество
\[
S = S(i,j,t) = U_i \symdiff U_j \symdiff U_t, \quad 0\le i < j < t \le 2k,
\]
Покажем, что вектор $\bm{y^*}$ с координатами
\[
y^*_i = \begin{cases}
y^0_i,& \text{при } i \in I,\\
1,& \text{при } i \in S,\\
0,& \text{при } i \in J \setminus S,
\end{cases}
\]
и вектор $\bm{\bar{y}^*}$ с координатами
\[
\bar{y}^*_i = \begin{cases}
y^0_i,& \text{при } i \in I,\\
0,& \text{при } i \in S,\\
1,& \text{при } i \in J \setminus S,
\end{cases}
\]
принадлежат $\Stable(G)$.
Для этого достаточно показать, что если вершины грани $H$ удовлетворяют некоторому неравенству вида $y_p + y_r \le 1$ из описания многогранника $\Stable(G)$, то $\bm{y^*}$ и $\bm{\bar{y}^*}$ тоже ему удовлетворяют.

Возможны несколько случаев.

Пусть $p,r\in I$, $p \ne r$.
Так как при $i \in I$ $i$-е координаты вершин грани $H$ и векторов $\bm{y^*}$ и $\bm{\bar{y}^*}$ совпадают, то из того, что неравенство $y_p + y_r \le 1$  выполнено для $H$ следует, что оно также выполнено и для векторов $\bm{y^*}$ и $\bm{\bar{y^*}}$.

Пусть $p \in I$, $r \in J$.
(Случай $r \in I$, $p \in J$ разбирается аналогично.)
Тогда $y^0_r + \bar{y}^0_r = y^*_r + \bar{y}^*_r = 1$.
Следовательно, $\max\{y^*_r, \bar{y}^*_r\} = \max\{y^0_r, \bar{y}^0_r\} = 1$.
И опять из выполнения неравенства $y_p + y_r \le 1$ для $H$ следует, что оно также выполнено для $\bm{y^*}$ и $\bm{\bar{y^*}}$.

Пусть $p \in S$, $r \in J\setminus S$.
(Случай $r \in S$, $p \in J\setminus S$, разбирается аналогично.)
Тогда $y^*_p + y^*_r = \bar{y}^*_p + \bar{y}^*_r = 1$ и требуемое ограничение выполнено.

Пусть $p,r \in S$, $p \ne r$, где $S = S(i,j,t)$.
(Случай $p,r \in J \setminus S$, $p \ne r$, разбирается аналогично.)
Покажем, что в этом случае $p$ и $r$ принадлежат одновременно одному из шести множеств:
$U_i$, $U_j$, $U_t$, $\bar{U}_i$, $\bar{U}_j$, $\bar{U}_t$.
Если это действительно так, то (как было сказано выше при определении этих множеств) неравенство $y_p + y_r \le 1$ отсутствует в описании многогранника $\Stable(G)$.

Итак, предположим, что $p,r \in U_i \symdiff U_j \symdiff U_t$, и покажем, что тогда $p$ и $r$ принадлежат одновременно одному из множеств:
$U_i$, $U_j$, $U_t$, $\bar{U}_i$, $\bar{U}_j$, $\bar{U}_t$.
Заметим, что $U_i \symdiff U_j \symdiff U_t$ представляет собой объединение четырех множеств:
\[
U_i \symdiff U_j \symdiff U_t = (U_i \cap U_j \cap U_t) \cup (U_i \cap \bar{U}_j \cap \bar{U}_t) \cup (\bar{U}_i \cap U_j \cap \bar{U}_t) \cup (\bar{U}_i \cap \bar{U}_j \cap U_t).
\]
Если $p$ и $r$ принадлежат одному из этих четырех множеств, то требуемое условие выполнено.
Нетрудно проверяется, что условие выполнено и в случае, когда $p$ и $r$ принадлежат разным множествам.
Например, если $p \in U_i \cap \bar{U}_j \cap \bar{U}_t$, а $r \in \bar{U}_i \cap \bar{U}_j \cap U_t$, то $p,r \in \bar{U}_j$.

Для завершения доказательства остается показать, что найдется тройка индексов $i$, $j$, $t$, $0\le i < j < t \le 2k$, что $S(i,j,t)$ будет отличаться от каждого из множеств $U_p$ и $\bar{U}_p$, $0\le p \le 2k$.

Начнем с простого случая, когда $k=1$.
Нетрудно проверить, что
\[
S(0,1,2) = U_0 \symdiff U_1 \symdiff U_2 \not\in \{U_0, U_1, U_2, \bar{U}_0, \bar{U}_1, \bar{U}_2\},
\]
так как все множества различны и, кроме того, все $U_i$ имеют общий элемент $j_0$:
\[
U_i \symdiff U_j \ne \emptyset \quad \text{и} \quad U_i \symdiff U_j \ne J, \quad \text{при } i\ne j.
\]
	
Предположим теперь, что $k>1$.
Рассмотрим тройки вида 
\[
U_0 \symdiff U_1 \symdiff U_i, \quad 2 \le i \le 2k.
\]
Как было замечено выше,
\[
U_0 \symdiff U_1 \symdiff U_i \not\in \{U_0, U_1, U_i\}.
\]
Кроме того, $U_0 \symdiff U_1 \symdiff U_i \ne \bar{U}_j$ при любом $j \in \{0,1,\dots,2k\}$, так как $j_0 \notin \bar{U}_j$.
Предположим, что 
\begin{equation}
\label{eq:sym-pair}
U_0 \symdiff U_1 \symdiff U_i = U_j
\end{equation}
при некотором $j \in \{2,3,\dots,2k\} \setminus \{i\}$.
Но тогда, в силу свойств симметрической разности (свойство~\ref{prop:symdiff} на с.~\pageref{prop:symdiff})
\[
U_0 \symdiff U_1 \symdiff U_j = U_i.
\]
Причем
\[
U_0 \symdiff U_1 \symdiff U_t \ne U_j, \quad \forall t \ne i,
\]
так как иначе $U_t = U_i$, что невозможно по условию.
По тем же соображениям,
\[
U_0 \symdiff U_1 \symdiff U_t \ne U_i, \quad \forall t \ne j.
\]
Таким образом, тройки, для которых выполнено условие \eqref{eq:sym-pair}, разбиваются на пары. 
Но общее число множеств $U_i$, $2 \le i \le 2k$, нечетно.
То есть обязательно найдется множество $U_i$, для которого
$S(0,1,i) = U_0 \symdiff U_1 \symdiff U_i$ будет отличаться от всех остальных.
\end{proof}

Учитывая, что $\NPadj(A)$ является гранью многогранника двойных покрытий, получаем
\begin{corollary}
$\DCP \npropto_A \Stable$ и $\Cover \npropto_A \Stable$.
\end{corollary}	

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  Многогранники с NP-полным критерием несмежности вершин
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Многогранники с NP-полным критерием\\ несмежности вершин}

В этом разделе мы рассмотрим несколько семейств многогранников, к которым аффинно сводятся многогранники двойных покрытий.
Как следствие, для всех этих многогранников задача проверки несмежности вершин NP-полна.
Начнем с простых примеров.

\subsection{Многогранники задачи о рюкзаке}

Если в описании многогранников задачи о рюкзаке (уравнение~\eqref{eq:KNAP} на с.~\pageref{eq:KNAP}) неравенство заменить равенством, то получим \emph{многогранники задаче о рюкзаке с равенством}:
\begin{equation*}
\KnapEq(\bm{a},b) = \Set*{\bm{x} \in \{0,1\}^{n} \given \bm{a}^T \bm{x} = b}, \qquad \bm{a} \in \Z^n,\quad b \in \Z.
\end{equation*}
Очевидно,
\[
\KnapEq(\bm{a},b) \lea \Knap(\bm{a},b).
\]
Подсемейство многогранников $\KnapEq(\bm{a},b)$, удовлетворяющее условию $2b = \bm{a}^T \bm{1}$, обозначим $\PRT(\bm{a})$.
Оно непосредственно связано с задачей о разбиении чисел, входящей в список из 21 задачи, NP-полнота которых была доказана в фундаментальной работе Карпа~\cite{Karp:1972}.

\begin{theorem}
Для любой матрицы $B \in \{0,1\}^{m\times n}$, имеющей ровно четыре единицы в каждой строке, можно за полиномиальное (от её размера) время построить вектор $\bm{a} \in \Z^n$, $\|\bm{a}\|_{\infty} \le 4^m$,
что $\DCP(B) =_A \PRT(\bm{a})$.
\end{theorem}
\begin{proof}
Достаточно заметить, что система линейных диофантовых уравнений $B \bm{x} = \bm{2}$ может быть агрегирована в одно уравнение (см. \cite{Padberg:1972, Kovalev:1977}).
Например, можно сложить все уравнения системы $B \bm{x} = \bm{2}$, предварительно умножив каждое из них на $4^i$, где $i\in[m]$ "--- номер уравнения.
\end{proof}
\begin{corollary}
Задача проверки несмежности вершин для семейств многогранников $\PRT(\bm{a})$, $\KnapEq(\bm{a},b)$ и $\Knap(\bm{a},b)$ NP-полна.
\end{corollary}
Ранее этот результат об NP-полноте был получен в работах~\cite{Chung:1980,Geist:1992,Matsui:1995} иными методами.


\subsection{Многогранники задачи о назначениях с ограничением}

Пусть $\bm{a} \in \Z^{n\times n}$, $b \in Z$.
\emph{Многогранник задачи о назначениях с ограничением} определяется как выпуклая оболочка множества
\begin{equation*}
\CAP(\bm{a},b) = \Set*{\bm{x} \in \Birk(n) \given \bm{a}^T \bm{x} = b},
\end{equation*}
где $\Birk(n)$ "--- многогранник Биркгофа.

Интерес к этой задаче и её многограннику обусловлен многочисленными приложениями
(см., например, \cite{Toktas:2006}).
NP-полнота задачи распознавания несмежности вершин этого многогранника была обнаружена Альфаки и Мурти~\cite{Alfakih:1998}.

Покажем, что многогранники задачи о рюкзаке с равенством аффинно сводятся к этому семейству.

\begin{theorem}
\label{thm:KnapEqCAP}
Для каждого $\bm{a} \in \Z^n$ и $b \in Z$ найдется $\bm{c} \in \Z^{2n\times 2n}$ такой, что
\[
\KnapEq(\bm{a},b) \lea \CAP(\bm{c},b).
\]
\end{theorem}

\begin{proof}
Воспользуемся тем, что многогранник $\Birk(2n)$ содержит грань, являющуюся $n$-мерным кубом. %~\cite{Billera:1996}.
Эта грань лежит в пересечении гиперплоскостей $x_{ij} = 0$, для всех $(i,j)$ не входящих в множество 
\[
%\Set*{(i,j) \in [2n]^2 \given \text{$i$ нечетно и $j \in \{i,i+1\}$, либо $i$ четно и $j \in \{i-1,i\}$}}.
S = \big\{(i,i) \mid i\in[2n]\big\} \cup \big\{(2i-1,2i) \mid i\in[n]\big\} \cup \big\{(2i,2i-1) \mid i\in[n]\big\}.
\]

Для данного по условию вектора $\bm{a} = (a_1,\dots,a_n) \in \Z^n$ определим координаты вектора $\bm{c} \in \Z^{2n\times 2n}$ следующим образом:
\[
c_{ij} = \begin{cases}
a_p,& \text{если $i=j=2p$, $p\in[n]$},\\
0,& \text{иначе.}
\end{cases}
\]

Нетрудно увидеть, что множество вершин указанной выше грани ($n$-мерного куба), попадающих гиперплоскость $\bm{c}^T \bm{x} = b$, аффинно эквивалентно многограннику $\KnapEq(\bm{a},b)$.
С другой стороны, оно же является гранью многогранника $\CAP(\bm{c},b)$.
\end{proof}


\subsection{Многогранники задачи о k-выполнимости и задачи о частичном упорядочивании}

Пусть $U = \{u_1, u_2, \ldots, u_d\}$ "--- множество булевых переменных.
Не уменьшая общности, полагаем $u_i \in \{0, 1\}$, где $1$ трактуется как <<истина>>, а $0$ "--- как <<ложь>>.
Пусть $C = \{C_1, C_2, \ldots, C_n\}$ "--- некоторый набор дизъюнкций
(конъюнкция дизъюнкций) над $U$.
%Кроме того, далее предполагаем, что каждая дизъюнкция состоит ровно из $k$ литералов.

Для каждого выполняющего конъюнкцию $C$ набора значений переменных
рассмотрим вектор $\bm{u} = (u_1, \dots, u_d)\in\{0,1\}^d$.
Множество всех таких векторов обозначаем $\SAT(U,C)$,
а его выпуклая оболочка называется \emph{многогранником задачи о выполнимости}.
В случае, если каждая дизъюнкция в $C$  состоит ровно из $k$ литералов, он называется \emph{многогранником задачи о $k$-выполнимости}.

 
\begin{theorem}
\label{thm:DCPSAT}
Для каждой матрицы $B \in \{0,1\}^{m\times n}$, имеющей ровно четыре единицы в каждой строке, можно за линейное время построить конъюнкцию $C = \{C_1,\dots, C_{8m}\}$ над $U = \{u_1,\dots, u_n\}$ такую, что $|C_i|=3$, $i \in [8m]$, и 
\[
\DCP(B) =_A \SAT(U,C).
\]
\end{theorem}

\begin{proof}
Каждое уравнение вида $x_1 + x_2 + x_3 + x_4 = 2$ из системы $B \bm{x} = \bm{2}$ можно заменить набором из восьми дизъюнкций: 
\[
\bigvee_{j\neq i} x_j \ \mbox{ и } \ \bigvee_{j\neq i} \bar{x}_j, 
\qquad i=1,2,3,4.
\]
\end{proof}
\begin{corollary}
Задача распознавания несмежности двух произвольных вершин многогранника задачи о 3-выполнимости NP-полна.
\end{corollary}

Ранее, Фиорини~\cite{Fiorini:2003} доказал этот факт (NP-полноты несмежности вершин) непосредственно. 
В той же работе Фиорини показано, что многогранники задачи о 3-выполнимости тесно связаны с многогранниками задачи о частичном упорядочивании.
Сформулируем ее на языке теории графов. 
Подграф $D' = (V, A')$ полного орграфа $D = (V, A)$ будем называть \emph{частичным порядком}, если он ацикличен и транзитивен:
\[
((u, v)\in A') \& ((v, w)\in A') \Rightarrow (u, w)\in A'.
\]

\emph{Многогранник частичных порядков} представляет собой выпуклую оболочку множества $\POP(n)$ характеристических векторов всех частичных порядков полного орграфа на $n$ вершинах.

\begin{theorem}[Фиорини {\cite[Lemma 3.2]{Fiorini:2003}}]
Многогранник задачи о 3-выполнимости $\SAT(U,C)$, $U=\{u_1,\dots,u_d\}$, $C = \{C_1,\dots,C_n\}$, $|C_i|=3$, $i \in [n]$,  аффинно эквивалентен грани многогранника частичных порядков $\POP(m)$ при $m = 3d+7n$.
\end{theorem}

Из этого, в частности, следует NP-полнота задачи распознавания несмежности вершин для многогранника частичных порядков.

Более того, семейства многогранников частичных порядков и многогранников задачи о 3-выполнимости эквивалентны с точки зрения аффинной сводимости.

\begin{theorem}[Фиорини {\cite[Theorem 1.2]{Fiorini:2003}}]
Многогранник $\POP(m)$ аффинно эквивалентен грани многогранника задачи о 3-выполнимости $\SAT(U,C)$, где $|U| = n(n-1)+1$, $|C| = n(n-1)(n-3/2)$.
\end{theorem}

Рассмотрим теперь отдельно семейства многогранников задачи о $k$-выполнимости для разных $k \ge 3$ (случай $k=2$ не представляет интереса).
Почти очевидно следующее утверждение.

\begin{lemma}[Фиорини {\cite[Lemma 4.1]{Fiorini:2003}}]
%Пусть $U = \{u_1,\dots,u_d\}$, $C = \{C_1,\dots,C_n\}$, $|C_i| \le k$, $i\in[n]$.
Многогранник задачи о выполнимости $\SAT(U,C)$ при $|c| \le k$, $c\in C$, является гранью многогранника задачи о $k$"~выполнимости $\SAT(U',C')$, где $|C'|=|C|$, $|U'|=|U| + k - m$, $m = \min\Set{|c| \given c \in C}$.
\end{lemma}

Оказывается, семейства многогранников задачи о $k$"~выполнимости для разных значений $k \ge 3$ относятся к разным классам эквивалентности с точки зрения аффинной сводимости.

\begin{theorem}[Фиорини {\cite[Proposition 4.1]{Fiorini:2003}}]
\label{thm:kSAT}
Существуют примеры многогранников задачи о $k$-выполнимости $\SAT(U,C)$ при $|U|=k$ и $|C|\ge 1$ такие, что для любых $U'$ и $C'$, при условии $|c'| < k$, $c' \in C'$, справедливо
\[
\SAT(U,C) \not\lea \SAT(U',C').
\]
\end{theorem}

Рассмотрим теперь семейство всех многогранников задачи о выполнимости $\SAT = \{\SAT(U,C)\}$ и покажем, что оно эквивалентно многогранникам покрытий.

\begin{theorem}
$\Cover \propto_A \SAT \propto_A \Cover$.
\end{theorem}
\begin{proof}
Пусть $A \in \{0,1\}^{m\times n}$.
Рассмотрим $U=\{u_1,\dots,u_n\}$ и для каждого неравенства вида
\[
x_{i_1}+x_{i_2}+\dots+x_{i_k} \ge 1
\]
системы $A\bm{x} \ge \bm{1}$ добавим в $C$ дизъюнкцию
\[
u_{i_1} \vee u_{i_2} \vee \dots \vee u_{i_k}.
\]
Очевидно,
\[
\Cover(A) =_A \SAT(U,C).
\]

Докажем второе утверждение теоремы.
Пусть $U=\{u_1,\dots,u_n\}$ "--- некоторый набор булевых переменных и $C=\{C_1,\dots,C_m\}$ "--- конъюнкция дизъюнкций над $U$.
Для каждого $i\in[n]$ введем в рассмотрение пару переменных $x_i$ и $\bar{x}_i$,
и свяжем их неравенством 
\begin{equation}
\label{eq:proofSATCover}
x_i + \bar{x}_i \ge 1.
\end{equation}
Переменные $x_i$ будут соответствовать литералам $u_i$ в $C$, а переменные $\bar{x}_i$ "--- литералам $\bar{u}_i$.
Для каждой дизъюнкции $C_j$, $j\in[m]$, заменяя литералы соответствующими переменными, расставляя вместо $\vee$ знаки сложения,
и добавляя справа ${} \ge 1$, получим $m$ неравенств.
Вместе с неравенствами \eqref{eq:proofSATCover} они описывают некоторый многогранник $\Cover(A)$.
Заменяя неравенство в \eqref{eq:proofSATCover} равенством, получим грань этого многогранника,
аффинно эквивалентную $\SAT(U,C)$.
\end{proof}

\subsection{Многогранники кубических подграфов}

Пусть $G=(V,E)$ "--- полный граф на $k$ вершинах и пусть $T_k$ "--- множество всех его кубических подграфов. (Напомним, что степень каждой вершины кубического графа равна трем.)
\emph{Многогранником кубических подграфов} называется выпуклая оболочка множества 
\[
\Cubic(k) = \Set*{\chi(H)\in\{0,1\}^E \given H \in T_k}.
\]

Известно, что задача проверки несмежности вершин этого многогранника NP-полна~\cite{Bondarenko:1996}.
Покажем, что многогранники двойных покрытий являются гранями этого многогранника.

\begin{theorem}
$\DCP(A) \lea \Cubic(k)$, где	
матрица $A \in \{0,1\}^{m\times n}$ имеет ровно четыре единицы в каждой строке и
$k = 6m+4s+2t$, $s$ "--- число столбцов матрицы $A$, содержащих лишь одну единицу, $t$ "--- число столбцов матрицы $A$, содержащих ровно две единицы.
\end{theorem}
\begin{proof}
Через $\bm{x}=(x_i)\in\{0,1\}^n$ будем обозначать вектор, удовлетворяющий условию $A\bm{x}=\bm{2}$, определяющему вершины многогранника $\DCP(A)$.
Через $\bm{y}=(y_{lh})\in\R^{k(k-1)/2}$ "--- характеристический вектор кубического подграфа графа $G=(V, E)$ из описания многогранника $\Cubic(k)$.
Воспользуемся тем, что для многогранника $\Cubic(k)$ гиперплоскости вида $y_{lh}=0$	% и $y_{lh}=1$ 
являются опорными.
Искомую грань будем определять как пересечение нескольких таких гиперплоскостей.
Очевидно, если выполнено $y_{lh}=0$, то мы можем рассматривать только те подграфы графа $G$, которые не содержат ребро $(v_l, v_h)$.
Таким образом, чтобы определить нужную нам грань, мы опишем некоторый подграф $G'$ графа $G$, подразумевая, что для не входящих в него ребер выполнено $y_{lh}=0$.
	
Разберем в начале случай, когда в каждом \emph{столбце} матрицы $A$ присутствует не менее трех единиц.
%Подразумевая использование гиперплоскостей вида $y_{lh}=0$,	
%Определим подграф $G'$ графа $G$ следующим образом.
Множество вершин $V$ графа $G$ будет состоять из трех подмножеств:
$U = \{u_1, u_2, \ldots, u_m\}$, $W = \{w_1, w_2, \ldots, w_m\}$ и $T$, где $|T| = 4m$.
Обозначения элементов множества $T$ поставим в зависимость от содержимого матрицы~$A$:
\[
T=\Set{t_{ij} \given a_{ij}=1, \ 1\le i \le m, \ 1\le j \le n}.
\]
(Поскольку каждая строка матрицы $A$ содержит ровно 4 единицы, то $|T| = 4m$.)


Все вершины $t_{ij}$ с одинаковым вторым индексом $j=\const$ соединяем ребрами в циклы (порядок соединения не важен).
Напомним, что, по предположению, в каждом столбце матрицы $A$ содержится не менее трех ненулевых элементов.
Всего образуется $n$ таких циклов.
Вершины множества $W$ тоже соединяем циклом.
Добавляем в граф $G'$ ребра $(w_i, u_i)$ и ребра $(u_i, t_{ij})$,
$1\le i \le m$, $1\le j \le n$.
	
Как уже было сказано ранее, построенный подграф $G'$ определяет некоторую опорную гиперплоскость к многограннику кубических подграфов.
Рассмотрим еще одну опорную гиперплоскость, положив степени вершин множества $W$ равными трем.
Пересечение обеих указанных гиперплоскостей с многогранником кубических подграфов и будет искомой гранью.
Нетрудно проверить, что множество ее вершин аффинно эквивалентно множеству вершин многогранника соответствующей задачи о двойном покрытии.
	
Остается рассмотреть тот случай, когда (некоторые) столбцы матрицы $A$ содержат одну или две единицы.
Сложность здесь состоит лишь в том, чтобы соединить соответствующие одну или две вершины множества $T$ в цикл.
Чтобы сделать цикл <<с одной вершиной>>, добавим в $T$ четыре вспомогательные: 
$s_{j1}$, $s_{j2}$, $s_{j3}$, $s_{j4}$.
Для цикла <<с двумя вершинами>> добавим	в множество $T$ две: $s_{j1}$, $s_{j2}$.
Соединим их так, как показано на рис.~\ref{fig:Cubic}.
	
% Рисунок 2
\begin{figure}[tbh]
\centering
\tikzset{small circle/.style={inner sep = 1.5pt,draw,circle}}
	\begin{tikzpicture}[scale=0.7,
	>={Stealth[scale width=0.8]} % Определяем вид стрелок
	]
	\node[small circle,densely dotted] (u) at (-2,0) {};	
	\node[small circle] (t) at (0,0) {};	
	\node[small circle] (s4) at (2,1) {};	
	\node[small circle] (s1) at (4,1) {};	
	\node[small circle] (s3) at (2,-1) {};	
	\node[small circle] (s2) at (4,-1) {};	
	\draw (t) node[above] {$t_{ij}$} -- (s4) node[above] {$s_{j4}$} -- (s1) node[above] {$s_{j1}$} -- (s2) node[below] {$s_{j2}$} -- (s3) node[below] {$s_{j3}$} -- (t);
	\draw (s4) -- (s2) (s1) -- (s3);
	\draw[dashed] (u) node[above] {$u_{ij}$} -- (t);
	\draw (-4,1) node[above] {а)};
	\begin{scope}[xshift=14cm]
	\node[small circle,densely dotted] (u1) at (-2,1) {};	
	\node[small circle,densely dotted] (u2) at (-2,-1) {};	
	\node[small circle] (t1) at (0,1) {};	
	\node[small circle] (t2) at (0,-1) {};	
	\node[small circle] (s1) at (2,1) {};	
	\node[small circle] (s2) at (2,-1) {};	
	\draw (t1) node[above] {$t_{i_1 j}$} -- (s1) node[above] {$s_{j1}$} -- (s2) node[below] {$s_{j2}$} -- (t2) node[below] {$t_{i_2 j}$};
	\draw (t1) -- (s2) (s1) -- (t2);
	\draw[dashed] (u1) node[above] {$u_{i_1 j}$} -- (t1) (u2) node[above] {$u_{i_2 j}$} -- (t2);
	\draw (-4,1) node[above] {б)};
	\end{scope}
	\end{tikzpicture}
	\caption{Циклы с <<одной>> и <<двумя>> вершинами.}
	\label{fig:Cubic}
\end{figure}
	
Очевидно, что это не внесет существенных изменений в общую конструкцию, а число вершин увеличится на $4s+2t$, где $s$ "--- число столбцов матрицы $A$, содержащих лишь одну единицу, $t$ "--- число столбцов с двумя единицами.
\end{proof}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  Многогранники c простым критерием смежности вершин
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Многогранники c простым критерием смежности вершин}

\subsection{Многогранник трехиндексной задачи о назначениях}
\label{sec:3Ass}

Пусть $S$ "--- конечное множество.
Координаты вектора $\bm{x}\in\R^{S\times S\times S}$
будем обозначать $x(s, t, u)$, где $s,t,u\in S$.
\emph{Трехиндексная аксиальная задача о назначениях} (или \emph{3-сочетаниях}) может быть сформулирована как следующая задача 0/1"~программирования:
\[
\sum_{s\in S} \sum_{t\in S} \sum_{u\in S} c(s,t,u) \cdot x(s,t,u) 
\rightarrow \max,
\] 
\begin{align}
&\sum_{s\in S} \sum_{t\in S} x(s,t,u) = 1 \quad \forall u\in S,\label{eq:ThreeBeg}\\
&\sum_{s\in S} \sum_{u\in S} x(s,t,u) = 1 \quad \forall t\in S,\label{eq:Three2}\\
&\sum_{t\in S} \sum_{u\in S} x(s,t,u) = 1 \quad \forall s\in S,\label{eq:Three3}\\
&x(s,t,u) \in \{0, 1\} \quad \forall s, t, u\in S,\label{eq:ThreeEnd}
\end{align}
где $c(s,t,u)\in\Z$ "--- координаты вектора входных данных.
Через $\TAP(m)$, $m = |S|$, обозначим множество всех векторов $\bm{x}\in\R^{S\times S\times S}$, удовлетворяющих ограничениям~\eqref{eq:ThreeBeg}--\eqref{eq:ThreeEnd}.
Выпуклая оболочка множества $\TAP(m)$ называется \emph{многогранником трехиндексной аксиальной задачи о назначениях}.
Далее, в целях экономии места, мы будем опускать слово <<аксиальной>>.

По-видимому, первыми работами, посвященными изучению свойств этого многогранника, являются~\cite{Euler:1987} и~\cite{Balas:1989}.
Более свежий обзор имеется в~\cite{Qi:2000}.
В работах Кравцова (см.~\cite{Kravtsov:2006} и ссылки в ней) изучаются свойства нецелочисленных вершин релаксаций этого многогранника.

Очевидно, $\TAP(m)$ является частным случаем $\Part(A)$:
\begin{equation}
\label{Ine3AP-PART}
\TAP(m) =_A \Part(A),
\end{equation}
где $A$ "--- $(3m\times m^3)$-матрица, образованная коэффициентами левых частей уравнений \eqref{eq:ThreeBeg}--\eqref{eq:Three3}.
Таким образом, семейство многогранников трехиндексной задачи о назначениях аффинно сводится к многогранникам разбиений: 
\[
\TAP \propto_A \Part.
\]

Пользуясь стандартным алгоритмом свед\'ения задачи 3-выполнимость к задаче 3-сочетаний~\cite{Garey:1982}, Авис и Тивари~\cite{AvisTiwary:2015} показали, что многогранник задачи 3-выполнимость $\SAT(U,C)$, $|c|=3$, $c\in C$, является проекцией грани многогранника $\TAP(m)$, где $m = O(kn)$, $k=|U|$, $n=|C|$.
Однако, из неравенства~\eqref{Ine3AP-PART} и теоремы~\ref{thm:Class1} об эквивалентности $\Stable$ и $\Part$ следует, что $\TAP \propto_A \Stable$.
С другой стороны, так как семейство $\DCP$ аффинно сводится к многогранникам задачи 3-выполнимость (теорема~\ref{thm:DCPSAT}), а $\Stable$ не может быть сведено к $\DCP$ (теорема~\ref{thm:DCPStable}), то аффинное свед\'ение многогранников задачи 3-выполнимость к $\TAP$ невозможно.

Покажем, что $\Stable \propto_A \TAP$.
Таким образом, $\TAP$ окажется в одном классе эквивалентности 
%(в смысле $\propto_A$) 
вместе с $\Stable$, $\Part$ и $\Pack$.

Для графа $G(V, E)$ в определении многогранника $\Stable(G)$ через
\[
V_{\text{isol}} = \Set{v\in V \given v\notin e \  \forall e\in E},
\]
обозначим множество изолированных вершин.

\begin{theorem}
	\label{TheSSP-3AP}
	$\Stable(G) \le \TAP(m)$ при $m = 3|E| + 2|V_{\text{isol}}|$.
\end{theorem}

\begin{proof}
	Множество $S$ в определении~$\TAP(m)$ составим из трех типов элементов:
	\begin{enumerate}
		\item $v$ и $\bar{v}$ для каждой изолированной вершины $v\in V_{\text{isol}}$.
		
		\item $e$ для каждого ребра $e\in E$.
		
		\item $(e, v)$ для каждого $e\in E$ и $v \in e$.
	\end{enumerate}
	Построим множество троек $Q \subset S\times S\times S$ так, чтобы грань
	\[
	F = \big\{x \in \TAP(m) \mid x(q) = 0 \ \forall q \notin Q\big\}
	\] 
	многогранника $\TAP(m)$ была аффинно эквивалентна многограннику $\Stable(G)$.
	
	Для каждого $v\in V_{\text{isol}}$ множество $Q$ будет содержать четыре тройки:
	\[
	(v, v, v), \quad (\bar{v}, \bar{v}, \bar{v}), \quad
	(v, v, \bar{v}), \quad (\bar{v}, \bar{v}, v).
	\] 
	Других троек, содержащих $v$ или $\bar{v}$ в $Q$ нет.
	Следовательно, если $\bm{x} \in F$, то для каждого $v\in V_{\text{isol}}$ возможны только две альтернативы: 
	\[
	x(v, v, v) = x(\bar{v}, \bar{v}, \bar{v}) = 1
	\quad \text{или} \quad 
	x(v, v, \bar{v}) = x(\bar{v}, \bar{v}, v) = 1.
	\] 
	
	Рассмотрим теперь элементы $e$ и $(e, v)$ множества $S$,
	где $e\in E$ и $v \in e$.
	Для каждой неизолированной вершины $v \in V \setminus V_{\text{isol}}$ рассмотрим множество инцидентных ей ребер $E(v) = \{e_{i_1}, \ldots, e_{i_p}\}$, где $p=d_G(v)$ "--- степень вершины $v$.
	Множество троек $Q$ содержит
	\begin{enumerate} 
		\item $\big( e, e, e \big)$ для каждого $e\in E$.
		
		\item $\big( (e,v), (e,v), (e,v) \big)$ для всех $e\in E$ и $v \in e$.
		
		\item $\big( e, e, (e,v) \big)$ для всех $e\in E$ и $v \in e$.
		
		\item $\big( (e_{i_q},v), (e_{i_{q+1}},v), e_{i_q} \big)$
		для каждой неизолированной вершины $v$ и каждого $e_{i_q} \in E(v)$,
		где сложение $q+1$ выполняется по модулю $p$.
	\end{enumerate} 
	
	Полагая $x(u, v, w) = 0$ для всех остальных троек $(u, v, w)\notin Q$,
	перейдем к рассмотрению соответствующей грани многогранника $\TAP(m)$.
	Перечислим некоторые свойства её вершин.
	
	Заметим, что для каждого $(e,v) \in S$ множество $Q$ содержит в точности две тройки с элементом $(e,v)$ в третьей компоненте: $\big( (e,v), (e,v), (e,v) \big)$ и $\big( e, e, (e,v) \big)$.
	Следовательно, уравнение~\eqref{eq:ThreeBeg} для $u = (e,v)$ принимает вид
	\begin{equation}
	\label{eq:Proof3AP1}
	x\big( (e,v), (e,v), (e,v) \big) + x\big( e, e, (e,v) \big) = 1.
	\end{equation}
	То есть, $x\big( (e,v), (e,v), (e,v) \big)$ выражается линейно через $x\big( e, e, (e,v) \big)$.
	
	Заметим также, что для каждого $e \in S$ множество $Q$ содержит ровно три тройки с элементом $e$ в первой компоненте: $\big( e, e, e \big)$, $\big( e, e, (e,v_1) \big)$ и $\big( e, e, (e,v_2) \big)$, где $e = \{v_1, v_2\}$.
	Следовательно, уравнение~\eqref{eq:Three3} при $s = e$ эквивалентно
	$$
	x\big( e, e, e \big) + x\big( e, e, (e,v_1) \big) + x\big( e, e, (e,v_2) \big) = 1.
	$$
	То есть
	$x\big( e, e, e \big) = 1 - x\big( e, e, (e,v_1) \big) - x\big( e, e, (e,v_2) \big)$
	и 
	\begin{equation}
	\label{IneProof3AP}
	x\big( e, e, (e,v_1) \big) + x\big( e, e, (e,v_2) \big) \le 1.
	\end{equation}
	
	Рассуждая по аналогии, получаем следующее уравнение
	$$
	x\big( (e_{i_q},v), (e_{i_q},v), (e_{i_q},v) \big) 
	+ x\big( (e_{i_q},v), (e_{i_{q+1}},v), e_{i_q} \big) = 1
	$$ 
	для каждой неизолированной $v$ и каждого $e_{i_q} \in E(v)$,
	где сложение $q+1$ выполняется по модулю $p=d_G(v)$.
	Вместе с уравнением \eqref{eq:Proof3AP1} получаем
	\begin{equation}
	\label{eq:Proof3AP2}
	x\big( (e_{i_q},v), (e_{i_{q+1}},v), e_{i_q} \big) = 
	1 - x\big( (e_{i_q},v), (e_{i_q},v), (e_{i_q},v) \big) =
	x\big( e_{i_q}, e_{i_q}, (e_{i_q},v) \big).
	\end{equation}
	Кроме того, так как
	$$
	x\big( (e_{i_{q+1}},v), (e_{i_{q+1}},v), (e_{i_{q+1}},v) \big) 
	+ x\big( (e_{i_q},v), (e_{i_{q+1}},v), e_{i_q} \big) = 1,
	$$ 
	то
	\begin{equation}
	\label{eq:Proof3AP3}
	x\big( (e_{i_q},v), (e_{i_{q+1}},v), e_{i_q} \big) = 
	1 - x\big( (e_{i_{q+1}},v), (e_{i_{q+1}},v), (e_{i_{q+1}},v) \big) =
	x\big( e_{i_{q+1}}, e_{i_{q+1}}, (e_{i_{q+1}},v) \big).
	\end{equation}
	Так как левые части формул \eqref{eq:Proof3AP2} и \eqref{eq:Proof3AP3}
	совпадают, то
	$$
	x\big( e_{i_{q+1}}, e_{i_{q+1}}, (e_{i_{q+1}},v) \big) 
	= x\big( e_{i_q}, e_{i_q}, (e_{i_q},v) \big).
	$$ 
	Значит $x\big( e, e, (e,v) \big) = x\big( e', e', (e',v) \big)$
	для любых двух ребер $e$ и $e'$, $v \in e$, $v \in e'$.
	
	Таким образом, для вершин описанной грани $F$ все переменные $x(s,t,u)$
	выражаются линейно через $x\big( e, e, (e,v) \big)$,
	а неравенство~\eqref{IneProof3AP} является неравенством вида $y_i + y_j \le 1$ из описания многогранника $\Stable(G)$.
\end{proof}


\begin{remark}
	Полученные результаты могут быть легко обобщены на случай $p$-индексной задачи о назначениях ($p > 3$).
	По аналогии, вершины $\PAP{p}(m)$ многогранника $p$-индексной аксиальной задачи о назначениях являются 0/1-векторами в $\R^{m^p}$.
	Координаты $x_{i_1 i_2 \ldots i_p}$, 
	$i_1, i_2, \ldots, i_p \in \{1,2,\ldots,p\}$, каждого такого вектора удовлетворяют следующим уравнениям:
	$$
	%\begin{equation}
	\begin{aligned}
	\sum_{i_2, i_3, \ldots, i_p} x_{i_1 i_2 \ldots i_p}      &= 1 \quad \forall i_1\in \{1,\ldots,p\},\\
	\sum_{i_1, i_3, i_4, \ldots, i_p} x_{i_1 i_2 \ldots i_p} &= 1 \quad \forall i_2\in \{1,\ldots,p\},\\
	\ldots\ldots & \ldots\\
	\sum_{i_1, i_2, \ldots, i_{p-1}} x_{i_1 i_2 \ldots i_p}  &= 1 \quad \forall i_p\in \{1,\ldots,p\}.\\
	\end{aligned}
	$$
	%\end{equation}
	Очевидно,
	$$
	\PAP{p}(m) \lea \Part(A), 
	$$
	для некоторой (просто определяемой) матрицы $A\in \{0,1\}^{pm\times m^p}$.
	С другой стороны, уравнения
	$$
	x_{i_1 i_2 \ldots i_p} = 0 \quad \forall i_p \ne i_{p-1}
	$$
	определяют грань многогранника $\PAP{p}(m)$, аффинно эквивалентную $\PAP{(p-1)}(m)$.
	Таким образом, по теореме~\ref{TheSSP-3AP}
	\[
	\Stable(G) \lea \PAP{p}(m) \quad \text{при } m = 3|E| + 2|V_{\text{isol}}| \le 3|V|(|V|-1)/2.
	\]
\end{remark}


\subsection{Многогранники квадратичной задачи линейных упорядочиваний
	 и~квадратичной задачи о назначениях}
\label{sec:QLOP}

%Более точно, задача о квадратичном упорядочивании 
% называется <<квадратичной задачей линейного упорядочивания>> \cite{Buchheim:2010}.
%То есть, по-существу, является усложнением обычной задачи линейного упорядочивания.
Начнем с описания задачи линейного упорядочивания на языке теории графов.

Пусть $D = (V, A)$ "--- орграф, 
$V = \{1, 2, \ldots, m\}$.
Предполагается, что орграф $D$ полный, то есть $(i,j) \in A$ и $(j,i) \in A$ для всех $i,j \in V$, $i \neq j$.
Ацикличный турнир в орграфе $D$ будем называть \emph{линейным порядком}.
Эквивалентное определение: линейный порядок "--- это частичный порядок являющийся турниром.

Координаты $y_{ij}$, $1 \le i < j \le m$ характеристического вектора $\bm{y} \in \R^{m(m-1)/2}$ для линейного порядка $L$ в $D$ определим следующим образом:
\[
y_{ij} = \begin{cases}
1 &\text{если $(i,j)\in L$,}\\
0 &\text{если $(j,i)\in L$.}
\end{cases}
\]
Обозначим через $\LOP(m)$ множество всех характеристических векторов линейных порядков в~$D$.
Выпуклая оболочка $\LOP(m)$ называется \emph{многогранником линейных порядков}. 
$\LOP(m)$ может быть также определен как множество векторов $\bm{y}\in\{0,1\}^{m(m-1)/2}$, удовлетворяющих 3-контурым неравенствам (см., например, \cite{Grotschel:1985}):
\begin{equation}
\label{3cycle}
0 \le y_{ij} + y_{jk} - y_{ik} \le 1, \quad i < j < k.
\end{equation}

В~\cite{Buchheim:2010} многогранник квадратичной задачи линейного упорядочивания определен следующим образом. Пусть
\[
I = \big\{(i,j,k,l) \ | \ i<j, \ k<l, \text{ и } (i,j) \prec (k,l) \big\},
\]
где $(i,j) \prec (k,l)$ означает либо $i<k$, либо $i=k$ и $j < l$.
Для каждой пары различных переменных $y_{ij}$ и $y_{kl}$ вводится новая переменная
\begin{equation}
\label{eq:QLOP}
z_{ijkl} = y_{ij} y_{kl}, \quad (i,j,k,l) \in I.
\end{equation}
Обозначим через $\QLOP(m)$ множество всех векторов $\bm{z}\in\{0,1\}^d$, 
$d = \binom{m}{2} \left( \binom{m}{2} + 1 \right) / 2$,
с координатами $y_{ij}$ и $z_{ijkl}$, удовлетворяющих ограничениям \eqref{3cycle} и~\eqref{eq:QLOP}.
Выпуклая оболочка множества $\QLOP(m)$ называется \emph{многогранником квадратичной задачи линейного упорядочивания}.

\begin{theorem}[\cite{Buchheim:2010}] 
	$\QLOP(m) \lea \BQP(n)$ при $n = \binom{m}{2}$.
\end{theorem} 

Бучхейм, Вигеле и Женг~\cite{Buchheim:2010} используют этот факт в алгоритме ветвей и отсечений для решения квадратичной задачи линейного упорядочивания.

Покажем, что аффинное свед\'ение в обратную сторону также возможно.

\begin{theorem}
	\label{ThBQP-QLOP}
	$\BQP(n) \lea \QLOP(m)$ при $m = 2n$.
\end{theorem} 

\begin{proof}
	Идея доказательства проста.
	Покажем, что среди граней $\LOP(m)$ есть $n$-мерный куб.
	При переходе от $\LOP(m)$ к $\QLOP(m)$ этот куб преобразуется в булев квадратичный многогранник.
	
	%Пусть $m = 2n$. 
	Воспользуемся тем, что равенства $y_{ij} = 0$ и $y_{ij} = 1$ определяют опорные гиперплоскости для $\LOP(m)$ и $\QLOP(m)$.
	Пусть
	\[
	J = \{(2i-1,2i) \mid i\in[n] \}.
	\] 
	Положим 
	\begin{equation}
	\label{FaceQube}
	y_{ij} = 0 \quad \text{для всех } (i,j)\notin J, \ 1 \le i < j \le m.
	\end{equation}
	Незафиксированными остаются только переменные $y_{ij}$, где $i$ нечетно и $j = i+1$.
	Обратим внимание на 3-контурные неравенства~\eqref{3cycle}.
	Предполагая $i < j < k$, имеем два случая:
	\begin{enumerate} 
		\item Если $(i,j)\notin J$, то $y_{ij} = y_{ik} = 0$.
		Тогда неравенство~\eqref{3cycle} преобразуется в $0 \le y_{jk} \le 1$. 
		\item Если $(i,j)\in J$, то $i$ нечетно, $j = i+1$ четно и $k > i+1$.
		Следовательно, неравенство~\eqref{3cycle} эквивалентно $0 \le y_{ij} \le 1$.
	\end{enumerate} 
	Таким образом, $n$ переменных $y_{i\, i+1}$, где $i$ четно, 
	могут принимать значения 0 или 1 независимо друг от друга.
	Следовательно, гиперплоскости~\eqref{FaceQube} определяют грань $\LOP(m)$, являющуюся $n$-мерным кубом. 
	
	Обратим внимание на переменные $z_{ijkl}$, $(i,j,k,l) \in I$.
	Если $(i,j) \notin J$ или $(k,l) \notin J$, то $z_{ijkl}=0$.
	В случае $(i,j) \in J$ и $(k,l) \in J$ имеем $z_{ijkl}=y_{ij} y_{kl}$, 
	и, кроме того, $y_{ij}$ и $y_{kl}$ не связаны никакими другими зависимостями.
	
	Таким образом, описанная грань $\QLOP(m)$ и многогранник $\BQP(n)$ связаны следующим аффинным невырожденным отображением:
	$$
	\begin{aligned}
	x_{ii} &= y_{2i-1,\, 2i}, \quad 1\le i\le n,\\
	x_{ij} &= z_{2i-1,\, 2i,\, 2j-1,\, 2j} = y_{2i-1,\, 2i} \cdot y_{2j-1,\, 2j}, \quad 1\le i < j\le n,
	\end{aligned}
	$$
	где $\bm{y} \in \QLOP(m)$, $\bm{x} \in \BQP(n)$.
	%Let $x_{ii}$ in the~equation~\eqref{BQP} be equal to $y_{2i-1, 2i}$, $1\le i\le n$.
	%Let $x_{ij} = z_{2i-1, 2i, 2j-1, 2j}=y_{2i-1, 2i} \cdot y_{2j-1, 2j}$, $1\le i < j\le n$.
	%Thus the~face of $\QLOP(m)$ is affinely equivalent to $\BQP_n$. 
\end{proof}

Для многогранника квадратичной задачи о назначениях история повторяется почти дословно.

Множество вершин $\Birk(m)$ многогранника задачи о назначениях (многогранника Биркгофа)
состоит из векторов $\bm{y}\in\{0,1\}^{m\times m}$, удовлетворяющих условиям
\begin{align}
\sum_j y_{ij} = 1, \ \forall i \in [m], \label{eq:Ass1}\\ 
\sum_i y_{ij} = 1, \ \forall j \in [m]. \label{eq:Ass2}
\end{align}
Чтобы определеить многогранник квадратичной задачи о назначениях,
введем новые переменные $z_{ijkl}$ так же, как это было сделано в~\eqref{eq:QLOP}:
%For every pair $y_{ij}$ and $y_{kl}$ there is introduced a~new variable
\begin{equation}
\label{eq:QAP}
z_{ijkl} = y_{ij} y_{kl}, \text{ где } (i,j) \prec (k,l).
\end{equation}
Обозначим через $\QAP(m)$ множество всех векторов $\bm{z}\in\{0,1\}^d$, $d = m^2 + \binom{m^2}{2}$,
с координатами $y_{ij}$ и $z_{ijkl}$, удовлетворяющих условиям \eqref{eq:Ass1}, \eqref{eq:Ass2} и~\eqref{eq:QAP}.
Выпуклая оболочка множества $\QAP(m)$ называется \emph{многогранником квадратичной задачи о назначениях}.
В литературе также встречается описание \emph{многогранника квадратичных полуназначений}~\cite{Saito:2009}.
При определении его множества вершин $\QSAP(m)$ условие~\eqref{eq:Ass2} опускается.

\begin{theorem}[\cite{Rijal:1995, Kaibel:1997, Saito:2009}] 
	$\QAP(m) \lea \QSAP(m) \lea \BQP(n)$ при $n = m^2$.
\end{theorem} 

Эта связь используется в~\cite{Kaibel:1997} для вывода неравенств, допустимых для $\QAP(m)$.
В частности, так как $\BQP(n)$ 2-смежностен, то $\QAP(m)$ тоже 2-смежностен.
В~\cite{Kaibel:1997} также показано, что многогранник линейных порядков $\LOP(m)$ и многогранник коммивояжера $\TSP(m)$ являются проекциями некоторых граней многогранника $\QAP(m)$.
%\[\LOP(m) \leE \QAP(m),  \quad  \TSP(m) \leE \QAP(m).\] 
Заметим, что аффинные сводимости $\LOP \propto_A \QAP$ и $\TSP \propto_A \QAP$ невозможны, так как $\LOP(m)$ не 2-смежностен при $m \ge 3$~\cite{Young:1978},
а $\TSP(m)$ не 2-смежностен при $m \ge 6$~\cite{PadbergRao:1974}.

\begin{theorem}
	$\BQP(n) \lea \QAP(m)$ для $m = 2n$.
\end{theorem} 

\begin{proof}
По аналогии с доказательством теоремы~\ref{ThBQP-QLOP}, достаточно заметить, что многогранник Биркгофа $\Birk(2n)$ содержит грань, являющуюся $n$-мерным кубом.
(Здесь мы используем тот же факт, что и при доказательстве теоремы~\ref{thm:KnapEqCAP}.)
Положим
\[
S = \big\{(i,i) \mid i\in[2n]\big\} \cup \big\{(2i-1,2i) \mid i\in[n]\big\} \cup \big\{(2i,2i-1) \mid i\in[n]\big\}.
\] 
Тогда уравнения
\[
y_{ij} = 0 \quad \forall (i,j) \notin S
\]
определяют требуемую грань.
\end{proof}

Таким образом, семейства многогранников $\QLOP$, $\QAP$ и $\QSAP$ находятся в одном классе эквивалентности (в смысле $\propto_A$) вместе с $\BQP$ и $\Cut$.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Многогранники раскрасок и деревьев Штейнера в графе
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Многогранники раскрасок и деревьев Штейнера в графе}

\subsection{Многогранники деревьев Штейнера}

Пусть $G=(V,E)$ "--- реберно"=взвешенный граф, а $T$ "--- некоторое подмножество его вершин. \emph{Деревом Штейнера на $T$} называется подграф $G' = (V',E')$, $T\subseteq V'$, графа $G$, являющийся деревом. Задача Штейнера (в графе) заключается в отыскании дерева Штейнера с минимальным суммарным весом ребер.
\emph{Многогранником деревьев Штейнера} называется выпуклая оболочка множества $\Steiner(G,T) \subseteq \{0,1\}^E$ всех характеристических векторов деревьев Штейнера на $T$~\cite{Chopra:1994}.

\begin{theorem}
Для любого графа $G=(V,E)$ за линейное время можно построить граф $G'=(V',E')$, $|V'|=|V|+|E|+1$, $|E'|=4|E|+|V|$, и указать множество $T\subset V'$ такие, что
$\Stable(G) \lea \Steiner(G',T)$.
\end{theorem}
\begin{proof}
Пусть $G=([n],E)$ "--- граф, определяющий многогранник $\Stable(G)$.
Положим 
\[
T = \{v'_0\} \cup \Set*{t_{ij} \given i < j, \ \{i,j\}\in E}
\]
и определим множество вершин и ребер графа $G'=(V',E')$ следующим образом:
\[
V' = T \cup \{v'_1,\dots,v'_n\} \cup \Set{v'_{ij} \given i < j, \ \{i,j\}\in E},
\]
\[
E' = \Set{\{v'_0, v'\} \given v'\in V'\setminus T} 
\cup \Set{\{v'_{ij}, t_{ij}\}}
\cup \Set{\{v'_{k}, t_{ij}\} \given k\in \{i,j\}}.
\]
Таким образом, каждая вершина $t_{ij}$ инцидентна ровно трем ребрам 
\[
\{v', t_{ij}\}, \quad v' \in V_{ij} = \{v'_{ij}, v'_i, v'_j\}.
\]
Причем как минимум одно из них должно входить в дерево Штейнера на $T$.
Следовательно, неравенство
\[
x_{\{v'_{ij}, t_{ij}\}} + x_{\{v'_{i}, t_{ij}\}} + x_{\{v'_{j}, t_{ij}\}} \ge 1
\]
выполнено для каждого $\bm{x} \in \Steiner(G',T) \subset \{0,1\}^{E'}$.
Полагая 
\begin{equation}
\label{eq:proofSteiner1}
x_{\{v'_{ij}, t_{ij}\}} + x_{\{v'_{i}, t_{ij}\}} + x_{\{v'_{j}, t_{ij}\}} = 1,
\end{equation}
перейдем к рассмотрению соответствующей грани многогранника деревьев Штейнера.

Предположим, что некоторое ребро $\{v', t_{ij}\}$, $v' \in V_{ij}$ входит в дерево Штейнера на $T$. 
Тогда, в силу того, что $t_{ij}$ и $v'_0$ должны быть связаны, а степени всех вершин из $T \setminus \{v'_0\}$ равны единице, приходим к выводу, что ребро $\{v', v'_0\}$ обязано присутствовать в этом дереве.
Другими словами, $x_{\{v'_0, v'\}} \ge x_{\{v', t_{ij}\}}$, $v' \in V_{ij}$.
Очевидно, ограничения 
\[
x_{\{v'_0, v'\}} = x_{\{v', t_{ij}\}}, \quad v' \in V_{ij},
\]
вместе с \eqref{eq:proofSteiner1} определяют некоторую грань многогранника $\Steiner(G',T)$.
Таким образом, все координаты вектора $\bm{x}$, принадлежащего множеству вершин этой грани, выражаются линейно через координаты $x_{\{v'_0, v'\}}$, $v' \in V' \setminus T$.
Кроме того, для них выполняются ограничения
\begin{equation*}
x_{\{v'_0, v'_{ij}\}} + x_{\{v'_0, v'_{i}\}} + x_{\{v'_0, v'_{j}\}} = 1.
\end{equation*}
То есть координаты $x_{\{v'_0, v'_{ij}\}}$ линейно зависят от $x_{\{v'_0, v'_{i}\}}$ и $x_{\{v'_0, v'_{j}\}}$, и последнее уравнение эквивалентно ограничению
\begin{equation*}
x_{\{v'_0, v'_{i}\}} + x_{\{v'_0, v'_{j}\}} \le 1.
\end{equation*}

Таким образом, описанная грань многогранника $\Steiner(G',T)$ оказывается аффинно эквивалентна многограннику $\Stable(G)$, если положить $y_i = x_{\{v'_0, v'_{i}\}}$ для $\bm{y} \in \Stable(G)$.
\end{proof}


\subsection{Многогранники раскрасок вершин графа}

Одной из наиболее известных NP-полных задач является задача о раскраске вершин графа~\cite{Karp:1972}, сформулированная выше, на с.~\pageref{problem:Color}. 
Она имеет многочисленные приложения от составления расписаний и распределения частот в сетях сотовой связи, до распределения ресурсов в компиляторах и автоматизации вычисления производных~\cite{Burke:2010}.
В литературе можно найти несколько принципиально отличающихся друг от друга определений многогранников раскрасок графа.
Рассмотрим несколько наиболее естественных определений, отбросив, в частности, те, где размерность многогранника экспоненциальна относительно числа вершин графа. Далее предполагаем, что раскрашиваемый граф $G=(V,E)$ не содержит изолированных вершин (раскраска которых тривиальна) и не является полным.
%, а также заведомо непрактичные.

\subsubsection{Стандартная формулировка}

Для каждой раскраски графа $G=(V,E)$ рассмотрим её характеристический вектор $\bm{x} \in \{0,1\}^{V\times k}$, $1 \le k \le |V|$, координаты которого определим следующим образом:
\[
x_{v,c} = \begin{cases}
1, & \text{если вершина $v$ раскрашена цветом $c$,}\\
0, & \text{иначе.}
\end{cases}
\]
Множество всех таких векторов обозначим $\ColorA(G,k)$.
Нетрудно заметить, что это множество может быть описано следующим набором ограничений~\cite{Mehrotra:1996,Delle:2016}:
\begin{align}
x_{v,c} + x_{u,c} &\le 1, \qquad \{v,u\} \in E, \quad c\in[k], \label{eq:colora1}\\
\sum_{c=1}^k x_{v,c} &= 1, \qquad v\in V, \label{eq:colora2}\\
x_{v,c} &\in \{0,1\}, \qquad v\in V, \quad c\in[k]. \notag
\end{align}
Здесь неравенство~\eqref{eq:colora1} запрещает окрашивать смежные вершины одним цветом,
а уравнение~\eqref{eq:colora2} означает, что каждая вершина будет окрашена ровно одним цветом.
Очевидно, множество $\ColorA(G,k)$ не пусто тогда и только тогда, когда вершины графа $G$ могут быть раскрашены в $k$ цветов.
А минимизируя на этом множестве линейную функцию 
\[
f(\bm{x}) = \sum_{v\in V, c\in[k]} |V|^c x_{v,c}
\]
можно найти раскраску с наименьшим числом цветов.

\begin{prop}
$\Stable(G) \lea \ColorA(G,|V|)$ для любого графа $G=(V,E)$.
\end{prop}
\begin{proof}
Для удобства положим $V = [n]$.
Рассмотрим грань многогранника $\ColorA(G,|V|)$, лежащую в пересечении гиперплоскостей
\[
x_{v,c} = 0, \quad \text{где $v \ne c$ и $c \ne 1$.} 
\]
Тогда уравнения~\eqref{eq:colora2} примут вид
\[
x_{v,1} + x_{v,v} = 1, \qquad v\in [n],
\]
А из неравенств~\eqref{eq:colora1} нетривиальными останутся лишь неравенства
\[
x_{v,1} + x_{u,1} = 1, \qquad \{v,u\} \in E.
\]
Очевидно, эта грань аффинно эквивалентна многограннику $\Stable(G)$.
\end{proof}

Значительное внимание в литературе~\cite{Mendez:2008,Burke:2010} уделяется следующей модификации этого многогранника.
Положим $V = [n]$ и $k = n$, а неравенства~\eqref{eq:colora1} заменим на 
\begin{align*}
x_{v,c} + x_{u,c} &\le w_c, \qquad \{v,u\} \in E, \quad c\in[n],\\
w_c &\in \{0,1\}, \qquad c\in[n].
\end{align*}
(Если переменная $w_c$ равна нулю, то цвет $c$ не используется.)
Обозначим множество векторов $\bm{x} \in \{0,1\}^{n(n+1)}$, удовлетворяющих этим ограничениям, через $\ColorB(G)$.
При таком подходе целевая функция для задачи поиска хроматического числа графа $G$ приобретает особенно простой вид:
\[
\sum_{c\in[n]} w_c \to \min.
\]

Очевидно, 
\[
\ColorA(G,k) \lea \ColorB(G).
\]
Достаточно положить $w_c = 1$ при $c\in[k]$ и $w_c = 0$ при $c > k$.

Покажем теперь, что семейства многогранников $\ColorA$ и $\ColorB(G)$ лежат в одном классе эквивалентности с многогранниками независимых множеств.
Так как $\Stable \propto_A \ColorA \propto_A \ColorB$, то остается доказать $\ColorB \propto_A \Stable$.

\begin{prop}
Для любого графа $G=([n],E)$ за линейное время можно построить $G'=(V',E')$, $|V'| = n(n+2)$, $|E'|=n^2(n+1)/2+(|E|+1)n$, что 
\[
\ColorB(G) \lea \Stable(G').
\]
\end{prop}
\begin{proof}
Достаточно систему ограничений
\begin{align}
\sum_{j=1}^n x_{ij} &= 1, \qquad i\in[n], \label{eq:proofColorB1}\\
x_{ij} + x_{kj} &\le w_j, \qquad \{i,k\} \in E, \quad j\in[n], \label{eq:proofColorB2}
\end{align}
описывающую многогранник $\ColorB(G)$,
преобразовать в систему ограничений вида $y_i + y_j \le 1$.

Заметим, прежде всего, что неравенства~\eqref{eq:proofColorB2} эквивалентны неравенствам 
\begin{align}
x_{ij} &\le w_j, \qquad i,j\in[n], \label{eq:proofColorB2a}\\
x_{ij} + x_{kj} &\le 1, \qquad \{i,k\} \in E, \quad j\in[n], \notag
\end{align}
при условии целочисленности переменных.

Введем дополнительные переменные $\bar{w}_j \in \{0,1\}$, $j\in[n]$, и рассмотрим систему ограничений
\begin{align}
x_{ij} + x_{ik} &\le 1, \qquad i,j,k\in[n], \quad j \ne k, \notag \\
w_j + \bar{w}_j &\le 1, \qquad j\in[n], \notag\\
x_{ij} + \bar{w}_j &\le 1, \qquad i,j\in[n], \label{eq:proofColorB5}\\
x_{ij} + x_{kj} &\le 1, \qquad \{i,k\} \in E, \quad j\in[n]. \notag %\label{eq:proofColorB6}
\end{align}
Очевидно, она определяет многогранник $\Stable(G')$ для некоторого графа $G'=(V',E')$, где $|V'| = n(n+2)$, $|E'|=n^2(n+1)/2+(|E|+1)n$.
Полагая $w_j + \bar{w}_j = 1$, перейдем к рассмотрению некоторой грани этого многогранника.
Ограничение~\eqref{eq:proofColorB5} при этом превратится в~\eqref{eq:proofColorB2a}.
%\[x_{ij} \le w_j, \qquad i,j\in[n].\]
%В совокупности с неравенством~\eqref{eq:proofColorB6} оно эквивалентно неравенству~\eqref{eq:proofColorB2}.
Остается заметить, что равенство~\eqref{eq:proofColorB1} определяет грань этой грани, аффинно эквивалентную многограннику $\ColorB(G)$.
\end{proof}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% End of section
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Многогранники задачи коммивояжера}

SAT -> ATSP

Billera Sarangarajan.

Из утверждения~\ref{thm:kSAT} следует, что не существует конечной булевой формулы в конъюнктивной нормальной форме, описывающей множество вершин многогранника (а)симметричной задачи коммивояжера~\cite{Fiorini:2003}.

\section{Слабая аффинная сводимость}

Определение.
Пусть последовательность конечных множеств $X_n \in \Z^d$, 
где $d = d(n)$ полиномиальна, 
такова, что для любых $n \in \N$ и $x \in \Z^d$
задача проверки принадлежности $x \in X_n$ принадлежит классу NP.
Тогда семейство (последовательность) многогранников $P(n) = \conv(X_n)$
называется \emph{комбинаторным}.

Примечание.
В~\cite{Naddef:1981, MatsuiTamura:1995} комбинаторными называются многогранники, у которых для каждой пары несмежных вершин середина соединяющего их отрезка является также серединой отрезка, соединяющего другую пару вершин этого многогранника.

Лемма.
Пусть семейство многогранников $P(n) \in \Z^d$, $d = d(n)$,  комбинаторно.
Тогда существует комбинаторное семейство многогранников $Q(n) \in \{0,1\}^k$, $k = k(n)$, что
$Q(n)$ является расширением $P(n)$.

Теорема.
Пусть многогранник $P \subseteq \R^d$ является образом многогранника $Q \subseteq \R^n$ при ортогональном проецировании $\pi \from \R^n \to \R^d$, $n > d$.
Пусть, кроме того, $\pi(\ext Q) = \ext P$.
Тогда граф многогранника $P$ является подграфом графа многогранника $Q$.

Доказательство.
Для каждой вершины $\bm{v} \in \ext P$ определим множество
\[
W(\bm{v}) = \Set*{\bm{x} \in \ext Q \given \pi(\bm{x}) = \bm{v}}.
\]
Очевидно, $\conv (W(\bm{v}))$ является гранью многогранника $Q$.

Для удобства полагаем, что $\R^d$ вложено в $\R^n$,
а проецирование $\pi$ преобразует $(x_1, \dots, x_n)$ в $(x_1, \dots, x_d, 0, \dots, 0)$.
Вспомогательный вектор $\bm{c} \in \R^n$ определим следующим образом.
Если $n = d+1$, то $\bm{c} = \bm{e_n}$,
иначе $\bm{c} = \lambda_{d+1} \bm{e_{d+1}} + \dots + \lambda_{n} \bm{e_n}$
и коэффициенты $\lambda_{d+1}$, \dots, $\lambda_{n}$ подобраны так, 
что для любого $\bm{v} \in \ext P$ и любых двух вершин $\bm{w_1}, \bm{w_2} \in W(\bm{v})$ из неравенства $\bm{w_1} \ne \bm{w_2}$ следует $\bm{c}^T \bm{w_1} \ne \bm{c}^T \bm{w_2}$.
Ясно, что в силу конечности множества вершин многогранника $Q$ такой вектор $\bm{c}$ существует. 
С помощью этого вектора в каждом множестве $W(\bm{v})$ выделим уникальную вершину
\[
\bm{w_v} = \argmax_{\bm{w} \in W(\bm{v})} \Set{\bm{c}^T \bm{w}}.
\]

Остается показать, что если вершины $\bm{v_1}$ и $\bm{v_2}$ многогранника $P$ смежны, то соответствующие вершины 
$\bm{w_1} = \bm{w_{v_1}}$ и $\bm{w_2} = \bm{w_{v_2}}$ тоже смежны.

Предположим, что вершины $\bm{v_1}$ и $\bm{v_2}$ многогранника $P$ смежны.
Тогда многогранники $F_1 = \conv (W(\bm{v_1}))$ и $F_2 = \conv (W(\bm{v_2}))$, а также их выпуклая оболочка $F = \conv(F_1 \cup F_2)$ являются гранями многогранника $Q$.
Причем $\aff(F_1)$ и $\aff(F_2)$ ортогональны вектору $\bm{b} = \bm{v_2} - \bm{v_1}$.
(Соответственно, линейная функция $\bm{b}^T \bm{x}$ принимает разные значения для $\bm{w_1}$ и $\bm{w_2}$.)
Подберем числа $\beta, \gamma \in \R$, $\gamma > 0$, так,
чтобы линейная функция $f(\bm{x}) = \beta \bm{b}^T \bm{x} + \gamma \bm{c}^T \bm{x}$ принимала одинаковые значения для $\bm{w_1}$ и $\bm{w_2}$.
Нетрудно проверить, что тогда 
\[
f(\bm{w_1}) = f(\bm{w_2}) > f(\bm{w}) \quad
\text{для всех }
\bm{w} \in W(\bm{v_1}) \cup W(\bm{v_2}) \setminus \{\bm{w_1}, \bm{w_2}\}.
\]
Следовательно, $\bm{w_1}$ и $\bm{w_2}$ смежны.
Доказано.

Следствие.
Пусть многогранник $P \subseteq \R^d$ является образом многогранника $Q \subseteq \R^n$ при аффинном отображении $\pi \from \R^n \to \R^d$.
Пусть, кроме того, $\pi(\ext Q) = \ext P$.
Тогда $\omega(P) \le \omega(Q)$.
