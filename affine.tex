%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%     Аффинная сводимость
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Аффинная сводимость}
\begin{flushright}
Всё познается в сравнении
\end{flushright}


\section{Определения и примеры}

\subsection{Сравнение многогранников}

Как известно, сравнение является одним из наиболее распространенных и универсальных методов исследования.
Чтобы воспользоваться им, введем следующую операцию сравнения,
задающую частичный порядок на множестве всех выпуклых многогранников.

\begin{definition}
В случае, когда многогранник $P$ аффинно эквивалентен многограннику~$Q$ или же его грани, будем использовать обозначение $P \lea Q$.
Факт аффинной эквивалентности многогранников $P$ и $Q$ обозначаем $P =_A Q$.
\end{definition}

В следующей главе будет рассмотрен более мягкий вариант этого определения,
в котором слова <<аффинно эквивалентен>> заменены на <<является аффинным образом>>, а для соответствующего соотношения используется обозначение $\lee$. Там же будет проведен анализ различий в использовании этих двух соотношений при исследовании свойств многогранников.

Нетрудно заметить, что соотношение $\lea$ оказывается особенно полезным
при сравнении комбинаторных свойств (т.\,е. свойств решеток граней) многогранников.

\begin{property}
Если $P \lea Q$, то решетка граней многогранника $P$ 
изоморфна либо всей решетке граней многогранника $Q$ (если $P$ и $Q$ эквивалентны), либо некоторой подрешетке (индуцированной гранью многогранника $Q$), а матрица инциденций гиперграней"=вершин многогранника $P$ является подматрицей матрицы инциденций многогранника $Q$. В частности:
\begin{enumerate}
	\item Число вершин многогранника $P$ не превосходит числа вершин $Q$.
	\item Число $i$-граней многогранника $P$ не превосходит числа $i$-граней $Q$ при $i \le \dim(P)$.
	\item Граф многогранника $P$ оказывается изоморфен некоторому подграфу графа многогранника $Q$.
	\item Число гиперграней $P$ не превосходит числа гиперграней $Q$.
	\item $\rc(P) \le \rc(Q)$.
\end{enumerate}
\end{property}

В качестве примеров перечислим некоторые очевидные соотношения
для симплексов и циклических многогранников.
Прежде всего, симплекс $\Delta_n$ является гранью симплекса $\Delta_{n+1}$, 
а в силу транзитивности соотношения $\lea$ 
получаем 
\begin{equation}
\label{eq:compareDelta}
\Delta_n \lea \Delta_{n+k} \quad \forall n,k \in \N.
\end{equation}
Кроме того, $\Delta_m \lea \CP_n(S)$ при $m \le n < |S|$, 
так как циклический многогранник $\CP_n(S)$ симплициален.
По той же причине 
\begin{equation}
\label{eq:compareCP}
\CP_n(S) \nelea \CP_{n+k}(S')
\end{equation}
для всех $n, k \in \N$
и любых множеств $S$ и $S'$, при условии $|S| > n+1 > 2$.

Заметим, что множество симплексов $\{\Delta_n\}$ и множество циклических многогранников $\{\CP_n(S)\} = \Set*{\CP_n(S) \given n\in\N, \ S \subset \Q, \ \text{$S$ конечно}}$ представляют собой примеры семейств многогранников задач комбинаторной оптимизации.
В связи с этим интерес представляет следующий вопрос.
Какая из двух ситуаций \ref{eq:compareDelta} или~\ref{eq:compareCP} является наиболее типичной для известных семейств многогранников задач?
Опыт показывает, что в большинстве случаев легко проверяется справедливость соотношений вида~\ref{eq:compareDelta}.
При доказательстве такого рода соотношений удобно пользоваться следующим очевидным утверждением.

\begin{lemma}
	\label{lem:01face}
	Пусть $P \in \R^d$ "--- 0/1"~многогранник. Тогда $F_i = \Set*{\bm{x}\in P \given x_i = 0}$ и $G_i = \Set*{\bm{x}\in P \given x_i = 1}$, $i\in[d]$,
	являются гранями (быть может несобственными) многогранника $P$.
\end{lemma}

Рассмотрим три наиболее часто встречающихся в литературе семейства многогранников: булевы квадратичные многогранники $\BQP(n)$, многогранники асимметричной задачи коммивояжера $\ATSP(n)$ и многогранники задачи о рюкзаке $\Knap(n, \bm{a}, b)$.


\begin{prop}
\begin{align*}
\BQP(n) &\lea \BQP(n+1),\\
\ATSP(n) &\lea \ATSP(n+1),\\
\Knap(n, \bm{a}, b) &\lea \Knap(n+1, (\bm{a},0), b), \quad (\bm{a},0) \in \R^{n+1}, \ b\in \R.
\end{align*}
\end{prop}
\begin{proof}
Воспользуемся леммой~\ref{lem:01face}.
Рассмотрим грань $F$ многогранника $\BQP(n+1)$, образованную гиперплоскостью $x_{n+1, n+1} = 0$. 
Тогда для всех $\bm{x} \in F$ выполняется $x_{i, n+1} = 0$ при $i\in[n+1]$.
Нетрудно увидеть, что множество вершин грани $F$ преобразуется в множество вершин многогранника $\BQP(n)$ (и, наоборот, $\BQP(n)$ в $F$) аффинным отображением (ортогональной проекцией) $x_{ij} \mapsto y_{ij}$, $1 \le i \le j \le n$. 

Для доказательства соотношения $\ATSP(n) \lea \ATSP(n+1)$ 
достаточно установить взаимно однозначное соответствие между множеством гамильтоновых контуров полного орграфа $D=(V,A)$ на $n$ вершинах и подмножеством 
гамильтоновых контуров орграфа $D'=(V',A')$ на $n+1$ вершинах, в котором удалены все дуги, входящие в вершину $v'_1$, и дуги, выходящие из $v'_{n+1}$, за исключением дуги $(v'_{n+1}, v'_1)$.
Заметим, что характеристические вектора указанного подмножества контуров оргафа $D'=(V',A')$ являются вершинами грани 
\[F = \Set*{\bm{x} \in \ATSP(n+1) \given x_{(v'_{n+1}, v'_1)} = 1}
\]
многогранника $\ATSP(n+1)$.
Очевидно, грань $F$ и многогранник $\ATSP(n)$ связаны невырожденным аффинным отображением
\[
	y_{(v_i, v_j)} = 
	\begin{cases}
	x_{(v'_i, v'_j)}, & 1 \le i \le n, \ 2 \le j \le n, \ i \ne j,\\
	x_{(v'_i, v'_{n+1})}, & 2 \le i \le n, \ j=1,\\
	\end{cases}
\]
где $\bm{x} \in F$, $\bm{y} \in \ATSP(n)$.

Для доказательства соотношения $\Knap(n, \bm{a}, b) \lea \Knap(n+1, (\bm{a},0), b)$ достаточно заметить, что 
\[
\Knap(n+1, (\bm{a},0), b) = \Set*{(\bm{x},x_{n+1}) \in \{0,1\}^{n+1} \given \bm{x} \in \Knap(n, \bm{a}, b)}.
\]
Следовательно, многогранник $\Knap(n, \bm{a}, b)$ аффинно эквивалентен грани многогранника $\Knap(n+1, (\bm{a},0), b)$, образованной гиперплоскостью $x_{n+1} = 0$ (или $x_{n+1} = 1$).
\end{proof}


Сравнение многогранников из разных семейств.

\BQP и \Cut.

\Stable, \Pack, \Part.

\BQP и \Stable.

%\subsection{Аффинная сводимость}

Billera Sarangarajan.

Аффинная сводимость.


\section{Слабая аффинная сводимость}

Определение.
Пусть последовательность конечных множеств $X_n \in \Z^d$, 
где $d = d(n)$ полиномиальна, 
такова, что для любых $n \in \N$ и $x \in \Z^d$
задача проверки принадлежности $x \in X_n$ принадлежит классу NP.
Тогда семейство (последовательность) многогранников $P(n) = \conv(X_n)$
называется \emph{комбинаторным}.

Примечание.
В~\cite{Naddef:1981, MatsuiTamura:1995} комбинаторными называются многогранники, у которых для каждой пары несмежных вершин середина соединяющего их отрезка является также серединой отрезка, соединяющего другую пару вершин этого многогранника.

Лемма.
Пусть семейство многогранников $P(n) \in \Z^d$, $d = d(n)$,  комбинаторно.
Тогда существует комбинаторное семейство многогранников $Q(n) \in \{0,1\}^k$, $k = k(n)$, что
$Q(n)$ является расширением $P(n)$.

Теорема.
Пусть многогранник $P \subseteq \R^d$ является образом многогранника $Q \subseteq \R^n$ при ортогональном проецировании $\pi \from \R^n \to \R^d$, $n > d$.
Пусть, кроме того, $\pi(\ext Q) = \ext P$.
Тогда граф многогранника $P$ является подграфом графа многогранника $Q$.

Доказательство.
Для каждой вершины $\bm{v} \in \ext P$ определим множество
\[
W(\bm{v}) = \Set*{\bm{x} \in \ext Q \given \pi(\bm{x}) = \bm{v}}.
\]
Очевидно, $\conv (W(\bm{v}))$ является гранью многогранника $Q$.

Для удобства полагаем, что $\R^d$ вложено в $\R^n$,
а проецирование $\pi$ преобразует $(x_1, \dots, x_n)$ в $(x_1, \dots, x_d, 0, \dots, 0)$.
Вспомогательный вектор $\bm{c} \in \R^n$ определим следующим образом.
Если $n = d+1$, то $\bm{c} = \bm{e_n}$,
иначе $\bm{c} = \lambda_{d+1} \bm{e_{d+1}} + \dots + \lambda_{n} \bm{e_n}$
и коэффициенты $\lambda_{d+1}$, \dots, $\lambda_{n}$ подобраны так, 
что для любого $\bm{v} \in \ext P$ и любых двух вершин $\bm{w_1}, \bm{w_2} \in W(\bm{v})$ из неравенства $\bm{w_1} \ne \bm{w_2}$ следует $\bm{c}^T \bm{w_1} \ne \bm{c}^T \bm{w_2}$.
Ясно, что в силу конечности множества вершин многогранника $Q$ такой вектор $\bm{c}$ существует. 
С помощью этого вектора в каждом множестве $W(\bm{v})$ выделим уникальную вершину
\[
\bm{w_v} = \argmax_{\bm{w} \in W(\bm{v})} \Set{\bm{c}^T \bm{w}}.
\]

Остается показать, что если вершины $\bm{v_1}$ и $\bm{v_2}$ многогранника $P$ смежны, то соответствующие вершины 
$\bm{w_1} = \bm{w_{v_1}}$ и $\bm{w_2} = \bm{w_{v_2}}$ тоже смежны.

Предположим, что вершины $\bm{v_1}$ и $\bm{v_2}$ многогранника $P$ смежны.
Тогда многогранники $F_1 = \conv (W(\bm{v_1}))$ и $F_2 = \conv (W(\bm{v_2}))$, а также их выпуклая оболочка $F = \conv(F_1 \cup F_2)$ являются гранями многогранника $Q$.
Причем $\aff(F_1)$ и $\aff(F_2)$ ортогональны вектору $\bm{b} = \bm{v_2} - \bm{v_1}$.
(Соответственно, линейная функция $\bm{b}^T \bm{x}$ принимает разные значения для $\bm{w_1}$ и $\bm{w_2}$.)
Подберем числа $\beta, \gamma \in \R$, $\gamma > 0$, так,
чтобы линейная функция $f(\bm{x}) = \beta \bm{b}^T \bm{x} + \gamma \bm{c}^T \bm{x}$ принимала одинаковые значения для $\bm{w_1}$ и $\bm{w_2}$.
Нетрудно проверить, что тогда 
\[
f(\bm{w_1}) = f(\bm{w_2}) > f(\bm{w}) \quad
\text{для всех }
\bm{w} \in W(\bm{v_1}) \cup W(\bm{v_2}) \setminus \{\bm{w_1}, \bm{w_2}\}.
\]
Следовательно, $\bm{w_1}$ и $\bm{w_2}$ смежны.
Доказано.

Следствие.
Пусть многогранник $P \subseteq \R^d$ является образом многогранника $Q \subseteq \R^n$ при аффинном отображении $\pi \from \R^n \to \R^d$.
Пусть, кроме того, $\pi(\ext Q) = \ext P$.
Тогда $\omega(P) \le \omega(Q)$.
